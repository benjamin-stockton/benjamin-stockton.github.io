<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben">
<meta name="dcterms.date" content="2026-02-20">

<title>Data Visualizations and Diagnostics for Imputed Directional Data – Ben Stockton’s Stats Site</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-56eb8400b17eecf7b22d62b571160367.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Data Visualizations and Diagnostics for Imputed Directional Data – Ben Stockton’s Stats Site">
<meta property="og:description" content="">
<meta property="og:image" content="https://benjamin-stockton.github.io/posts/imp-data-viz/imp-data-viz_files/figure-html/fig-scatterplot-comp-1.png">
<meta property="og:site_name" content="Ben Stockton's Stats Site">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="Data Visualizations and Diagnostics for Imputed Directional Data – Ben Stockton’s Stats Site">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://benjamin-stockton.github.io/posts/imp-data-viz/imp-data-viz_files/figure-html/fig-scatterplot-comp-1.png">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ben Stockton’s Stats Site</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/benjamin-stockton"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/benjamin-stockton-329507160/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Data Visualizations and Diagnostics for Imputed Directional Data</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">data-viz</div>
                <div class="quarto-category">missing-data</div>
                <div class="quarto-category">angular-data</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Ben </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 20, 2026</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#simulated-data" id="toc-simulated-data" class="nav-link active" data-scroll-target="#simulated-data">Simulated Data</a></li>
  <li><a href="#impute-the-missing-angular-data" id="toc-impute-the-missing-angular-data" class="nav-link" data-scroll-target="#impute-the-missing-angular-data">Impute the Missing Angular Data</a></li>
  <li><a href="#imputation-figures" id="toc-imputation-figures" class="nav-link" data-scroll-target="#imputation-figures">Imputation Figures</a>
  <ul class="collapse">
  <li><a href="#imputation-convergence-figures" id="toc-imputation-convergence-figures" class="nav-link" data-scroll-target="#imputation-convergence-figures">Imputation Convergence Figures</a></li>
  <li><a href="#extending-mice" id="toc-extending-mice" class="nav-link" data-scroll-target="#extending-mice">Extending MICE</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/benjamin-stockton/benjamin-stockton.github.io/edit/main/posts/imp-data-viz/imp-data-viz.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/benjamin-stockton/benjamin-stockton.github.io/blob/main/posts/imp-data-viz/imp-data-viz.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/benjamin-stockton/benjamin-stockton.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This post is a follow-up to my <a href="../../posts/directions-data-viz/directions-data-viz.html">first post</a> on <code>ggplot2</code>-based data visualization for angular data. In that post, I shared some basic visualizations for angular data that I used in my dissertation and other research projects. Here, I’ll share some visualizations for imputed angular data that combine ideas from the previous post with some of the standard diagnostics from <code>mice</code>.</p>
<div class="cell" data-warnings="false">
<details class="code-fold">
<summary>Load Packages</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circular, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(repo = "marcpabst/ggcircular")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcircular, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imputeangles, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pnregstan, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="simulated-data" class="level2">
<h2 class="anchored" data-anchor-id="simulated-data">Simulated Data</h2>
<p>I’ll start by generating data from a projected normal regression model. The data are displayed in <a href="#tbl-sim-data" class="quarto-xref">Table&nbsp;1</a> and <a href="#fig-scatterplot-comp" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10239</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>, <span class="fl">2.5</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(beta, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sigma_mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">length.out =</span> N))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> pnregstan<span class="sc">::</span><span class="fu">pnreg_sim_data</span>(<span class="at">N =</span> N, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">B =</span> beta, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Sigma_theta =</span> sigma_mat,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">X =</span> X) <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>To create a data set to demonstrate the imputation figures, I’ll mask some of the angular observations in the simulated data by simulating a missingness indicator <span class="math inline">\(R\)</span> such that the angle <span class="math inline">\(\theta\)</span> is MCAR for 35% of the observations. The incomplete data are displayed in <a href="#tbl-sim-missing" class="quarto-xref">Table&nbsp;2</a> and <a href="#fig-scatterplot-inc" class="quarto-xref">Figure&nbsp;2</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a MCAR response indicator</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>sim_data<span class="sc">$</span>R <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> N,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.65</span>, <span class="fl">0.35</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>mis_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(sim_data<span class="sc">$</span>R <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>inc_data <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            R <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> theta,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            R <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">U1 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(theta) <span class="sc">~</span> <span class="cn">NA</span>, <span class="cn">TRUE</span> <span class="sc">~</span> U1),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">U2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(theta) <span class="sc">~</span> <span class="cn">NA</span>, <span class="cn">TRUE</span> <span class="sc">~</span> U2)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(theta, U1, U2, X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Complete Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Incomplete Data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Color Scales Functions</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>scale_color_angles <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">colors =</span> <span class="fu">list</span>(<span class="at">low =</span> <span class="st">"magenta"</span>, <span class="at">mid =</span> <span class="st">"dodgerblue"</span>, <span class="at">high =</span> <span class="st">"magenta"</span>), <span class="at">color_name =</span> <span class="st">"Angle"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>pi, pi)) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> colors<span class="sc">$</span>low, <span class="at">mid =</span> colors<span class="sc">$</span>mid, <span class="at">high =</span> colors<span class="sc">$</span>high,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">na.value =</span> <span class="st">"gray70"</span>, <span class="at">name =</span> color_name,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">midpoint =</span> midpoint, <span class="at">limits =</span> limits)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>scale_fill_angles <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">colors =</span> <span class="fu">list</span>(<span class="at">low =</span> <span class="st">"magenta"</span>, <span class="at">mid =</span> <span class="st">"dodgerblue"</span>, <span class="at">high =</span> <span class="st">"magenta"</span>), <span class="at">fill_name =</span> <span class="st">"Angle"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>pi, pi)) {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> colors<span class="sc">$</span>low, <span class="at">mid =</span> colors<span class="sc">$</span>mid, <span class="at">high =</span> colors<span class="sc">$</span>high,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">na.value =</span> <span class="st">"gray70"</span>, <span class="at">name =</span> fill_name,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">midpoint =</span> midpoint, <span class="at">limits =</span> limits)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sim_data_2 <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> pi <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">FALSE</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>sim_data<span class="sc">$</span>original <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">bind_rows</span>(sim_data, sim_data_2), </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> theta, <span class="at">shape =</span> original, <span class="at">color =</span> theta)) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.85</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Original"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_angles</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), <span class="at">midpoint =</span> pi) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">theta$"</span>)) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatterplot-comp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatterplot-comp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-scatterplot-comp-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: A wrapped circular-linear scatterplot."><img src="imp-data-viz_files/figure-html/fig-scatterplot-comp-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatterplot-comp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A wrapped circular-linear scatterplot.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sim_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="tbl-sim-data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sim-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Simulated complete data
</figcaption>
<div aria-describedby="tbl-sim-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["theta"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["U1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["U2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["X"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["R"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["original"],"name":[6],"type":["lgl"],"align":["right"]}],"data":[{"1":"4.946883","2":"0.232350717","3":"-0.9726321","4":"-2.00000000","5":"0","6":"TRUE"},{"1":"3.772529","2":"-0.807475443","3":"-0.5899012","4":"-1.91836735","5":"1","6":"TRUE"},{"1":"5.272702","2":"0.531451452","3":"-0.8470888","4":"-1.83673469","5":"1","6":"TRUE"},{"1":"5.296858","2":"0.551756726","3":"-0.8340051","4":"-1.75510204","5":"1","6":"TRUE"},{"1":"4.845133","2":"0.132354977","3":"-0.9912024","4":"-1.67346939","5":"0","6":"TRUE"},{"1":"4.202808","2":"-0.487811568","3":"-0.8729490","4":"-1.59183673","5":"1","6":"TRUE"},{"1":"4.409581","2":"-0.298202075","3":"-0.9545028","4":"-1.51020408","5":"1","6":"TRUE"},{"1":"4.979177","2":"0.263634444","3":"-0.9646227","4":"-1.42857143","5":"1","6":"TRUE"},{"1":"5.767734","2":"0.870070404","3":"-0.4929275","4":"-1.34693878","5":"0","6":"TRUE"},{"1":"3.589057","2":"-0.901546919","3":"-0.4326814","4":"-1.26530612","5":"1","6":"TRUE"},{"1":"4.659519","2":"-0.052845600","3":"-0.9986027","4":"-1.18367347","5":"0","6":"TRUE"},{"1":"4.292988","2":"-0.407213408","3":"-0.9133330","4":"-1.10204082","5":"0","6":"TRUE"},{"1":"5.988304","2":"0.956836501","3":"-0.2906268","4":"-1.02040816","5":"1","6":"TRUE"},{"1":"1.532908","2":"0.037879359","3":"0.9992823","4":"-0.93877551","5":"1","6":"TRUE"},{"1":"5.136639","2":"0.411637030","3":"-0.9113479","4":"-0.85714286","5":"1","6":"TRUE"},{"1":"4.180851","2":"-0.506859620","3":"-0.8620286","4":"-0.77551020","5":"0","6":"TRUE"},{"1":"1.076762","2":"0.474181236","3":"0.8804273","4":"-0.69387755","5":"1","6":"TRUE"},{"1":"1.453983","2":"0.116547821","3":"0.9931851","4":"-0.61224490","5":"1","6":"TRUE"},{"1":"1.048233","2":"0.499102845","3":"0.8665428","4":"-0.53061224","5":"0","6":"TRUE"},{"1":"1.648199","2":"-0.077325019","3":"0.9970059","4":"-0.44897959","5":"1","6":"TRUE"},{"1":"2.018677","2":"-0.433056645","3":"0.9013667","4":"-0.36734694","5":"1","6":"TRUE"},{"1":"2.101094","2":"-0.505790436","3":"0.8626564","4":"-0.28571429","5":"1","6":"TRUE"},{"1":"1.761681","2":"-0.189727818","3":"0.9818367","4":"-0.20408163","5":"1","6":"TRUE"},{"1":"1.748096","2":"-0.176371993","3":"0.9843236","4":"-0.12244898","5":"1","6":"TRUE"},{"1":"1.398336","2":"0.171606581","3":"0.9851656","4":"-0.04081633","5":"0","6":"TRUE"},{"1":"2.138919","2":"-0.538050190","3":"0.8429128","4":"0.04081633","5":"1","6":"TRUE"},{"1":"1.869537","2":"-0.294316954","3":"0.9557079","4":"0.12244898","5":"0","6":"TRUE"},{"1":"1.466542","2":"0.104065380","3":"0.9945705","4":"0.20408163","5":"0","6":"TRUE"},{"1":"2.005397","2":"-0.421048551","3":"0.9070381","4":"0.28571429","5":"1","6":"TRUE"},{"1":"1.671520","2":"-0.100553510","3":"0.9949317","4":"0.36734694","5":"1","6":"TRUE"},{"1":"1.640855","2":"-0.070001724","3":"0.9975469","4":"0.44897959","5":"1","6":"TRUE"},{"1":"1.851676","2":"-0.277201215","3":"0.9608119","4":"0.53061224","5":"1","6":"TRUE"},{"1":"1.596549","2":"-0.025749625","3":"0.9996684","4":"0.61224490","5":"0","6":"TRUE"},{"1":"1.516569","2":"0.054201229","3":"0.9985300","4":"0.69387755","5":"1","6":"TRUE"},{"1":"1.357949","2":"0.211244091","3":"0.9774333","4":"0.77551020","5":"1","6":"TRUE"},{"1":"1.934853","2":"-0.356067825","3":"0.9344601","4":"0.85714286","5":"1","6":"TRUE"},{"1":"1.653063","2":"-0.082174194","3":"0.9966180","4":"0.93877551","5":"1","6":"TRUE"},{"1":"1.577200","2":"-0.006403339","3":"0.9999795","4":"1.02040816","5":"1","6":"TRUE"},{"1":"1.460526","2":"0.110047185","3":"0.9939264","4":"1.10204082","5":"0","6":"TRUE"},{"1":"1.373915","2":"0.195611893","3":"0.9806814","4":"1.18367347","5":"1","6":"TRUE"},{"1":"1.662533","2":"-0.091608144","3":"0.9957951","4":"1.26530612","5":"0","6":"TRUE"},{"1":"1.843846","2":"-0.269668979","3":"0.9629531","4":"1.34693878","5":"1","6":"TRUE"},{"1":"1.251785","2":"0.313627529","3":"0.9495461","4":"1.42857143","5":"1","6":"TRUE"},{"1":"1.609272","2":"-0.038466281","3":"0.9992599","4":"1.51020408","5":"1","6":"TRUE"},{"1":"1.479827","2":"0.090843614","3":"0.9958652","4":"1.59183673","5":"1","6":"TRUE"},{"1":"1.458512","2":"0.112048705","3":"0.9937027","4":"1.67346939","5":"1","6":"TRUE"},{"1":"1.776260","2":"-0.204020959","3":"0.9789665","4":"1.75510204","5":"1","6":"TRUE"},{"1":"1.961520","2":"-0.380858052","3":"0.9246335","4":"1.83673469","5":"0","6":"TRUE"},{"1":"1.434274","2":"0.136098896","3":"0.9906953","4":"1.91836735","5":"1","6":"TRUE"},{"1":"1.585414","2":"-0.014617347","3":"0.9998932","4":"2.00000000","5":"1","6":"TRUE"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>inc_data_plt <span class="ot">&lt;-</span> inc_data</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>inc_data_plt<span class="sc">$</span>true_theta <span class="ot">&lt;-</span> sim_data<span class="sc">$</span>theta</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>inc_data_2 <span class="ot">&lt;-</span> inc_data_plt <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> pi <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">true_theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            true_theta <span class="sc">&lt;</span> pi <span class="sc">~</span> true_theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            true_theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> true_theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> true_theta</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">FALSE</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>inc_data_plt<span class="sc">$</span>original <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>inc_data_dbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(inc_data_plt, inc_data_2)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(inc_data_dbl, </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> theta, <span class="at">shape =</span> original, <span class="at">color =</span> theta)) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">xmin =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">-</span> <span class="fl">0.025</span>, </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">xmax =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"black"</span>, </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.85</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> inc_data_dbl[<span class="fu">which</span>(<span class="fu">is.na</span>(inc_data_dbl<span class="sc">$</span>theta) <span class="sc">&amp;</span> inc_data_dbl<span class="sc">$</span>original),], </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> true_theta), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Original"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_angles</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), <span class="at">midpoint =</span> pi) <span class="sc">+</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">theta$"</span>)) <span class="sc">+</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatterplot-inc" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatterplot-inc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-scatterplot-inc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: A wrapped circular-linear scatterplot of the incomplete data. Incomplete observations have the true masked value marked with a red “x” and are highlighted with a gray vertical band."><img src="imp-data-viz_files/figure-html/fig-scatterplot-inc-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatterplot-inc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: A wrapped circular-linear scatterplot of the incomplete data. Incomplete observations have the true masked value marked with a red “x” and are highlighted with a gray vertical band.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>inc_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="tbl-sim-missing" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sim-missing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Simulated incomplete data
</figcaption>
<div aria-describedby="tbl-sim-missing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["theta"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["U1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["U2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["X"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"NA","4":"-2.00000000"},{"1":"3.772529","2":"-0.807475443","3":"-0.5899012","4":"-1.91836735"},{"1":"5.272702","2":"0.531451452","3":"-0.8470888","4":"-1.83673469"},{"1":"5.296858","2":"0.551756726","3":"-0.8340051","4":"-1.75510204"},{"1":"NA","2":"NA","3":"NA","4":"-1.67346939"},{"1":"4.202808","2":"-0.487811568","3":"-0.8729490","4":"-1.59183673"},{"1":"4.409581","2":"-0.298202075","3":"-0.9545028","4":"-1.51020408"},{"1":"4.979177","2":"0.263634444","3":"-0.9646227","4":"-1.42857143"},{"1":"NA","2":"NA","3":"NA","4":"-1.34693878"},{"1":"3.589057","2":"-0.901546919","3":"-0.4326814","4":"-1.26530612"},{"1":"NA","2":"NA","3":"NA","4":"-1.18367347"},{"1":"NA","2":"NA","3":"NA","4":"-1.10204082"},{"1":"5.988304","2":"0.956836501","3":"-0.2906268","4":"-1.02040816"},{"1":"1.532908","2":"0.037879359","3":"0.9992823","4":"-0.93877551"},{"1":"5.136639","2":"0.411637030","3":"-0.9113479","4":"-0.85714286"},{"1":"NA","2":"NA","3":"NA","4":"-0.77551020"},{"1":"1.076762","2":"0.474181236","3":"0.8804273","4":"-0.69387755"},{"1":"1.453983","2":"0.116547821","3":"0.9931851","4":"-0.61224490"},{"1":"NA","2":"NA","3":"NA","4":"-0.53061224"},{"1":"1.648199","2":"-0.077325019","3":"0.9970059","4":"-0.44897959"},{"1":"2.018677","2":"-0.433056645","3":"0.9013667","4":"-0.36734694"},{"1":"2.101094","2":"-0.505790436","3":"0.8626564","4":"-0.28571429"},{"1":"1.761681","2":"-0.189727818","3":"0.9818367","4":"-0.20408163"},{"1":"1.748096","2":"-0.176371993","3":"0.9843236","4":"-0.12244898"},{"1":"NA","2":"NA","3":"NA","4":"-0.04081633"},{"1":"2.138919","2":"-0.538050190","3":"0.8429128","4":"0.04081633"},{"1":"NA","2":"NA","3":"NA","4":"0.12244898"},{"1":"NA","2":"NA","3":"NA","4":"0.20408163"},{"1":"2.005397","2":"-0.421048551","3":"0.9070381","4":"0.28571429"},{"1":"1.671520","2":"-0.100553510","3":"0.9949317","4":"0.36734694"},{"1":"1.640855","2":"-0.070001724","3":"0.9975469","4":"0.44897959"},{"1":"1.851676","2":"-0.277201215","3":"0.9608119","4":"0.53061224"},{"1":"NA","2":"NA","3":"NA","4":"0.61224490"},{"1":"1.516569","2":"0.054201229","3":"0.9985300","4":"0.69387755"},{"1":"1.357949","2":"0.211244091","3":"0.9774333","4":"0.77551020"},{"1":"1.934853","2":"-0.356067825","3":"0.9344601","4":"0.85714286"},{"1":"1.653063","2":"-0.082174194","3":"0.9966180","4":"0.93877551"},{"1":"1.577200","2":"-0.006403339","3":"0.9999795","4":"1.02040816"},{"1":"NA","2":"NA","3":"NA","4":"1.10204082"},{"1":"1.373915","2":"0.195611893","3":"0.9806814","4":"1.18367347"},{"1":"NA","2":"NA","3":"NA","4":"1.26530612"},{"1":"1.843846","2":"-0.269668979","3":"0.9629531","4":"1.34693878"},{"1":"1.251785","2":"0.313627529","3":"0.9495461","4":"1.42857143"},{"1":"1.609272","2":"-0.038466281","3":"0.9992599","4":"1.51020408"},{"1":"1.479827","2":"0.090843614","3":"0.9958652","4":"1.59183673"},{"1":"1.458512","2":"0.112048705","3":"0.9937027","4":"1.67346939"},{"1":"1.776260","2":"-0.204020959","3":"0.9789665","4":"1.75510204"},{"1":"NA","2":"NA","3":"NA","4":"1.83673469"},{"1":"1.434274","2":"0.136098896","3":"0.9906953","4":"1.91836735"},{"1":"1.585414","2":"-0.014617347","3":"0.9998932","4":"2.00000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="impute-the-missing-angular-data" class="level2">
<h2 class="anchored" data-anchor-id="impute-the-missing-angular-data">Impute the Missing Angular Data</h2>
<p>Next, the data needs to be passed to the <code>mice()</code> function with some customized arguments (and with the <code>imputeangles</code> and <code>pnregstan</code> packages loaded).</p>
<ul>
<li>A generic <code>mids</code> object is created by setting the max. iterations to 0. We use this obejct to get placeholders for the methods vector and the predictor indicator matrix.</li>
<li>The predictor matrix is modified to turn off the unit vector components from being used to impute the missing angular observations.</li>
<li>The methods vector is modified to impute the unit vector components using functions of the imputed angle.</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>imp0 <span class="ot">&lt;-</span> <span class="fu">mice</span>(inc_data, <span class="at">maxit =</span> <span class="dv">0</span>, <span class="at">method =</span> <span class="st">"pnregid"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>pred_mat <span class="ot">&lt;-</span> imp0<span class="sc">$</span>predictorMatrix</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>mthds <span class="ot">&lt;-</span> imp0<span class="sc">$</span>method</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>pred_mat[<span class="st">"theta"</span>,<span class="fu">c</span>(<span class="st">"U1"</span>, <span class="st">"U2"</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>mthds[<span class="st">"U1"</span>] <span class="ot">&lt;-</span> <span class="st">"~cos(theta)"</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>mthds[<span class="st">"U2"</span>] <span class="ot">&lt;-</span> <span class="st">"~sin(theta)"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Then we run <code>mice()</code> with these modified arguments.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>imps <span class="ot">&lt;-</span> <span class="fu">mice</span>(inc_data, <span class="at">method =</span> mthds, <span class="at">predictorMatrix =</span> pred_mat,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">m =</span> M, <span class="at">maxit =</span> <span class="dv">10</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="imputation-figures" class="level2">
<h2 class="anchored" data-anchor-id="imputation-figures">Imputation Figures</h2>
<p>Finally, we can look at the imputation diagnostic plots. They allow us to check how much variation there is in the imputations for each observation and how they compare to the observed parts of the data set.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">By Observation</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Overlaid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">Built-in MICE Stripplot</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>imputeangles<span class="sc">::</span><span class="fu">plot_angular_imputations</span>(imps, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fl">0.75</span>, <span class="at">by_id =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-imp-ob" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imp-ob-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-imp-ob-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Visualize the imputations for each incomplete angular observation. This is a function from imputeangles."><img src="imp-data-viz_files/figure-html/fig-imp-ob-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imp-ob-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Visualize the imputations for each incomplete angular observation. This is a function from <code>imputeangles</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>imputeangles<span class="sc">::</span><span class="fu">plot_angular_imputations</span>(imps, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fl">0.45</span>, <span class="at">by_id =</span> <span class="cn">FALSE</span>, <span class="at">overlay =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-imp-overlay" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imp-overlay-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-imp-overlay-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Use dotplots to see how the distributions of each imputed data set compare to the observed. This is a function from imputeangles."><img src="imp-data-viz_files/figure-html/fig-imp-overlay-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imp-overlay-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Use dotplots to see how the distributions of each imputed data set compare to the observed. This is a function from <code>imputeangles</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imps, theta <span class="sc">~</span> X <span class="sc">|</span> .imp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-mice" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-mice-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Built-in Stripplot from MICE."><img src="imp-data-viz_files/figure-html/fig-mice-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mice-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Built-in Stripplot from MICE.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Additional diagnostic plots can be created after converting the imputations from <code>mids</code> format to a long imputation data frame format.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>long_imp <span class="ot">&lt;-</span> <span class="fu">complete</span>(imps, <span class="st">"long"</span>, <span class="at">include =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>long_imp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":[".imp"],"name":[1],"type":["int"],"align":["right"]},{"label":[".id"],"name":[2],"type":["int"],"align":["right"]},{"label":["theta"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["U1"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["U2"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["X"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"1","3":"NA","4":"NA","5":"NA","6":"-2.00000000","_rn_":"1"},{"1":"0","2":"2","3":"3.7725291","4":"-0.807475443","5":"-0.58990119","6":"-1.91836735","_rn_":"2"},{"1":"0","2":"3","3":"5.2727021","4":"0.531451452","5":"-0.84708875","6":"-1.83673469","_rn_":"3"},{"1":"0","2":"4","3":"5.2968581","4":"0.551756726","5":"-0.83400511","6":"-1.75510204","_rn_":"4"},{"1":"0","2":"5","3":"NA","4":"NA","5":"NA","6":"-1.67346939","_rn_":"5"},{"1":"0","2":"6","3":"4.2028079","4":"-0.487811568","5":"-0.87294895","6":"-1.59183673","_rn_":"6"},{"1":"0","2":"7","3":"4.4095805","4":"-0.298202075","5":"-0.95450276","6":"-1.51020408","_rn_":"7"},{"1":"0","2":"8","3":"4.9791770","4":"0.263634444","5":"-0.96462266","6":"-1.42857143","_rn_":"8"},{"1":"0","2":"9","3":"NA","4":"NA","5":"NA","6":"-1.34693878","_rn_":"9"},{"1":"0","2":"10","3":"3.5890575","4":"-0.901546919","5":"-0.43268135","6":"-1.26530612","_rn_":"10"},{"1":"0","2":"11","3":"NA","4":"NA","5":"NA","6":"-1.18367347","_rn_":"11"},{"1":"0","2":"12","3":"NA","4":"NA","5":"NA","6":"-1.10204082","_rn_":"12"},{"1":"0","2":"13","3":"5.9883035","4":"0.956836501","5":"-0.29062676","6":"-1.02040816","_rn_":"13"},{"1":"0","2":"14","3":"1.5329079","4":"0.037879359","5":"0.99928232","6":"-0.93877551","_rn_":"14"},{"1":"0","2":"15","3":"5.1366386","4":"0.411637030","5":"-0.91134788","6":"-0.85714286","_rn_":"15"},{"1":"0","2":"16","3":"NA","4":"NA","5":"NA","6":"-0.77551020","_rn_":"16"},{"1":"0","2":"17","3":"1.0767625","4":"0.474181236","5":"0.88042726","6":"-0.69387755","_rn_":"17"},{"1":"0","2":"18","3":"1.4539830","4":"0.116547821","5":"0.99318508","6":"-0.61224490","_rn_":"18"},{"1":"0","2":"19","3":"NA","4":"NA","5":"NA","6":"-0.53061224","_rn_":"19"},{"1":"0","2":"20","3":"1.6481986","4":"-0.077325019","5":"0.99700594","6":"-0.44897959","_rn_":"20"},{"1":"0","2":"21","3":"2.0186775","4":"-0.433056645","5":"0.90136671","6":"-0.36734694","_rn_":"21"},{"1":"0","2":"22","3":"2.1010943","4":"-0.505790436","5":"0.86265638","6":"-0.28571429","_rn_":"22"},{"1":"0","2":"23","3":"1.7616812","4":"-0.189727818","5":"0.98183673","6":"-0.20408163","_rn_":"23"},{"1":"0","2":"24","3":"1.7480958","4":"-0.176371993","5":"0.98432359","6":"-0.12244898","_rn_":"24"},{"1":"0","2":"25","3":"NA","4":"NA","5":"NA","6":"-0.04081633","_rn_":"25"},{"1":"0","2":"26","3":"2.1389185","4":"-0.538050190","5":"0.84291280","6":"0.04081633","_rn_":"26"},{"1":"0","2":"27","3":"NA","4":"NA","5":"NA","6":"0.12244898","_rn_":"27"},{"1":"0","2":"28","3":"NA","4":"NA","5":"NA","6":"0.20408163","_rn_":"28"},{"1":"0","2":"29","3":"2.0053974","4":"-0.421048551","5":"0.90703810","6":"0.28571429","_rn_":"29"},{"1":"0","2":"30","3":"1.6715201","4":"-0.100553510","5":"0.99493165","6":"0.36734694","_rn_":"30"},{"1":"0","2":"31","3":"1.6408553","4":"-0.070001724","5":"0.99754687","6":"0.44897959","_rn_":"31"},{"1":"0","2":"32","3":"1.8516763","4":"-0.277201215","5":"0.96081189","6":"0.53061224","_rn_":"32"},{"1":"0","2":"33","3":"NA","4":"NA","5":"NA","6":"0.61224490","_rn_":"33"},{"1":"0","2":"34","3":"1.5165685","4":"0.054201229","5":"0.99853003","6":"0.69387755","_rn_":"34"},{"1":"0","2":"35","3":"1.3579487","4":"0.211244091","5":"0.97743334","6":"0.77551020","_rn_":"35"},{"1":"0","2":"36","3":"1.9348529","4":"-0.356067825","5":"0.93446011","6":"0.85714286","_rn_":"36"},{"1":"0","2":"37","3":"1.6530633","4":"-0.082174194","5":"0.99661798","6":"0.93877551","_rn_":"37"},{"1":"0","2":"38","3":"1.5771997","4":"-0.006403339","5":"0.99997950","6":"1.02040816","_rn_":"38"},{"1":"0","2":"39","3":"NA","4":"NA","5":"NA","6":"1.10204082","_rn_":"39"},{"1":"0","2":"40","3":"1.3739150","4":"0.195611893","5":"0.98068139","6":"1.18367347","_rn_":"40"},{"1":"0","2":"41","3":"NA","4":"NA","5":"NA","6":"1.26530612","_rn_":"41"},{"1":"0","2":"42","3":"1.8438456","4":"-0.269668979","5":"0.96295308","6":"1.34693878","_rn_":"42"},{"1":"0","2":"43","3":"1.2517854","4":"0.313627529","5":"0.94954609","6":"1.42857143","_rn_":"43"},{"1":"0","2":"44","3":"1.6092721","4":"-0.038466281","5":"0.99925990","6":"1.51020408","_rn_":"44"},{"1":"0","2":"45","3":"1.4798273","4":"0.090843614","5":"0.99586517","6":"1.59183673","_rn_":"45"},{"1":"0","2":"46","3":"1.4585118","4":"0.112048705","5":"0.99370272","6":"1.67346939","_rn_":"46"},{"1":"0","2":"47","3":"1.7762599","4":"-0.204020959","5":"0.97896652","6":"1.75510204","_rn_":"47"},{"1":"0","2":"48","3":"NA","4":"NA","5":"NA","6":"1.83673469","_rn_":"48"},{"1":"0","2":"49","3":"1.4342737","4":"0.136098896","5":"0.99069526","6":"1.91836735","_rn_":"49"},{"1":"0","2":"50","3":"1.5854142","4":"-0.014617347","5":"0.99989316","6":"2.00000000","_rn_":"50"},{"1":"1","2":"1","3":"4.5354453","4":"-0.176021794","5":"-0.98438627","6":"-2.00000000","_rn_":"51"},{"1":"1","2":"2","3":"3.7725291","4":"-0.807475443","5":"-0.58990119","6":"-1.91836735","_rn_":"52"},{"1":"1","2":"3","3":"5.2727021","4":"0.531451452","5":"-0.84708875","6":"-1.83673469","_rn_":"53"},{"1":"1","2":"4","3":"5.2968581","4":"0.551756726","5":"-0.83400511","6":"-1.75510204","_rn_":"54"},{"1":"1","2":"5","3":"4.4649853","4":"-0.244887515","5":"-0.96955150","6":"-1.67346939","_rn_":"55"},{"1":"1","2":"6","3":"4.2028079","4":"-0.487811568","5":"-0.87294895","6":"-1.59183673","_rn_":"56"},{"1":"1","2":"7","3":"4.4095805","4":"-0.298202075","5":"-0.95450276","6":"-1.51020408","_rn_":"57"},{"1":"1","2":"8","3":"4.9791770","4":"0.263634444","5":"-0.96462266","6":"-1.42857143","_rn_":"58"},{"1":"1","2":"9","3":"2.5739900","4":"-0.843192240","5":"0.53761217","6":"-1.34693878","_rn_":"59"},{"1":"1","2":"10","3":"3.5890575","4":"-0.901546919","5":"-0.43268135","6":"-1.26530612","_rn_":"60"},{"1":"1","2":"11","3":"4.0230753","4":"-0.636007706","5":"-0.77168271","6":"-1.18367347","_rn_":"61"},{"1":"1","2":"12","3":"1.4928600","4":"0.077857452","5":"0.99696450","6":"-1.10204082","_rn_":"62"},{"1":"1","2":"13","3":"5.9883035","4":"0.956836501","5":"-0.29062676","6":"-1.02040816","_rn_":"63"},{"1":"1","2":"14","3":"1.5329079","4":"0.037879359","5":"0.99928232","6":"-0.93877551","_rn_":"64"},{"1":"1","2":"15","3":"5.1366386","4":"0.411637030","5":"-0.91134788","6":"-0.85714286","_rn_":"65"},{"1":"1","2":"16","3":"1.2350300","4":"0.329492800","5":"0.94415809","6":"-0.77551020","_rn_":"66"},{"1":"1","2":"17","3":"1.0767625","4":"0.474181236","5":"0.88042726","6":"-0.69387755","_rn_":"67"},{"1":"1","2":"18","3":"1.4539830","4":"0.116547821","5":"0.99318508","6":"-0.61224490","_rn_":"68"},{"1":"1","2":"19","3":"1.3591900","4":"0.210030667","5":"0.97769480","6":"-0.53061224","_rn_":"69"},{"1":"1","2":"20","3":"1.6481986","4":"-0.077325019","5":"0.99700594","6":"-0.44897959","_rn_":"70"},{"1":"1","2":"21","3":"2.0186775","4":"-0.433056645","5":"0.90136671","6":"-0.36734694","_rn_":"71"},{"1":"1","2":"22","3":"2.1010943","4":"-0.505790436","5":"0.86265638","6":"-0.28571429","_rn_":"72"},{"1":"1","2":"23","3":"1.7616812","4":"-0.189727818","5":"0.98183673","6":"-0.20408163","_rn_":"73"},{"1":"1","2":"24","3":"1.7480958","4":"-0.176371993","5":"0.98432359","6":"-0.12244898","_rn_":"74"},{"1":"1","2":"25","3":"1.9758400","4":"-0.394058900","5":"0.91908519","6":"-0.04081633","_rn_":"75"},{"1":"1","2":"26","3":"2.1389185","4":"-0.538050190","5":"0.84291280","6":"0.04081633","_rn_":"76"},{"1":"1","2":"27","3":"1.3592100","4":"0.210011114","5":"0.97769900","6":"0.12244898","_rn_":"77"},{"1":"1","2":"28","3":"1.1146200","4":"0.440518658","5":"0.89774346","6":"0.20408163","_rn_":"78"},{"1":"1","2":"29","3":"2.0053974","4":"-0.421048551","5":"0.90703810","6":"0.28571429","_rn_":"79"},{"1":"1","2":"30","3":"1.6715201","4":"-0.100553510","5":"0.99493165","6":"0.36734694","_rn_":"80"},{"1":"1","2":"31","3":"1.6408553","4":"-0.070001724","5":"0.99754687","6":"0.44897959","_rn_":"81"},{"1":"1","2":"32","3":"1.8516763","4":"-0.277201215","5":"0.96081189","6":"0.53061224","_rn_":"82"},{"1":"1","2":"33","3":"1.7654000","4":"-0.193377704","5":"0.98112439","6":"0.61224490","_rn_":"83"},{"1":"1","2":"34","3":"1.5165685","4":"0.054201229","5":"0.99853003","6":"0.69387755","_rn_":"84"},{"1":"1","2":"35","3":"1.3579487","4":"0.211244091","5":"0.97743334","6":"0.77551020","_rn_":"85"},{"1":"1","2":"36","3":"1.9348529","4":"-0.356067825","5":"0.93446011","6":"0.85714286","_rn_":"86"},{"1":"1","2":"37","3":"1.6530633","4":"-0.082174194","5":"0.99661798","6":"0.93877551","_rn_":"87"},{"1":"1","2":"38","3":"1.5771997","4":"-0.006403339","5":"0.99997950","6":"1.02040816","_rn_":"88"},{"1":"1","2":"39","3":"1.4074700","4":"0.162601160","5":"0.98669188","6":"1.10204082","_rn_":"89"},{"1":"1","2":"40","3":"1.3739150","4":"0.195611893","5":"0.98068139","6":"1.18367347","_rn_":"90"},{"1":"1","2":"41","3":"1.5876400","4":"-0.016842877","5":"0.99985815","6":"1.26530612","_rn_":"91"},{"1":"1","2":"42","3":"1.8438456","4":"-0.269668979","5":"0.96295308","6":"1.34693878","_rn_":"92"},{"1":"1","2":"43","3":"1.2517854","4":"0.313627529","5":"0.94954609","6":"1.42857143","_rn_":"93"},{"1":"1","2":"44","3":"1.6092721","4":"-0.038466281","5":"0.99925990","6":"1.51020408","_rn_":"94"},{"1":"1","2":"45","3":"1.4798273","4":"0.090843614","5":"0.99586517","6":"1.59183673","_rn_":"95"},{"1":"1","2":"46","3":"1.4585118","4":"0.112048705","5":"0.99370272","6":"1.67346939","_rn_":"96"},{"1":"1","2":"47","3":"1.7762599","4":"-0.204020959","5":"0.97896652","6":"1.75510204","_rn_":"97"},{"1":"1","2":"48","3":"1.5244100","4":"0.046369694","5":"0.99892435","6":"1.83673469","_rn_":"98"},{"1":"1","2":"49","3":"1.4342737","4":"0.136098896","5":"0.99069526","6":"1.91836735","_rn_":"99"},{"1":"1","2":"50","3":"1.5854142","4":"-0.014617347","5":"0.99989316","6":"2.00000000","_rn_":"100"},{"1":"2","2":"1","3":"5.2516253","4":"0.513480833","5":"-0.85810106","6":"-2.00000000","_rn_":"101"},{"1":"2","2":"2","3":"3.7725291","4":"-0.807475443","5":"-0.58990119","6":"-1.91836735","_rn_":"102"},{"1":"2","2":"3","3":"5.2727021","4":"0.531451452","5":"-0.84708875","6":"-1.83673469","_rn_":"103"},{"1":"2","2":"4","3":"5.2968581","4":"0.551756726","5":"-0.83400511","6":"-1.75510204","_rn_":"104"},{"1":"2","2":"5","3":"0.1838650","4":"0.983144397","5":"0.18283078","6":"-1.67346939","_rn_":"105"},{"1":"2","2":"6","3":"4.2028079","4":"-0.487811568","5":"-0.87294895","6":"-1.59183673","_rn_":"106"},{"1":"2","2":"7","3":"4.4095805","4":"-0.298202075","5":"-0.95450276","6":"-1.51020408","_rn_":"107"},{"1":"2","2":"8","3":"4.9791770","4":"0.263634444","5":"-0.96462266","6":"-1.42857143","_rn_":"108"},{"1":"2","2":"9","3":"1.4625500","4":"0.108035059","5":"0.99414708","6":"-1.34693878","_rn_":"109"},{"1":"2","2":"10","3":"3.5890575","4":"-0.901546919","5":"-0.43268135","6":"-1.26530612","_rn_":"110"},{"1":"2","2":"11","3":"1.2529800","4":"0.312492992","5":"0.94992006","6":"-1.18367347","_rn_":"111"},{"1":"2","2":"12","3":"2.2308300","4":"-0.613143453","5":"0.78997159","6":"-1.10204082","_rn_":"112"},{"1":"2","2":"13","3":"5.9883035","4":"0.956836501","5":"-0.29062676","6":"-1.02040816","_rn_":"113"},{"1":"2","2":"14","3":"1.5329079","4":"0.037879359","5":"0.99928232","6":"-0.93877551","_rn_":"114"},{"1":"2","2":"15","3":"5.1366386","4":"0.411637030","5":"-0.91134788","6":"-0.85714286","_rn_":"115"},{"1":"2","2":"16","3":"1.8332500","4":"-0.259450981","5":"0.96575628","6":"-0.77551020","_rn_":"116"},{"1":"2","2":"17","3":"1.0767625","4":"0.474181236","5":"0.88042726","6":"-0.69387755","_rn_":"117"},{"1":"2","2":"18","3":"1.4539830","4":"0.116547821","5":"0.99318508","6":"-0.61224490","_rn_":"118"},{"1":"2","2":"19","3":"1.5462800","4":"0.024513871","5":"0.99969949","6":"-0.53061224","_rn_":"119"},{"1":"2","2":"20","3":"1.6481986","4":"-0.077325019","5":"0.99700594","6":"-0.44897959","_rn_":"120"},{"1":"2","2":"21","3":"2.0186775","4":"-0.433056645","5":"0.90136671","6":"-0.36734694","_rn_":"121"},{"1":"2","2":"22","3":"2.1010943","4":"-0.505790436","5":"0.86265638","6":"-0.28571429","_rn_":"122"},{"1":"2","2":"23","3":"1.7616812","4":"-0.189727818","5":"0.98183673","6":"-0.20408163","_rn_":"123"},{"1":"2","2":"24","3":"1.7480958","4":"-0.176371993","5":"0.98432359","6":"-0.12244898","_rn_":"124"},{"1":"2","2":"25","3":"1.6653400","4":"-0.094402890","5":"0.99553407","6":"-0.04081633","_rn_":"125"},{"1":"2","2":"26","3":"2.1389185","4":"-0.538050190","5":"0.84291280","6":"0.04081633","_rn_":"126"},{"1":"2","2":"27","3":"1.4366300","4":"0.133764176","5":"0.99101319","6":"0.12244898","_rn_":"127"},{"1":"2","2":"28","3":"1.3120600","4":"0.255859146","5":"0.96671407","6":"0.20408163","_rn_":"128"},{"1":"2","2":"29","3":"2.0053974","4":"-0.421048551","5":"0.90703810","6":"0.28571429","_rn_":"129"},{"1":"2","2":"30","3":"1.6715201","4":"-0.100553510","5":"0.99493165","6":"0.36734694","_rn_":"130"},{"1":"2","2":"31","3":"1.6408553","4":"-0.070001724","5":"0.99754687","6":"0.44897959","_rn_":"131"},{"1":"2","2":"32","3":"1.8516763","4":"-0.277201215","5":"0.96081189","6":"0.53061224","_rn_":"132"},{"1":"2","2":"33","3":"1.6865400","4":"-0.115485418","5":"0.99330918","6":"0.61224490","_rn_":"133"},{"1":"2","2":"34","3":"1.5165685","4":"0.054201229","5":"0.99853003","6":"0.69387755","_rn_":"134"},{"1":"2","2":"35","3":"1.3579487","4":"0.211244091","5":"0.97743334","6":"0.77551020","_rn_":"135"},{"1":"2","2":"36","3":"1.9348529","4":"-0.356067825","5":"0.93446011","6":"0.85714286","_rn_":"136"},{"1":"2","2":"37","3":"1.6530633","4":"-0.082174194","5":"0.99661798","6":"0.93877551","_rn_":"137"},{"1":"2","2":"38","3":"1.5771997","4":"-0.006403339","5":"0.99997950","6":"1.02040816","_rn_":"138"},{"1":"2","2":"39","3":"1.4293500","4":"0.140975144","5":"0.99001314","6":"1.10204082","_rn_":"139"},{"1":"2","2":"40","3":"1.3739150","4":"0.195611893","5":"0.98068139","6":"1.18367347","_rn_":"140"},{"1":"2","2":"41","3":"1.4918000","4":"0.078914191","5":"0.99688141","6":"1.26530612","_rn_":"141"},{"1":"2","2":"42","3":"1.8438456","4":"-0.269668979","5":"0.96295308","6":"1.34693878","_rn_":"142"},{"1":"2","2":"43","3":"1.2517854","4":"0.313627529","5":"0.94954609","6":"1.42857143","_rn_":"143"},{"1":"2","2":"44","3":"1.6092721","4":"-0.038466281","5":"0.99925990","6":"1.51020408","_rn_":"144"},{"1":"2","2":"45","3":"1.4798273","4":"0.090843614","5":"0.99586517","6":"1.59183673","_rn_":"145"},{"1":"2","2":"46","3":"1.4585118","4":"0.112048705","5":"0.99370272","6":"1.67346939","_rn_":"146"},{"1":"2","2":"47","3":"1.7762599","4":"-0.204020959","5":"0.97896652","6":"1.75510204","_rn_":"147"},{"1":"2","2":"48","3":"1.6298700","4":"-0.059039321","5":"0.99825566","6":"1.83673469","_rn_":"148"},{"1":"2","2":"49","3":"1.4342737","4":"0.136098896","5":"0.99069526","6":"1.91836735","_rn_":"149"},{"1":"2","2":"50","3":"1.5854142","4":"-0.014617347","5":"0.99989316","6":"2.00000000","_rn_":"150"},{"1":"3","2":"1","3":"4.7658953","4":"0.053480800","5":"-0.99856888","6":"-2.00000000","_rn_":"151"},{"1":"3","2":"2","3":"3.7725291","4":"-0.807475443","5":"-0.58990119","6":"-1.91836735","_rn_":"152"},{"1":"3","2":"3","3":"5.2727021","4":"0.531451452","5":"-0.84708875","6":"-1.83673469","_rn_":"153"},{"1":"3","2":"4","3":"5.2968581","4":"0.551756726","5":"-0.83400511","6":"-1.75510204","_rn_":"154"},{"1":"3","2":"5","3":"5.6622373","4":"0.813327270","5":"-0.58180646","6":"-1.67346939","_rn_":"155"},{"1":"3","2":"6","3":"4.2028079","4":"-0.487811568","5":"-0.87294895","6":"-1.59183673","_rn_":"156"},{"1":"3","2":"7","3":"4.4095805","4":"-0.298202075","5":"-0.95450276","6":"-1.51020408","_rn_":"157"},{"1":"3","2":"8","3":"4.9791770","4":"0.263634444","5":"-0.96462266","6":"-1.42857143","_rn_":"158"},{"1":"3","2":"9","3":"3.8565853","4":"-0.755098058","5":"-0.65561187","6":"-1.34693878","_rn_":"159"},{"1":"3","2":"10","3":"3.5890575","4":"-0.901546919","5":"-0.43268135","6":"-1.26530612","_rn_":"160"},{"1":"3","2":"11","3":"1.1220800","4":"0.433809296","5":"0.90100471","6":"-1.18367347","_rn_":"161"},{"1":"3","2":"12","3":"2.4505100","4":"-0.770556414","5":"0.63737180","6":"-1.10204082","_rn_":"162"},{"1":"3","2":"13","3":"5.9883035","4":"0.956836501","5":"-0.29062676","6":"-1.02040816","_rn_":"163"},{"1":"3","2":"14","3":"1.5329079","4":"0.037879359","5":"0.99928232","6":"-0.93877551","_rn_":"164"},{"1":"3","2":"15","3":"5.1366386","4":"0.411637030","5":"-0.91134788","6":"-0.85714286","_rn_":"165"},{"1":"3","2":"16","3":"1.6524000","4":"-0.081513135","5":"0.99667227","6":"-0.77551020","_rn_":"166"},{"1":"3","2":"17","3":"1.0767625","4":"0.474181236","5":"0.88042726","6":"-0.69387755","_rn_":"167"},{"1":"3","2":"18","3":"1.4539830","4":"0.116547821","5":"0.99318508","6":"-0.61224490","_rn_":"168"},{"1":"3","2":"19","3":"1.8698600","4":"-0.294625570","5":"0.95561277","6":"-0.53061224","_rn_":"169"},{"1":"3","2":"20","3":"1.6481986","4":"-0.077325019","5":"0.99700594","6":"-0.44897959","_rn_":"170"},{"1":"3","2":"21","3":"2.0186775","4":"-0.433056645","5":"0.90136671","6":"-0.36734694","_rn_":"171"},{"1":"3","2":"22","3":"2.1010943","4":"-0.505790436","5":"0.86265638","6":"-0.28571429","_rn_":"172"},{"1":"3","2":"23","3":"1.7616812","4":"-0.189727818","5":"0.98183673","6":"-0.20408163","_rn_":"173"},{"1":"3","2":"24","3":"1.7480958","4":"-0.176371993","5":"0.98432359","6":"-0.12244898","_rn_":"174"},{"1":"3","2":"25","3":"4.4389653","4":"-0.270029504","5":"-0.96285205","6":"-0.04081633","_rn_":"175"},{"1":"3","2":"26","3":"2.1389185","4":"-0.538050190","5":"0.84291280","6":"0.04081633","_rn_":"176"},{"1":"3","2":"27","3":"1.3649100","4":"0.204434848","5":"0.97888017","6":"0.12244898","_rn_":"177"},{"1":"3","2":"28","3":"1.9278100","4":"-0.349477773","5":"0.93694465","6":"0.20408163","_rn_":"178"},{"1":"3","2":"29","3":"2.0053974","4":"-0.421048551","5":"0.90703810","6":"0.28571429","_rn_":"179"},{"1":"3","2":"30","3":"1.6715201","4":"-0.100553510","5":"0.99493165","6":"0.36734694","_rn_":"180"},{"1":"3","2":"31","3":"1.6408553","4":"-0.070001724","5":"0.99754687","6":"0.44897959","_rn_":"181"},{"1":"3","2":"32","3":"1.8516763","4":"-0.277201215","5":"0.96081189","6":"0.53061224","_rn_":"182"},{"1":"3","2":"33","3":"1.6643500","4":"-0.093417265","5":"0.99562705","6":"0.61224490","_rn_":"183"},{"1":"3","2":"34","3":"1.5165685","4":"0.054201229","5":"0.99853003","6":"0.69387755","_rn_":"184"},{"1":"3","2":"35","3":"1.3579487","4":"0.211244091","5":"0.97743334","6":"0.77551020","_rn_":"185"},{"1":"3","2":"36","3":"1.9348529","4":"-0.356067825","5":"0.93446011","6":"0.85714286","_rn_":"186"},{"1":"3","2":"37","3":"1.6530633","4":"-0.082174194","5":"0.99661798","6":"0.93877551","_rn_":"187"},{"1":"3","2":"38","3":"1.5771997","4":"-0.006403339","5":"0.99997950","6":"1.02040816","_rn_":"188"},{"1":"3","2":"39","3":"1.6153600","4":"-0.044548925","5":"0.99900720","6":"1.10204082","_rn_":"189"},{"1":"3","2":"40","3":"1.3739150","4":"0.195611893","5":"0.98068139","6":"1.18367347","_rn_":"190"},{"1":"3","2":"41","3":"2.0252900","4":"-0.439007444","5":"0.89848342","6":"1.26530612","_rn_":"191"},{"1":"3","2":"42","3":"1.8438456","4":"-0.269668979","5":"0.96295308","6":"1.34693878","_rn_":"192"},{"1":"3","2":"43","3":"1.2517854","4":"0.313627529","5":"0.94954609","6":"1.42857143","_rn_":"193"},{"1":"3","2":"44","3":"1.6092721","4":"-0.038466281","5":"0.99925990","6":"1.51020408","_rn_":"194"},{"1":"3","2":"45","3":"1.4798273","4":"0.090843614","5":"0.99586517","6":"1.59183673","_rn_":"195"},{"1":"3","2":"46","3":"1.4585118","4":"0.112048705","5":"0.99370272","6":"1.67346939","_rn_":"196"},{"1":"3","2":"47","3":"1.7762599","4":"-0.204020959","5":"0.97896652","6":"1.75510204","_rn_":"197"},{"1":"3","2":"48","3":"1.4087700","4":"0.161318323","5":"0.98690243","6":"1.83673469","_rn_":"198"},{"1":"3","2":"49","3":"1.4342737","4":"0.136098896","5":"0.99069526","6":"1.91836735","_rn_":"199"},{"1":"3","2":"50","3":"1.5854142","4":"-0.014617347","5":"0.99989316","6":"2.00000000","_rn_":"200"},{"1":"4","2":"1","3":"4.9565253","4":"0.241718353","5":"-0.97034645","6":"-2.00000000","_rn_":"201"},{"1":"4","2":"2","3":"3.7725291","4":"-0.807475443","5":"-0.58990119","6":"-1.91836735","_rn_":"202"},{"1":"4","2":"3","3":"5.2727021","4":"0.531451452","5":"-0.84708875","6":"-1.83673469","_rn_":"203"},{"1":"4","2":"4","3":"5.2968581","4":"0.551756726","5":"-0.83400511","6":"-1.75510204","_rn_":"204"},{"1":"4","2":"5","3":"6.1823083","4":"0.994916229","5":"-0.10070600","6":"-1.67346939","_rn_":"205"},{"1":"4","2":"6","3":"4.2028079","4":"-0.487811568","5":"-0.87294895","6":"-1.59183673","_rn_":"206"},{"1":"4","2":"7","3":"4.4095805","4":"-0.298202075","5":"-0.95450276","6":"-1.51020408","_rn_":"207"},{"1":"4","2":"8","3":"4.9791770","4":"0.263634444","5":"-0.96462266","6":"-1.42857143","_rn_":"208"},{"1":"4","2":"9","3":"1.7923600","4":"-0.219755340","5":"0.97555502","6":"-1.34693878","_rn_":"209"},{"1":"4","2":"10","3":"3.5890575","4":"-0.901546919","5":"-0.43268135","6":"-1.26530612","_rn_":"210"},{"1":"4","2":"11","3":"4.8216853","4":"0.109078853","5":"-0.99403310","6":"-1.18367347","_rn_":"211"},{"1":"4","2":"12","3":"0.4860880","4":"0.884167191","5":"0.46717061","6":"-1.10204082","_rn_":"212"},{"1":"4","2":"13","3":"5.9883035","4":"0.956836501","5":"-0.29062676","6":"-1.02040816","_rn_":"213"},{"1":"4","2":"14","3":"1.5329079","4":"0.037879359","5":"0.99928232","6":"-0.93877551","_rn_":"214"},{"1":"4","2":"15","3":"5.1366386","4":"0.411637030","5":"-0.91134788","6":"-0.85714286","_rn_":"215"},{"1":"4","2":"16","3":"1.1950800","4":"0.366938983","5":"0.93024501","6":"-0.77551020","_rn_":"216"},{"1":"4","2":"17","3":"1.0767625","4":"0.474181236","5":"0.88042726","6":"-0.69387755","_rn_":"217"},{"1":"4","2":"18","3":"1.4539830","4":"0.116547821","5":"0.99318508","6":"-0.61224490","_rn_":"218"},{"1":"4","2":"19","3":"1.8132000","4":"-0.240036717","5":"0.97076381","6":"-0.53061224","_rn_":"219"},{"1":"4","2":"20","3":"1.6481986","4":"-0.077325019","5":"0.99700594","6":"-0.44897959","_rn_":"220"},{"1":"4","2":"21","3":"2.0186775","4":"-0.433056645","5":"0.90136671","6":"-0.36734694","_rn_":"221"},{"1":"4","2":"22","3":"2.1010943","4":"-0.505790436","5":"0.86265638","6":"-0.28571429","_rn_":"222"},{"1":"4","2":"23","3":"1.7616812","4":"-0.189727818","5":"0.98183673","6":"-0.20408163","_rn_":"223"},{"1":"4","2":"24","3":"1.7480958","4":"-0.176371993","5":"0.98432359","6":"-0.12244898","_rn_":"224"},{"1":"4","2":"25","3":"1.6029500","4":"-0.032148133","5":"0.99948312","6":"-0.04081633","_rn_":"225"},{"1":"4","2":"26","3":"2.1389185","4":"-0.538050190","5":"0.84291280","6":"0.04081633","_rn_":"226"},{"1":"4","2":"27","3":"1.7997100","4":"-0.226919669","5":"0.97391348","6":"0.12244898","_rn_":"227"},{"1":"4","2":"28","3":"1.4949800","4":"0.075743714","5":"0.99712732","6":"0.20408163","_rn_":"228"},{"1":"4","2":"29","3":"2.0053974","4":"-0.421048551","5":"0.90703810","6":"0.28571429","_rn_":"229"},{"1":"4","2":"30","3":"1.6715201","4":"-0.100553510","5":"0.99493165","6":"0.36734694","_rn_":"230"},{"1":"4","2":"31","3":"1.6408553","4":"-0.070001724","5":"0.99754687","6":"0.44897959","_rn_":"231"},{"1":"4","2":"32","3":"1.8516763","4":"-0.277201215","5":"0.96081189","6":"0.53061224","_rn_":"232"},{"1":"4","2":"33","3":"1.4515800","4":"0.118934133","5":"0.99290215","6":"0.61224490","_rn_":"233"},{"1":"4","2":"34","3":"1.5165685","4":"0.054201229","5":"0.99853003","6":"0.69387755","_rn_":"234"},{"1":"4","2":"35","3":"1.3579487","4":"0.211244091","5":"0.97743334","6":"0.77551020","_rn_":"235"},{"1":"4","2":"36","3":"1.9348529","4":"-0.356067825","5":"0.93446011","6":"0.85714286","_rn_":"236"},{"1":"4","2":"37","3":"1.6530633","4":"-0.082174194","5":"0.99661798","6":"0.93877551","_rn_":"237"},{"1":"4","2":"38","3":"1.5771997","4":"-0.006403339","5":"0.99997950","6":"1.02040816","_rn_":"238"},{"1":"4","2":"39","3":"1.6547700","4":"-0.083875017","5":"0.99647628","6":"1.10204082","_rn_":"239"},{"1":"4","2":"40","3":"1.3739150","4":"0.195611893","5":"0.98068139","6":"1.18367347","_rn_":"240"},{"1":"4","2":"41","3":"1.3949600","4":"0.174931630","5":"0.98458058","6":"1.26530612","_rn_":"241"},{"1":"4","2":"42","3":"1.8438456","4":"-0.269668979","5":"0.96295308","6":"1.34693878","_rn_":"242"},{"1":"4","2":"43","3":"1.2517854","4":"0.313627529","5":"0.94954609","6":"1.42857143","_rn_":"243"},{"1":"4","2":"44","3":"1.6092721","4":"-0.038466281","5":"0.99925990","6":"1.51020408","_rn_":"244"},{"1":"4","2":"45","3":"1.4798273","4":"0.090843614","5":"0.99586517","6":"1.59183673","_rn_":"245"},{"1":"4","2":"46","3":"1.4585118","4":"0.112048705","5":"0.99370272","6":"1.67346939","_rn_":"246"},{"1":"4","2":"47","3":"1.7762599","4":"-0.204020959","5":"0.97896652","6":"1.75510204","_rn_":"247"},{"1":"4","2":"48","3":"1.5388000","4":"0.031990868","5":"0.99948816","6":"1.83673469","_rn_":"248"},{"1":"4","2":"49","3":"1.4342737","4":"0.136098896","5":"0.99069526","6":"1.91836735","_rn_":"249"},{"1":"4","2":"50","3":"1.5854142","4":"-0.014617347","5":"0.99989316","6":"2.00000000","_rn_":"250"},{"1":"5","2":"1","3":"4.6180053","4":"-0.094243603","5":"-0.99554917","6":"-2.00000000","_rn_":"251"},{"1":"5","2":"2","3":"3.7725291","4":"-0.807475443","5":"-0.58990119","6":"-1.91836735","_rn_":"252"},{"1":"5","2":"3","3":"5.2727021","4":"0.531451452","5":"-0.84708875","6":"-1.83673469","_rn_":"253"},{"1":"5","2":"4","3":"5.2968581","4":"0.551756726","5":"-0.83400511","6":"-1.75510204","_rn_":"254"},{"1":"5","2":"5","3":"4.2131153","4":"-0.478788000","5":"-0.87793055","6":"-1.67346939","_rn_":"255"},{"1":"5","2":"6","3":"4.2028079","4":"-0.487811568","5":"-0.87294895","6":"-1.59183673","_rn_":"256"},{"1":"5","2":"7","3":"4.4095805","4":"-0.298202075","5":"-0.95450276","6":"-1.51020408","_rn_":"257"},{"1":"5","2":"8","3":"4.9791770","4":"0.263634444","5":"-0.96462266","6":"-1.42857143","_rn_":"258"},{"1":"5","2":"9","3":"0.3488100","4":"0.939780096","5":"0.34177971","6":"-1.34693878","_rn_":"259"},{"1":"5","2":"10","3":"3.5890575","4":"-0.901546919","5":"-0.43268135","6":"-1.26530612","_rn_":"260"},{"1":"5","2":"11","3":"1.9369200","4":"-0.357998719","5":"0.93372208","6":"-1.18367347","_rn_":"261"},{"1":"5","2":"12","3":"0.0509334","4":"0.998703175","5":"0.05091138","6":"-1.10204082","_rn_":"262"},{"1":"5","2":"13","3":"5.9883035","4":"0.956836501","5":"-0.29062676","6":"-1.02040816","_rn_":"263"},{"1":"5","2":"14","3":"1.5329079","4":"0.037879359","5":"0.99928232","6":"-0.93877551","_rn_":"264"},{"1":"5","2":"15","3":"5.1366386","4":"0.411637030","5":"-0.91134788","6":"-0.85714286","_rn_":"265"},{"1":"5","2":"16","3":"0.3350550","4":"0.944392226","5":"0.32882111","6":"-0.77551020","_rn_":"266"},{"1":"5","2":"17","3":"1.0767625","4":"0.474181236","5":"0.88042726","6":"-0.69387755","_rn_":"267"},{"1":"5","2":"18","3":"1.4539830","4":"0.116547821","5":"0.99318508","6":"-0.61224490","_rn_":"268"},{"1":"5","2":"19","3":"3.1589753","4":"-0.999848925","5":"-0.01738178","6":"-0.53061224","_rn_":"269"},{"1":"5","2":"20","3":"1.6481986","4":"-0.077325019","5":"0.99700594","6":"-0.44897959","_rn_":"270"},{"1":"5","2":"21","3":"2.0186775","4":"-0.433056645","5":"0.90136671","6":"-0.36734694","_rn_":"271"},{"1":"5","2":"22","3":"2.1010943","4":"-0.505790436","5":"0.86265638","6":"-0.28571429","_rn_":"272"},{"1":"5","2":"23","3":"1.7616812","4":"-0.189727818","5":"0.98183673","6":"-0.20408163","_rn_":"273"},{"1":"5","2":"24","3":"1.7480958","4":"-0.176371993","5":"0.98432359","6":"-0.12244898","_rn_":"274"},{"1":"5","2":"25","3":"1.7431500","4":"-0.171501623","5":"0.98518384","6":"-0.04081633","_rn_":"275"},{"1":"5","2":"26","3":"2.1389185","4":"-0.538050190","5":"0.84291280","6":"0.04081633","_rn_":"276"},{"1":"5","2":"27","3":"1.0316300","4":"0.513420764","5":"0.85813700","6":"0.12244898","_rn_":"277"},{"1":"5","2":"28","3":"1.6272800","4":"-0.056453644","5":"0.99840522","6":"0.20408163","_rn_":"278"},{"1":"5","2":"29","3":"2.0053974","4":"-0.421048551","5":"0.90703810","6":"0.28571429","_rn_":"279"},{"1":"5","2":"30","3":"1.6715201","4":"-0.100553510","5":"0.99493165","6":"0.36734694","_rn_":"280"},{"1":"5","2":"31","3":"1.6408553","4":"-0.070001724","5":"0.99754687","6":"0.44897959","_rn_":"281"},{"1":"5","2":"32","3":"1.8516763","4":"-0.277201215","5":"0.96081189","6":"0.53061224","_rn_":"282"},{"1":"5","2":"33","3":"1.8548900","4":"-0.280287569","5":"0.95991608","6":"0.61224490","_rn_":"283"},{"1":"5","2":"34","3":"1.5165685","4":"0.054201229","5":"0.99853003","6":"0.69387755","_rn_":"284"},{"1":"5","2":"35","3":"1.3579487","4":"0.211244091","5":"0.97743334","6":"0.77551020","_rn_":"285"},{"1":"5","2":"36","3":"1.9348529","4":"-0.356067825","5":"0.93446011","6":"0.85714286","_rn_":"286"},{"1":"5","2":"37","3":"1.6530633","4":"-0.082174194","5":"0.99661798","6":"0.93877551","_rn_":"287"},{"1":"5","2":"38","3":"1.5771997","4":"-0.006403339","5":"0.99997950","6":"1.02040816","_rn_":"288"},{"1":"5","2":"39","3":"1.2467100","4":"0.318442810","5":"0.94794207","6":"1.10204082","_rn_":"289"},{"1":"5","2":"40","3":"1.3739150","4":"0.195611893","5":"0.98068139","6":"1.18367347","_rn_":"290"},{"1":"5","2":"41","3":"1.4415300","4":"0.128906625","5":"0.99165674","6":"1.26530612","_rn_":"291"},{"1":"5","2":"42","3":"1.8438456","4":"-0.269668979","5":"0.96295308","6":"1.34693878","_rn_":"292"},{"1":"5","2":"43","3":"1.2517854","4":"0.313627529","5":"0.94954609","6":"1.42857143","_rn_":"293"},{"1":"5","2":"44","3":"1.6092721","4":"-0.038466281","5":"0.99925990","6":"1.51020408","_rn_":"294"},{"1":"5","2":"45","3":"1.4798273","4":"0.090843614","5":"0.99586517","6":"1.59183673","_rn_":"295"},{"1":"5","2":"46","3":"1.4585118","4":"0.112048705","5":"0.99370272","6":"1.67346939","_rn_":"296"},{"1":"5","2":"47","3":"1.7762599","4":"-0.204020959","5":"0.97896652","6":"1.75510204","_rn_":"297"},{"1":"5","2":"48","3":"1.5259400","4":"0.044841286","5":"0.99899412","6":"1.83673469","_rn_":"298"},{"1":"5","2":"49","3":"1.4342737","4":"0.136098896","5":"0.99069526","6":"1.91836735","_rn_":"299"},{"1":"5","2":"50","3":"1.5854142","4":"-0.014617347","5":"0.99989316","6":"2.00000000","_rn_":"300"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Density Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Wrapped Scatterplot</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>long_imp  <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">imp_color =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>            .imp <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"blue"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>            .imp <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"magenta"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        theta<span class="sc">:</span>U2,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="at">color =</span> imp_color, <span class="at">group =</span> .imp)) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#006CC2B3"</span>, <span class="st">"#B61A51B3"</span>), </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Completed"</span>)) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 42 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-imps-dens" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imps-dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-imps-dens-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Diagnostic plots after imputation with MICE. Density plots of the imputed data in pink and observed data in blue."><img src="imp-data-viz_files/figure-html/fig-imps-dens-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imps-dens-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Diagnostic plots after imputation with MICE. Density plots of the imputed data in pink and observed data in blue.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>long_imp <span class="ot">&lt;-</span> long_imp <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">missing_imp =</span> .id <span class="sc">%in%</span> mis_ind <span class="sc">&amp;</span> .imp <span class="sc">&gt;=</span> <span class="dv">1</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">obs_noimp =</span> <span class="sc">!</span>(.id <span class="sc">%in%</span> mis_ind) <span class="sc">&amp;</span> .imp <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">TRUE</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        missing_imp <span class="sc">|</span> obs_noimp</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>long_imp2 <span class="ot">&lt;-</span> long_imp <span class="sc">|&gt;</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> pi <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">FALSE</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">rbind</span>(long_imp, long_imp2), <span class="fu">aes</span>(X, theta, <span class="at">color =</span> <span class="fu">as.factor</span>(.imp), <span class="at">shape =</span> original)) <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.85</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Original"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmin =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">-</span> <span class="fl">0.025</span>, </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">theta$"</span>)) <span class="sc">+</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Imp"</span>,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"magenta"</span>, <span class="st">"tomato"</span>, <span class="st">"orange"</span>, <span class="st">"purple"</span>,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"goldenrod"</span>, <span class="st">"dodgerblue"</span>, <span class="st">"forestgreen"</span>, <span class="st">"green"</span>),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="fu">paste0</span>(<span class="st">"Imp "</span>, <span class="dv">1</span><span class="sc">:</span>M))) <span class="sc">+</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks  =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span>pi, pi, pi)), </span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">TeX</span>(<span class="st">"$-</span><span class="sc">\\</span><span class="st">pi$"</span>), <span class="st">"0"</span>, <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">pi$"</span>))) <span class="sc">+</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-imp-close-up" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imp-close-up-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-imp-close-up-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: A zoomed in look at the imputed time series for times 150 to 200. Red rectangles correspond to missing observations."><img src="imp-data-viz_files/figure-html/fig-imp-close-up-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imp-close-up-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: A zoomed in look at the imputed time series for times 150 to 200. Red rectangles correspond to missing observations.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="imputation-convergence-figures" class="level3">
<h3 class="anchored" data-anchor-id="imputation-convergence-figures">Imputation Convergence Figures</h3>
<p>Spaghetti plots and traceplots with angular data are very useful for assessing convergence of the imputations, but more complex to create. These figures use line plots color coded by imputation with the cycles along the x-axis.</p>
<p>Traceplots are built-in with <code>mice</code> for conventional inline data like <span class="math inline">\(X\)</span> in our simulation. But the traceplots in <a href="#fig-traceplot" class="quarto-xref">Figure&nbsp;8</a> display the mean and standard deviation of the imputations at each iteration, and these statistics are not valid for angular data.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imps)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-traceplot" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-traceplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-traceplot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: The traceplot built-in to mice. This figure does not calculate appropriate summary statistics for the angular variable theta."><img src="imp-data-viz_files/figure-html/fig-traceplot-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-traceplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: The traceplot built-in to <code>mice</code>. This figure does not calculate appropriate summary statistics for the angular variable <code>theta</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Instead we should be calculating the circular mean, circular standard deviation, and circular auto-correlation function. To do so, we need to modify the <code>mice</code> imputation procedure to save the imputations at each cycle in order to calculate our own summary statistics. The corrected traceplot is displayed in <a href="#fig-imp-conv" class="quarto-xref">Figure&nbsp;9</a>.</p>
<p>Lastly, we can also check spaghetti plots with the cycles along the x-axis as in <a href="#fig-imp-spaghetti" class="quarto-xref">Figure&nbsp;10</a>. This lets us check to see if the individual imputations are stationary. There is not a built-in version with <code>mice</code>.</p>
</section>
<section id="extending-mice" class="level3">
<h3 class="anchored" data-anchor-id="extending-mice">Extending MICE</h3>
<p>When <code>mice()</code> is run and a <code>mids</code> object is created, the imputed values, original data, summary statistics for each iteration’s imputations, and meta data are stored. The imputations that occur at each iteration of the algorithm are discarded. In order to save each iterations set of imputations, we need to modify how the imputation procedure is run. The <code>mice.mids()</code> function makes this possible as it creates new imputations starting from where an existing <code>mids</code> object left off. The <code>mids</code> object can be extended either with more imputations <code>M</code> or by increasing the number of iterations <code>maxit</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Extending MICE</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>maxit <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>imp_m <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>M, <span class="cf">function</span>(m) {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Imputation "</span>, m, <span class="st">"; iteration "</span>, <span class="dv">1</span>))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    imp_m <span class="ot">&lt;-</span> <span class="fu">mice</span>(inc_data, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> mthds, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">predictorMatrix =</span> pred_mat, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">printFlag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">.imp =</span> m, <span class="at">.it =</span> <span class="dv">1</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    c_imp_i <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_m, <span class="st">"all"</span>, <span class="at">include =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    c_imp_i <span class="ot">&lt;-</span> c_imp_i[[<span class="dv">1</span>]]</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    c_imp_i<span class="sc">$</span>it <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    c_imp_i<span class="sc">$</span>m <span class="ot">&lt;-</span> m</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    c_imp_i<span class="sc">$</span>.id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(c_imp_i)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">write_csv</span>(c_imp_i, <span class="fu">paste0</span>(root_dir, <span class="st">"imp-"</span>, m, <span class="st">"-it-"</span>, <span class="dv">1</span>, <span class="st">"-imp-df.csv"</span>))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>maxit) {</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Imputation "</span>, m, <span class="st">"; iteration "</span>, it))</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        imp_m <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice.mids</span>(imp_m, <span class="at">maxit =</span> <span class="dv">1</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>, <span class="at">.it =</span> it, <span class="at">.imp =</span> m)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        c_imp_i <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_m, <span class="st">"all"</span>, <span class="at">include =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        c_imp_i <span class="ot">&lt;-</span> c_imp_i[[<span class="dv">1</span>]]</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        c_imp_i<span class="sc">$</span>it <span class="ot">&lt;-</span> it</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        c_imp_i<span class="sc">$</span>m <span class="ot">&lt;-</span> m</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        c_imp_i<span class="sc">$</span>.id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(c_imp_i)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        readr<span class="sc">::</span><span class="fu">write_csv</span>(c_imp_i, <span class="fu">paste0</span>(root_dir, <span class="st">"imp-"</span>, m, <span class="st">"-it-"</span>, it, <span class="st">"-imp-df.csv"</span>))</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(imp_m)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> imp_m[[<span class="dv">1</span>]]</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M) {</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    imp <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">ibind</span>(imp, imp_m[[m]])</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(imp, <span class="fu">paste0</span>(root_dir, <span class="st">"imps2.rds"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Auto-Correlation Functions</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>c_auto_cor <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, <span class="at">k =</span> <span class="dv">1</span>) {</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    sum_determinants <span class="ot">&lt;-</span> <span class="cf">function</span>(X1, X2) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>(N<span class="sc">-</span>k), <span class="cf">function</span>(t) {</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>(<span class="fu">det</span>(<span class="fu">t</span>(X1[t,]) <span class="sc">%*%</span> X2[t,]))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>            }) <span class="sc">|&gt;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">unlist</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>()</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(s)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">length</span>(theta)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    U_lag_k <span class="ot">&lt;-</span> U[<span class="dv">1</span><span class="sc">:</span>(N <span class="sc">-</span> k),]</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    U_no_lag <span class="ot">&lt;-</span> U[(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">sum_determinants</span>(U_lag_k, U_no_lag)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    denom <span class="ot">&lt;-</span> <span class="fu">sum_determinants</span>(U_lag_k, U_lag_k) <span class="sc">*</span> <span class="fu">sum_determinants</span>(U_no_lag, U_no_lag)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(num <span class="sc">/</span> <span class="fu">sqrt</span>(denom))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>my_acf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">acf</span>(x, <span class="at">lag.max =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>,,<span class="dv">1</span>]</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Post-processing imputations</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>longer_imp <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>M, <span class="cf">function</span>(m) {</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>maxit, <span class="cf">function</span>(it) {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(root_dir, <span class="st">"imp-"</span>, m, <span class="st">"-it-"</span>, it, <span class="st">"-imp-df.csv"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">|&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>auto_cor_mat <span class="ot">&lt;-</span> longer_imp <span class="sc">|&gt;</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(m, it) <span class="sc">|&gt;</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta_mean =</span> <span class="fu">atan2</span>(<span class="fu">mean</span>(<span class="fu">sin</span>(theta)), <span class="fu">mean</span>(<span class="fu">cos</span>(theta))),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta_sd =</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">cos</span>(theta))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">mean</span>(<span class="fu">sin</span>(theta))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">u1_mean =</span> <span class="fu">mean</span>(U1),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">u1_sd =</span> <span class="fu">sd</span>(U1),</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">u2_mean =</span> <span class="fu">mean</span>(U2),</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">u2_sd =</span> <span class="fu">sd</span>(U2),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta_ac =</span> <span class="fu">c_auto_cor</span>(theta, <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">u1_ac =</span> <span class="fu">my_acf</span>(U1),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">u2_ac =</span> <span class="fu">my_acf</span>(U2)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'm'. You can override using the `.groups`
argument.</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>auto_cor_mat <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">c</span>(m, it),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"parameter"</span>, <span class="st">"stat"</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_pattern =</span> <span class="st">"(.*)_(.*)"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameter2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>            parameter <span class="sc">==</span> <span class="st">"u1"</span> <span class="sc">~</span> <span class="st">"cos(theta)"</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>            parameter <span class="sc">==</span> <span class="st">"u2"</span> <span class="sc">~</span> <span class="st">"sin(theta)"</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> parameter</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>            stat <span class="sc">==</span> <span class="st">"ac"</span> <span class="sc">~</span> <span class="st">"acf(1)"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(stat)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(it, value, <span class="at">color =</span> <span class="fu">as.factor</span>(m))) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_colorblind</span>(<span class="at">name =</span> <span class="st">"Imp"</span>) <span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(parameter2<span class="sc">~</span>stat2, <span class="at">labeller =</span> label_parsed, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MICE Cycle"</span>,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Value"</span>)  <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-imp-conv" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imp-conv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-imp-conv-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: Traceplots of the imputed values means and standard deviations."><img src="imp-data-viz_files/figure-html/fig-imp-conv-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imp-conv-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Traceplots of the imputed values means and standard deviations.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>hghlt <span class="ot">&lt;-</span> <span class="fu">sample</span>(mis_ind, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>longer_imp <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">imped =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>            .id <span class="sc">%in%</span> mis_ind <span class="sc">~</span> <span class="st">"Imp"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Obs"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">highlight =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>            .id <span class="sc">%in%</span> hghlt <span class="sc">~</span> <span class="st">"Select"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Nope"</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        imped <span class="sc">==</span> <span class="st">"Imp"</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(it, theta, <span class="at">group =</span> .id, <span class="at">color =</span> highlight, <span class="at">alpha =</span> highlight)) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(.<span class="sc">~</span>m, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="sc">+</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-imp-spaghetti" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imp-spaghetti-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="imp-data-viz_files/figure-html/fig-imp-spaghetti-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;10: Imputation spaghetti plot."><img src="imp-data-viz_files/figure-html/fig-imp-spaghetti-1.png" class="img-fluid figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imp-spaghetti-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Imputation spaghetti plot.
</figcaption>
</figure>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/benjamin-stockton\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Data Visualizations and Diagnostics for Imputed Directional Data</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Ben</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2026-02-20</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">    html:</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">        code-fold: true</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">        code-summary: "Show code"</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">        code-tools: true</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">        number-depth: 3</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">        toc: true</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">        toc-location: left</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">        toc-expand: 2</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co">        toc-depth: 3</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co">        link-external-newwindow: true</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co">        citations-hover: true</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co">        df-print: paged</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="an">cache:</span><span class="co"> true</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="an">freeze:</span><span class="co"> true</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> true</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [data-viz, missing-data, angular-data]</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>This post is a follow-up to my <span class="co">[</span><span class="ot">first post</span><span class="co">](../directions-data-viz/directions-data-viz.qmd)</span> on <span class="in">`ggplot2`</span>-based data visualization for angular data. In that post, I shared some basic visualizations for angular data that I used in my dissertation and other research projects. Here, I'll share some visualizations for imputed angular data that combine ideas from the previous post with some of the standard diagnostics from <span class="in">`mice`</span>. </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: set-up</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| warnings: false</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Load Packages"</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circular, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_github(repo = "marcpabst/ggcircular")</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcircular, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imputeangles, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pnregstan, <span class="at">warn.conflicts =</span> <span class="cn">FALSE</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulated Data</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>I'll start by generating data from a projected normal regression model. The data are displayed in @tbl-sim-data and @fig-scatterplot-comp.</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim-dat</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10239</span>)</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">0</span>, <span class="fl">2.5</span>)</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(beta, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>sigma_mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">length.out =</span> N))</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> pnregstan<span class="sc">::</span><span class="fu">pnreg_sim_data</span>(<span class="at">N =</span> N, </span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>                         <span class="at">B =</span> beta, </span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Sigma_theta =</span> sigma_mat,</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>                         <span class="at">X =</span> X) <span class="sc">|&gt;</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>To create a data set to demonstrate the imputation figures, I'll mask some of the angular observations in the simulated data by simulating a missingness indicator $R$ such that the angle $\theta$ is MCAR for 35% of the observations. The incomplete data are displayed in @tbl-sim-missing and @fig-scatterplot-inc.</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim-inc</span></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a MCAR response indicator</span></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>sim_data<span class="sc">$</span>R <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> N,</span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.65</span>, <span class="fl">0.35</span>),</span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>                     <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>mis_ind <span class="ot">&lt;-</span> <span class="fu">which</span>(sim_data<span class="sc">$</span>R <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>inc_data <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>            R <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> theta,</span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>            R <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span></span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">U1 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(theta) <span class="sc">~</span> <span class="cn">NA</span>, <span class="cn">TRUE</span> <span class="sc">~</span> U1),</span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">U2 =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(theta) <span class="sc">~</span> <span class="cn">NA</span>, <span class="cn">TRUE</span> <span class="sc">~</span> U2)</span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(theta, U1, U2, X)</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Complete Data</span></span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: scales-fn</span></span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Color Scales Functions"</span></span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a>scale_color_angles <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">colors =</span> <span class="fu">list</span>(<span class="at">low =</span> <span class="st">"magenta"</span>, <span class="at">mid =</span> <span class="st">"dodgerblue"</span>, <span class="at">high =</span> <span class="st">"magenta"</span>), <span class="at">color_name =</span> <span class="st">"Angle"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>pi, pi)) {</span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> colors<span class="sc">$</span>low, <span class="at">mid =</span> colors<span class="sc">$</span>mid, <span class="at">high =</span> colors<span class="sc">$</span>high,</span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>                          <span class="at">na.value =</span> <span class="st">"gray70"</span>, <span class="at">name =</span> color_name,</span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a>                          <span class="at">midpoint =</span> midpoint, <span class="at">limits =</span> limits)</span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>scale_fill_angles <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">colors =</span> <span class="fu">list</span>(<span class="at">low =</span> <span class="st">"magenta"</span>, <span class="at">mid =</span> <span class="st">"dodgerblue"</span>, <span class="at">high =</span> <span class="st">"magenta"</span>), <span class="at">fill_name =</span> <span class="st">"Angle"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>pi, pi)) {</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> colors<span class="sc">$</span>low, <span class="at">mid =</span> colors<span class="sc">$</span>mid, <span class="at">high =</span> colors<span class="sc">$</span>high,</span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>                          <span class="at">na.value =</span> <span class="st">"gray70"</span>, <span class="at">name =</span> fill_name,</span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>                          <span class="at">midpoint =</span> midpoint, <span class="at">limits =</span> limits)</span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatterplot-comp</span></span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: A wrapped circular-linear scatterplot.</span></span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a>sim_data_2 <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span></span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> pi <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">FALSE</span></span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-140"><a href="#cb26-140" aria-hidden="true" tabindex="-1"></a>sim_data<span class="sc">$</span>original <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb26-141"><a href="#cb26-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">bind_rows</span>(sim_data, sim_data_2), </span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> theta, <span class="at">shape =</span> original, <span class="at">color =</span> theta)) <span class="sc">+</span></span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), </span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.85</span>,</span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb26-148"><a href="#cb26-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-149"><a href="#cb26-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Original"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb26-150"><a href="#cb26-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_angles</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), <span class="at">midpoint =</span> pi) <span class="sc">+</span></span>
<span id="cb26-151"><a href="#cb26-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">theta$"</span>)) <span class="sc">+</span></span>
<span id="cb26-152"><a href="#cb26-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb26-153"><a href="#cb26-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-157"><a href="#cb26-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-158"><a href="#cb26-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-sim-data</span></span>
<span id="cb26-159"><a href="#cb26-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Simulated complete data</span></span>
<span id="cb26-160"><a href="#cb26-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-161"><a href="#cb26-161" aria-hidden="true" tabindex="-1"></a>sim_data</span>
<span id="cb26-162"><a href="#cb26-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-163"><a href="#cb26-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-164"><a href="#cb26-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Incomplete Data</span></span>
<span id="cb26-165"><a href="#cb26-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-168"><a href="#cb26-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-169"><a href="#cb26-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatterplot-inc</span></span>
<span id="cb26-170"><a href="#cb26-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: A wrapped circular-linear scatterplot of the incomplete data. Incomplete observations have the true masked value marked with a red "x" and are highlighted with a gray vertical band.</span></span>
<span id="cb26-171"><a href="#cb26-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb26-172"><a href="#cb26-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb26-173"><a href="#cb26-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-174"><a href="#cb26-174" aria-hidden="true" tabindex="-1"></a>inc_data_plt <span class="ot">&lt;-</span> inc_data</span>
<span id="cb26-175"><a href="#cb26-175" aria-hidden="true" tabindex="-1"></a>inc_data_plt<span class="sc">$</span>true_theta <span class="ot">&lt;-</span> sim_data<span class="sc">$</span>theta</span>
<span id="cb26-176"><a href="#cb26-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-177"><a href="#cb26-177" aria-hidden="true" tabindex="-1"></a>inc_data_2 <span class="ot">&lt;-</span> inc_data_plt <span class="sc">|&gt;</span></span>
<span id="cb26-178"><a href="#cb26-178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-179"><a href="#cb26-179" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-180"><a href="#cb26-180" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> pi <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-181"><a href="#cb26-181" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-182"><a href="#cb26-182" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb26-183"><a href="#cb26-183" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb26-184"><a href="#cb26-184" aria-hidden="true" tabindex="-1"></a>        <span class="at">true_theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-185"><a href="#cb26-185" aria-hidden="true" tabindex="-1"></a>            true_theta <span class="sc">&lt;</span> pi <span class="sc">~</span> true_theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-186"><a href="#cb26-186" aria-hidden="true" tabindex="-1"></a>            true_theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> true_theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-187"><a href="#cb26-187" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> true_theta</span>
<span id="cb26-188"><a href="#cb26-188" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb26-189"><a href="#cb26-189" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">FALSE</span></span>
<span id="cb26-190"><a href="#cb26-190" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-191"><a href="#cb26-191" aria-hidden="true" tabindex="-1"></a>inc_data_plt<span class="sc">$</span>original <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb26-192"><a href="#cb26-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-193"><a href="#cb26-193" aria-hidden="true" tabindex="-1"></a>inc_data_dbl <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(inc_data_plt, inc_data_2)</span>
<span id="cb26-194"><a href="#cb26-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-195"><a href="#cb26-195" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(inc_data_dbl, </span>
<span id="cb26-196"><a href="#cb26-196" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> theta, <span class="at">shape =</span> original, <span class="at">color =</span> theta)) <span class="sc">+</span></span>
<span id="cb26-197"><a href="#cb26-197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb26-198"><a href="#cb26-198" aria-hidden="true" tabindex="-1"></a>        <span class="at">xmin =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">-</span> <span class="fl">0.025</span>, </span>
<span id="cb26-199"><a href="#cb26-199" aria-hidden="true" tabindex="-1"></a>        <span class="at">xmax =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb26-200"><a href="#cb26-200" aria-hidden="true" tabindex="-1"></a>        <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb26-201"><a href="#cb26-201" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"black"</span>, </span>
<span id="cb26-202"><a href="#cb26-202" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb26-203"><a href="#cb26-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), </span>
<span id="cb26-204"><a href="#cb26-204" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb26-205"><a href="#cb26-205" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.85</span>,</span>
<span id="cb26-206"><a href="#cb26-206" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb26-207"><a href="#cb26-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-208"><a href="#cb26-208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> inc_data_dbl[<span class="fu">which</span>(<span class="fu">is.na</span>(inc_data_dbl<span class="sc">$</span>theta) <span class="sc">&amp;</span> inc_data_dbl<span class="sc">$</span>original),], </span>
<span id="cb26-209"><a href="#cb26-209" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> true_theta), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb26-210"><a href="#cb26-210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Original"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb26-211"><a href="#cb26-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_angles</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), <span class="at">midpoint =</span> pi) <span class="sc">+</span></span>
<span id="cb26-212"><a href="#cb26-212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">theta$"</span>)) <span class="sc">+</span></span>
<span id="cb26-213"><a href="#cb26-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb26-214"><a href="#cb26-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-215"><a href="#cb26-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-216"><a href="#cb26-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-219"><a href="#cb26-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-220"><a href="#cb26-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-sim-missing</span></span>
<span id="cb26-221"><a href="#cb26-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Simulated incomplete data</span></span>
<span id="cb26-222"><a href="#cb26-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-223"><a href="#cb26-223" aria-hidden="true" tabindex="-1"></a>inc_data</span>
<span id="cb26-224"><a href="#cb26-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-225"><a href="#cb26-225" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-226"><a href="#cb26-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-227"><a href="#cb26-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## Impute the Missing Angular Data</span></span>
<span id="cb26-228"><a href="#cb26-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-229"><a href="#cb26-229" aria-hidden="true" tabindex="-1"></a>Next, the data needs to be passed to the <span class="in">`mice()`</span> function with some customized arguments (and with the <span class="in">`imputeangles`</span> and <span class="in">`pnregstan`</span> packages loaded). </span>
<span id="cb26-230"><a href="#cb26-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-231"><a href="#cb26-231" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A generic <span class="in">`mids`</span> object is created by setting the max. iterations to 0. We use this obejct to get placeholders for the methods vector and the predictor indicator matrix.</span>
<span id="cb26-232"><a href="#cb26-232" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The predictor matrix is modified to turn off the unit vector components from being used to impute the missing angular observations.</span>
<span id="cb26-233"><a href="#cb26-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The methods vector is modified to impute the unit vector components using functions of the imputed angle. </span>
<span id="cb26-234"><a href="#cb26-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-237"><a href="#cb26-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-238"><a href="#cb26-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mice-set-up</span></span>
<span id="cb26-239"><a href="#cb26-239" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb26-240"><a href="#cb26-240" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb26-241"><a href="#cb26-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-242"><a href="#cb26-242" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb26-243"><a href="#cb26-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-244"><a href="#cb26-244" aria-hidden="true" tabindex="-1"></a>imp0 <span class="ot">&lt;-</span> <span class="fu">mice</span>(inc_data, <span class="at">maxit =</span> <span class="dv">0</span>, <span class="at">method =</span> <span class="st">"pnregid"</span>)</span>
<span id="cb26-245"><a href="#cb26-245" aria-hidden="true" tabindex="-1"></a>pred_mat <span class="ot">&lt;-</span> imp0<span class="sc">$</span>predictorMatrix</span>
<span id="cb26-246"><a href="#cb26-246" aria-hidden="true" tabindex="-1"></a>mthds <span class="ot">&lt;-</span> imp0<span class="sc">$</span>method</span>
<span id="cb26-247"><a href="#cb26-247" aria-hidden="true" tabindex="-1"></a>pred_mat[<span class="st">"theta"</span>,<span class="fu">c</span>(<span class="st">"U1"</span>, <span class="st">"U2"</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-248"><a href="#cb26-248" aria-hidden="true" tabindex="-1"></a>mthds[<span class="st">"U1"</span>] <span class="ot">&lt;-</span> <span class="st">"~cos(theta)"</span></span>
<span id="cb26-249"><a href="#cb26-249" aria-hidden="true" tabindex="-1"></a>mthds[<span class="st">"U2"</span>] <span class="ot">&lt;-</span> <span class="st">"~sin(theta)"</span></span>
<span id="cb26-250"><a href="#cb26-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-251"><a href="#cb26-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-252"><a href="#cb26-252" aria-hidden="true" tabindex="-1"></a>Then we run <span class="in">`mice()`</span> with these modified arguments.</span>
<span id="cb26-253"><a href="#cb26-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-256"><a href="#cb26-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-257"><a href="#cb26-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mice-no-run</span></span>
<span id="cb26-258"><a href="#cb26-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb26-259"><a href="#cb26-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb26-260"><a href="#cb26-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: show</span></span>
<span id="cb26-261"><a href="#cb26-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-262"><a href="#cb26-262" aria-hidden="true" tabindex="-1"></a>imps <span class="ot">&lt;-</span> <span class="fu">mice</span>(inc_data, <span class="at">method =</span> mthds, <span class="at">predictorMatrix =</span> pred_mat,</span>
<span id="cb26-263"><a href="#cb26-263" aria-hidden="true" tabindex="-1"></a>             <span class="at">m =</span> M, <span class="at">maxit =</span> <span class="dv">10</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-264"><a href="#cb26-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-265"><a href="#cb26-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-268"><a href="#cb26-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-269"><a href="#cb26-269" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mice</span></span>
<span id="cb26-270"><a href="#cb26-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb26-271"><a href="#cb26-271" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb26-272"><a href="#cb26-272" aria-hidden="true" tabindex="-1"></a>imps <span class="ot">&lt;-</span> <span class="fu">mice</span>(inc_data, <span class="at">method =</span> mthds, <span class="at">predictorMatrix =</span> pred_mat,</span>
<span id="cb26-273"><a href="#cb26-273" aria-hidden="true" tabindex="-1"></a>             <span class="at">m =</span> M, <span class="at">maxit =</span> <span class="dv">10</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-274"><a href="#cb26-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-275"><a href="#cb26-275" aria-hidden="true" tabindex="-1"></a>root_dir <span class="ot">&lt;-</span> <span class="st">"~/Documents/GitHub/benjamin-stockton.github.io/posts/imp-data-viz/data/"</span></span>
<span id="cb26-276"><a href="#cb26-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-277"><a href="#cb26-277" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(imps, <span class="fu">paste0</span>(root_dir, <span class="st">"imps.rds"</span>))</span>
<span id="cb26-278"><a href="#cb26-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-279"><a href="#cb26-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-282"><a href="#cb26-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-283"><a href="#cb26-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-mice</span></span>
<span id="cb26-284"><a href="#cb26-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb26-285"><a href="#cb26-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-286"><a href="#cb26-286" aria-hidden="true" tabindex="-1"></a>root_dir <span class="ot">&lt;-</span> <span class="st">"~/Documents/GitHub/benjamin-stockton.github.io/posts/imp-data-viz/data/"</span></span>
<span id="cb26-287"><a href="#cb26-287" aria-hidden="true" tabindex="-1"></a>imps <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(root_dir, <span class="st">"imps.rds"</span>))</span>
<span id="cb26-288"><a href="#cb26-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-289"><a href="#cb26-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-290"><a href="#cb26-290" aria-hidden="true" tabindex="-1"></a><span class="fu">## Imputation Figures</span></span>
<span id="cb26-291"><a href="#cb26-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-292"><a href="#cb26-292" aria-hidden="true" tabindex="-1"></a>Finally, we can look at the imputation diagnostic plots. They allow us to check how much variation there is in the imputations for each observation and how they compare to the observed parts of the data set.</span>
<span id="cb26-293"><a href="#cb26-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-294"><a href="#cb26-294" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb26-295"><a href="#cb26-295" aria-hidden="true" tabindex="-1"></a><span class="fu">## By Observation</span></span>
<span id="cb26-296"><a href="#cb26-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-299"><a href="#cb26-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-300"><a href="#cb26-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-imp-ob</span></span>
<span id="cb26-301"><a href="#cb26-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Visualize the imputations for each incomplete angular observation. This is a function from `imputeangles`.</span></span>
<span id="cb26-302"><a href="#cb26-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb26-303"><a href="#cb26-303" aria-hidden="true" tabindex="-1"></a>imputeangles<span class="sc">::</span><span class="fu">plot_angular_imputations</span>(imps, </span>
<span id="cb26-304"><a href="#cb26-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fl">0.75</span>, <span class="at">by_id =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-305"><a href="#cb26-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-306"><a href="#cb26-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-307"><a href="#cb26-307" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overlaid</span></span>
<span id="cb26-308"><a href="#cb26-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-311"><a href="#cb26-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-312"><a href="#cb26-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-imp-overlay</span></span>
<span id="cb26-313"><a href="#cb26-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Use dotplots to see how the distributions of each imputed data set compare to the observed. This is a function from `imputeangles`.</span></span>
<span id="cb26-314"><a href="#cb26-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb26-315"><a href="#cb26-315" aria-hidden="true" tabindex="-1"></a>imputeangles<span class="sc">::</span><span class="fu">plot_angular_imputations</span>(imps, </span>
<span id="cb26-316"><a href="#cb26-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">r =</span> <span class="fl">0.45</span>, <span class="at">by_id =</span> <span class="cn">FALSE</span>, <span class="at">overlay =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-317"><a href="#cb26-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-318"><a href="#cb26-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-319"><a href="#cb26-319" aria-hidden="true" tabindex="-1"></a><span class="fu">## Built-in MICE Stripplot</span></span>
<span id="cb26-320"><a href="#cb26-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-323"><a href="#cb26-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-324"><a href="#cb26-324" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mice</span></span>
<span id="cb26-325"><a href="#cb26-325" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Built-in Stripplot from MICE.</span></span>
<span id="cb26-326"><a href="#cb26-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-327"><a href="#cb26-327" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imps, theta <span class="sc">~</span> X <span class="sc">|</span> .imp)</span>
<span id="cb26-328"><a href="#cb26-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-329"><a href="#cb26-329" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-330"><a href="#cb26-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-331"><a href="#cb26-331" aria-hidden="true" tabindex="-1"></a>Additional diagnostic plots can be created after converting the imputations from <span class="in">`mids`</span> format to a long imputation data frame format.</span>
<span id="cb26-332"><a href="#cb26-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-335"><a href="#cb26-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-336"><a href="#cb26-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: long-imps</span></span>
<span id="cb26-337"><a href="#cb26-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-338"><a href="#cb26-338" aria-hidden="true" tabindex="-1"></a>long_imp <span class="ot">&lt;-</span> <span class="fu">complete</span>(imps, <span class="st">"long"</span>, <span class="at">include =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-339"><a href="#cb26-339" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-340"><a href="#cb26-340" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-341"><a href="#cb26-341" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-342"><a href="#cb26-342" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb26-343"><a href="#cb26-343" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-344"><a href="#cb26-344" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-345"><a href="#cb26-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-346"><a href="#cb26-346" aria-hidden="true" tabindex="-1"></a>long_imp</span>
<span id="cb26-347"><a href="#cb26-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-348"><a href="#cb26-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-349"><a href="#cb26-349" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb26-350"><a href="#cb26-350" aria-hidden="true" tabindex="-1"></a><span class="fu">## Density Plot</span></span>
<span id="cb26-351"><a href="#cb26-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-354"><a href="#cb26-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-355"><a href="#cb26-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-imps-dens</span></span>
<span id="cb26-356"><a href="#cb26-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Diagnostic plots after imputation with MICE. Density plots of the imputed data in pink and observed data in blue.</span></span>
<span id="cb26-357"><a href="#cb26-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb26-358"><a href="#cb26-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb26-359"><a href="#cb26-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-360"><a href="#cb26-360" aria-hidden="true" tabindex="-1"></a>long_imp  <span class="sc">|&gt;</span></span>
<span id="cb26-361"><a href="#cb26-361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-362"><a href="#cb26-362" aria-hidden="true" tabindex="-1"></a>        <span class="at">imp_color =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-363"><a href="#cb26-363" aria-hidden="true" tabindex="-1"></a>            .imp <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"blue"</span>,</span>
<span id="cb26-364"><a href="#cb26-364" aria-hidden="true" tabindex="-1"></a>            .imp <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"magenta"</span>,</span>
<span id="cb26-365"><a href="#cb26-365" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb26-366"><a href="#cb26-366" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-367"><a href="#cb26-367" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb26-368"><a href="#cb26-368" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb26-369"><a href="#cb26-369" aria-hidden="true" tabindex="-1"></a>        theta<span class="sc">:</span>U2,</span>
<span id="cb26-370"><a href="#cb26-370" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb26-371"><a href="#cb26-371" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb26-372"><a href="#cb26-372" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb26-373"><a href="#cb26-373" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="at">color =</span> imp_color, <span class="at">group =</span> .imp)) <span class="sc">+</span></span>
<span id="cb26-374"><a href="#cb26-374" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb26-375"><a href="#cb26-375" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#006CC2B3"</span>, <span class="st">"#B61A51B3"</span>), </span>
<span id="cb26-376"><a href="#cb26-376" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="st">"Completed"</span>)) <span class="sc">+</span></span>
<span id="cb26-377"><a href="#cb26-377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(.<span class="sc">~</span>variable, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb26-378"><a href="#cb26-378" aria-hidden="true" tabindex="-1"></a>               <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb26-379"><a href="#cb26-379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-380"><a href="#cb26-380" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb26-381"><a href="#cb26-381" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-382"><a href="#cb26-382" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-383"><a href="#cb26-383" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb26-384"><a href="#cb26-384" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb26-385"><a href="#cb26-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-386"><a href="#cb26-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-387"><a href="#cb26-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wrapped Scatterplot</span></span>
<span id="cb26-388"><a href="#cb26-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-391"><a href="#cb26-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-392"><a href="#cb26-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-imp-close-up</span></span>
<span id="cb26-393"><a href="#cb26-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: A zoomed in look at the imputed time series for times 150 to 200. Red rectangles correspond to missing observations.</span></span>
<span id="cb26-394"><a href="#cb26-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb26-395"><a href="#cb26-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb26-396"><a href="#cb26-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb26-397"><a href="#cb26-397" aria-hidden="true" tabindex="-1"></a>long_imp <span class="ot">&lt;-</span> long_imp <span class="sc">|&gt;</span> </span>
<span id="cb26-398"><a href="#cb26-398" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-399"><a href="#cb26-399" aria-hidden="true" tabindex="-1"></a>        <span class="at">missing_imp =</span> .id <span class="sc">%in%</span> mis_ind <span class="sc">&amp;</span> .imp <span class="sc">&gt;=</span> <span class="dv">1</span>,</span>
<span id="cb26-400"><a href="#cb26-400" aria-hidden="true" tabindex="-1"></a>        <span class="at">obs_noimp =</span> <span class="sc">!</span>(.id <span class="sc">%in%</span> mis_ind) <span class="sc">&amp;</span> .imp <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb26-401"><a href="#cb26-401" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">TRUE</span></span>
<span id="cb26-402"><a href="#cb26-402" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb26-403"><a href="#cb26-403" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb26-404"><a href="#cb26-404" aria-hidden="true" tabindex="-1"></a>        missing_imp <span class="sc">|</span> obs_noimp</span>
<span id="cb26-405"><a href="#cb26-405" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-406"><a href="#cb26-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-407"><a href="#cb26-407" aria-hidden="true" tabindex="-1"></a>long_imp2 <span class="ot">&lt;-</span> long_imp <span class="sc">|&gt;</span></span>
<span id="cb26-408"><a href="#cb26-408" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-409"><a href="#cb26-409" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-410"><a href="#cb26-410" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&lt;</span> pi <span class="sc">~</span> theta <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-411"><a href="#cb26-411" aria-hidden="true" tabindex="-1"></a>            theta <span class="sc">&gt;=</span> pi <span class="sc">~</span> theta <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>pi,</span>
<span id="cb26-412"><a href="#cb26-412" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> theta</span>
<span id="cb26-413"><a href="#cb26-413" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb26-414"><a href="#cb26-414" aria-hidden="true" tabindex="-1"></a>        <span class="at">original =</span> <span class="cn">FALSE</span></span>
<span id="cb26-415"><a href="#cb26-415" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-416"><a href="#cb26-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-417"><a href="#cb26-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-418"><a href="#cb26-418" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">rbind</span>(long_imp, long_imp2), <span class="fu">aes</span>(X, theta, <span class="at">color =</span> <span class="fu">as.factor</span>(.imp), <span class="at">shape =</span> original)) <span class="sc">+</span></span>
<span id="cb26-419"><a href="#cb26-419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>pi), </span>
<span id="cb26-420"><a href="#cb26-420" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb26-421"><a href="#cb26-421" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.85</span>,</span>
<span id="cb26-422"><a href="#cb26-422" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb26-423"><a href="#cb26-423" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-424"><a href="#cb26-424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">name =</span> <span class="st">"Original"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb26-425"><a href="#cb26-425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>,</span>
<span id="cb26-426"><a href="#cb26-426" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmin =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">-</span> <span class="fl">0.025</span>, </span>
<span id="cb26-427"><a href="#cb26-427" aria-hidden="true" tabindex="-1"></a>                <span class="at">xmax =</span> inc_data[mis_ind, <span class="st">"X"</span>] <span class="sc">+</span> <span class="fl">0.025</span>,</span>
<span id="cb26-428"><a href="#cb26-428" aria-hidden="true" tabindex="-1"></a>                <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb26-429"><a href="#cb26-429" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb26-430"><a href="#cb26-430" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"t"</span>, <span class="at">y =</span> <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">theta$"</span>)) <span class="sc">+</span></span>
<span id="cb26-431"><a href="#cb26-431" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Imp"</span>,</span>
<span id="cb26-432"><a href="#cb26-432" aria-hidden="true" tabindex="-1"></a>            <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"magenta"</span>, <span class="st">"tomato"</span>, <span class="st">"orange"</span>, <span class="st">"purple"</span>,</span>
<span id="cb26-433"><a href="#cb26-433" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"goldenrod"</span>, <span class="st">"dodgerblue"</span>, <span class="st">"forestgreen"</span>, <span class="st">"green"</span>),</span>
<span id="cb26-434"><a href="#cb26-434" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Observed"</span>, <span class="fu">paste0</span>(<span class="st">"Imp "</span>, <span class="dv">1</span><span class="sc">:</span>M))) <span class="sc">+</span></span>
<span id="cb26-435"><a href="#cb26-435" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks  =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="sc">-</span>pi, pi, pi)), </span>
<span id="cb26-436"><a href="#cb26-436" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">TeX</span>(<span class="st">"$-</span><span class="sc">\\</span><span class="st">pi$"</span>), <span class="st">"0"</span>, <span class="fu">TeX</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">pi$"</span>))) <span class="sc">+</span></span>
<span id="cb26-437"><a href="#cb26-437" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb26-438"><a href="#cb26-438" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-439"><a href="#cb26-439" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-440"><a href="#cb26-440" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb26-441"><a href="#cb26-441" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb26-442"><a href="#cb26-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-443"><a href="#cb26-443" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-444"><a href="#cb26-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-445"><a href="#cb26-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### Imputation Convergence Figures</span></span>
<span id="cb26-446"><a href="#cb26-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-447"><a href="#cb26-447" aria-hidden="true" tabindex="-1"></a>Spaghetti plots and traceplots with angular data are very useful for assessing convergence of the imputations, but more complex to create. These figures use line plots color coded by imputation with the cycles along the x-axis. </span>
<span id="cb26-448"><a href="#cb26-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-449"><a href="#cb26-449" aria-hidden="true" tabindex="-1"></a>Traceplots are built-in with <span class="in">`mice`</span> for conventional inline data like $X$ in our simulation. But the traceplots in @fig-traceplot display the mean and standard deviation of the imputations at each iteration, and these statistics are not valid for angular data. </span>
<span id="cb26-450"><a href="#cb26-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-453"><a href="#cb26-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-454"><a href="#cb26-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-traceplot</span></span>
<span id="cb26-455"><a href="#cb26-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: The traceplot built-in to `mice`. This figure does not calculate appropriate summary statistics for the angular variable `theta`.</span></span>
<span id="cb26-456"><a href="#cb26-456" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imps)</span>
<span id="cb26-457"><a href="#cb26-457" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-458"><a href="#cb26-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-459"><a href="#cb26-459" aria-hidden="true" tabindex="-1"></a>Instead we should be calculating the circular mean, circular standard deviation, and circular auto-correlation function. To do so, we need to modify the <span class="in">`mice`</span> imputation procedure to save the imputations at each cycle in order to calculate our own summary statistics. The corrected traceplot is displayed in @fig-imp-conv. </span>
<span id="cb26-460"><a href="#cb26-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-461"><a href="#cb26-461" aria-hidden="true" tabindex="-1"></a>Lastly, we can also check spaghetti plots with the cycles along the x-axis as in @fig-imp-spaghetti. This lets us check to see if the individual imputations are stationary. There is not a built-in version with <span class="in">`mice`</span>.</span>
<span id="cb26-462"><a href="#cb26-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-463"><a href="#cb26-463" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extending MICE</span></span>
<span id="cb26-464"><a href="#cb26-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-465"><a href="#cb26-465" aria-hidden="true" tabindex="-1"></a>When <span class="in">`mice()`</span> is run and a <span class="in">`mids`</span> object is created, the imputed values, original data, summary statistics for each iteration's imputations, and meta data are stored. The imputations that occur at each iteration of the algorithm are discarded. In order to save each iterations set of imputations, we need to modify how the imputation procedure is run. The <span class="in">`mice.mids()`</span> function makes this possible as it creates new imputations starting from where an existing <span class="in">`mids`</span> object left off. The <span class="in">`mids`</span> object can be extended either with more imputations <span class="in">`M`</span> or by increasing the number of iterations <span class="in">`maxit`</span>.</span>
<span id="cb26-466"><a href="#cb26-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-469"><a href="#cb26-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-470"><a href="#cb26-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fit-parallel-imps</span></span>
<span id="cb26-471"><a href="#cb26-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb26-472"><a href="#cb26-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb26-473"><a href="#cb26-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb26-474"><a href="#cb26-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Extending MICE"</span></span>
<span id="cb26-475"><a href="#cb26-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-476"><a href="#cb26-476" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb26-477"><a href="#cb26-477" aria-hidden="true" tabindex="-1"></a>maxit <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb26-478"><a href="#cb26-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-479"><a href="#cb26-479" aria-hidden="true" tabindex="-1"></a>imp_m <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>M, <span class="cf">function</span>(m) {</span>
<span id="cb26-480"><a href="#cb26-480" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Imputation "</span>, m, <span class="st">"; iteration "</span>, <span class="dv">1</span>))</span>
<span id="cb26-481"><a href="#cb26-481" aria-hidden="true" tabindex="-1"></a>    imp_m <span class="ot">&lt;-</span> <span class="fu">mice</span>(inc_data, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">maxit =</span> <span class="dv">1</span>, </span>
<span id="cb26-482"><a href="#cb26-482" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> mthds, </span>
<span id="cb26-483"><a href="#cb26-483" aria-hidden="true" tabindex="-1"></a>            <span class="at">predictorMatrix =</span> pred_mat, </span>
<span id="cb26-484"><a href="#cb26-484" aria-hidden="true" tabindex="-1"></a>            <span class="at">printFlag =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-485"><a href="#cb26-485" aria-hidden="true" tabindex="-1"></a>            <span class="at">.imp =</span> m, <span class="at">.it =</span> <span class="dv">1</span>)</span>
<span id="cb26-486"><a href="#cb26-486" aria-hidden="true" tabindex="-1"></a>    c_imp_i <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_m, <span class="st">"all"</span>, <span class="at">include =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-487"><a href="#cb26-487" aria-hidden="true" tabindex="-1"></a>    c_imp_i <span class="ot">&lt;-</span> c_imp_i[[<span class="dv">1</span>]]</span>
<span id="cb26-488"><a href="#cb26-488" aria-hidden="true" tabindex="-1"></a>    c_imp_i<span class="sc">$</span>it <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb26-489"><a href="#cb26-489" aria-hidden="true" tabindex="-1"></a>    c_imp_i<span class="sc">$</span>m <span class="ot">&lt;-</span> m</span>
<span id="cb26-490"><a href="#cb26-490" aria-hidden="true" tabindex="-1"></a>    c_imp_i<span class="sc">$</span>.id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(c_imp_i)</span>
<span id="cb26-491"><a href="#cb26-491" aria-hidden="true" tabindex="-1"></a>    readr<span class="sc">::</span><span class="fu">write_csv</span>(c_imp_i, <span class="fu">paste0</span>(root_dir, <span class="st">"imp-"</span>, m, <span class="st">"-it-"</span>, <span class="dv">1</span>, <span class="st">"-imp-df.csv"</span>))</span>
<span id="cb26-492"><a href="#cb26-492" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (it <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>maxit) {</span>
<span id="cb26-493"><a href="#cb26-493" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Imputation "</span>, m, <span class="st">"; iteration "</span>, it))</span>
<span id="cb26-494"><a href="#cb26-494" aria-hidden="true" tabindex="-1"></a>        imp_m <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">mice.mids</span>(imp_m, <span class="at">maxit =</span> <span class="dv">1</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>, <span class="at">.it =</span> it, <span class="at">.imp =</span> m)</span>
<span id="cb26-495"><a href="#cb26-495" aria-hidden="true" tabindex="-1"></a>        c_imp_i <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp_m, <span class="st">"all"</span>, <span class="at">include =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-496"><a href="#cb26-496" aria-hidden="true" tabindex="-1"></a>        c_imp_i <span class="ot">&lt;-</span> c_imp_i[[<span class="dv">1</span>]]</span>
<span id="cb26-497"><a href="#cb26-497" aria-hidden="true" tabindex="-1"></a>        c_imp_i<span class="sc">$</span>it <span class="ot">&lt;-</span> it</span>
<span id="cb26-498"><a href="#cb26-498" aria-hidden="true" tabindex="-1"></a>        c_imp_i<span class="sc">$</span>m <span class="ot">&lt;-</span> m</span>
<span id="cb26-499"><a href="#cb26-499" aria-hidden="true" tabindex="-1"></a>        c_imp_i<span class="sc">$</span>.id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(c_imp_i)</span>
<span id="cb26-500"><a href="#cb26-500" aria-hidden="true" tabindex="-1"></a>        readr<span class="sc">::</span><span class="fu">write_csv</span>(c_imp_i, <span class="fu">paste0</span>(root_dir, <span class="st">"imp-"</span>, m, <span class="st">"-it-"</span>, it, <span class="st">"-imp-df.csv"</span>))</span>
<span id="cb26-501"><a href="#cb26-501" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-502"><a href="#cb26-502" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(imp_m)</span>
<span id="cb26-503"><a href="#cb26-503" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-504"><a href="#cb26-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-505"><a href="#cb26-505" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> imp_m[[<span class="dv">1</span>]]</span>
<span id="cb26-506"><a href="#cb26-506" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>M) {</span>
<span id="cb26-507"><a href="#cb26-507" aria-hidden="true" tabindex="-1"></a>    imp <span class="ot">&lt;-</span> mice<span class="sc">::</span><span class="fu">ibind</span>(imp, imp_m[[m]])</span>
<span id="cb26-508"><a href="#cb26-508" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-509"><a href="#cb26-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-510"><a href="#cb26-510" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(imp, <span class="fu">paste0</span>(root_dir, <span class="st">"imps2.rds"</span>))</span>
<span id="cb26-511"><a href="#cb26-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-512"><a href="#cb26-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-515"><a href="#cb26-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-516"><a href="#cb26-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: m-maxit</span></span>
<span id="cb26-517"><a href="#cb26-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb26-518"><a href="#cb26-518" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb26-519"><a href="#cb26-519" aria-hidden="true" tabindex="-1"></a>maxit <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb26-520"><a href="#cb26-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-521"><a href="#cb26-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-524"><a href="#cb26-524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-525"><a href="#cb26-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cor-fns</span></span>
<span id="cb26-526"><a href="#cb26-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb26-527"><a href="#cb26-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Auto-Correlation Functions"</span></span>
<span id="cb26-528"><a href="#cb26-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-529"><a href="#cb26-529" aria-hidden="true" tabindex="-1"></a>c_auto_cor <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, <span class="at">k =</span> <span class="dv">1</span>) {</span>
<span id="cb26-530"><a href="#cb26-530" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-531"><a href="#cb26-531" aria-hidden="true" tabindex="-1"></a>    sum_determinants <span class="ot">&lt;-</span> <span class="cf">function</span>(X1, X2) {</span>
<span id="cb26-532"><a href="#cb26-532" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>(N<span class="sc">-</span>k), <span class="cf">function</span>(t) {</span>
<span id="cb26-533"><a href="#cb26-533" aria-hidden="true" tabindex="-1"></a>                <span class="fu">return</span>(<span class="fu">det</span>(<span class="fu">t</span>(X1[t,]) <span class="sc">%*%</span> X2[t,]))</span>
<span id="cb26-534"><a href="#cb26-534" aria-hidden="true" tabindex="-1"></a>            }) <span class="sc">|&gt;</span></span>
<span id="cb26-535"><a href="#cb26-535" aria-hidden="true" tabindex="-1"></a>            <span class="fu">unlist</span>() <span class="sc">|&gt;</span></span>
<span id="cb26-536"><a href="#cb26-536" aria-hidden="true" tabindex="-1"></a>            <span class="fu">sum</span>()</span>
<span id="cb26-537"><a href="#cb26-537" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(s)</span>
<span id="cb26-538"><a href="#cb26-538" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-539"><a href="#cb26-539" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-540"><a href="#cb26-540" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">length</span>(theta)</span>
<span id="cb26-541"><a href="#cb26-541" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cos</span>(theta), <span class="fu">sin</span>(theta))</span>
<span id="cb26-542"><a href="#cb26-542" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-543"><a href="#cb26-543" aria-hidden="true" tabindex="-1"></a>    U_lag_k <span class="ot">&lt;-</span> U[<span class="dv">1</span><span class="sc">:</span>(N <span class="sc">-</span> k),]</span>
<span id="cb26-544"><a href="#cb26-544" aria-hidden="true" tabindex="-1"></a>    U_no_lag <span class="ot">&lt;-</span> U[(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,]</span>
<span id="cb26-545"><a href="#cb26-545" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-546"><a href="#cb26-546" aria-hidden="true" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">sum_determinants</span>(U_lag_k, U_no_lag)</span>
<span id="cb26-547"><a href="#cb26-547" aria-hidden="true" tabindex="-1"></a>    denom <span class="ot">&lt;-</span> <span class="fu">sum_determinants</span>(U_lag_k, U_lag_k) <span class="sc">*</span> <span class="fu">sum_determinants</span>(U_no_lag, U_no_lag)</span>
<span id="cb26-548"><a href="#cb26-548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(num <span class="sc">/</span> <span class="fu">sqrt</span>(denom))</span>
<span id="cb26-549"><a href="#cb26-549" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-550"><a href="#cb26-550" aria-hidden="true" tabindex="-1"></a>my_acf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb26-551"><a href="#cb26-551" aria-hidden="true" tabindex="-1"></a>    <span class="fu">acf</span>(x, <span class="at">lag.max =</span> <span class="dv">1</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>acf[<span class="dv">2</span>,,<span class="dv">1</span>]</span>
<span id="cb26-552"><a href="#cb26-552" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-553"><a href="#cb26-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-554"><a href="#cb26-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-557"><a href="#cb26-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-558"><a href="#cb26-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-iter-data</span></span>
<span id="cb26-559"><a href="#cb26-559" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb26-560"><a href="#cb26-560" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Post-processing imputations"</span></span>
<span id="cb26-561"><a href="#cb26-561" aria-hidden="true" tabindex="-1"></a>longer_imp <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>M, <span class="cf">function</span>(m) {</span>
<span id="cb26-562"><a href="#cb26-562" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>maxit, <span class="cf">function</span>(it) {</span>
<span id="cb26-563"><a href="#cb26-563" aria-hidden="true" tabindex="-1"></a>        readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="fu">paste0</span>(root_dir, <span class="st">"imp-"</span>, m, <span class="st">"-it-"</span>, it, <span class="st">"-imp-df.csv"</span>),</span>
<span id="cb26-564"><a href="#cb26-564" aria-hidden="true" tabindex="-1"></a>                        <span class="at">show_col_types =</span> <span class="cn">FALSE</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-565"><a href="#cb26-565" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">|&gt;</span></span>
<span id="cb26-566"><a href="#cb26-566" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()</span>
<span id="cb26-567"><a href="#cb26-567" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span></span>
<span id="cb26-568"><a href="#cb26-568" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()</span>
<span id="cb26-569"><a href="#cb26-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-570"><a href="#cb26-570" aria-hidden="true" tabindex="-1"></a>auto_cor_mat <span class="ot">&lt;-</span> longer_imp <span class="sc">|&gt;</span></span>
<span id="cb26-571"><a href="#cb26-571" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(m, it) <span class="sc">|&gt;</span></span>
<span id="cb26-572"><a href="#cb26-572" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb26-573"><a href="#cb26-573" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta_mean =</span> <span class="fu">atan2</span>(<span class="fu">mean</span>(<span class="fu">sin</span>(theta)), <span class="fu">mean</span>(<span class="fu">cos</span>(theta))),</span>
<span id="cb26-574"><a href="#cb26-574" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta_sd =</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">cos</span>(theta))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">mean</span>(<span class="fu">sin</span>(theta))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb26-575"><a href="#cb26-575" aria-hidden="true" tabindex="-1"></a>        <span class="at">u1_mean =</span> <span class="fu">mean</span>(U1),</span>
<span id="cb26-576"><a href="#cb26-576" aria-hidden="true" tabindex="-1"></a>        <span class="at">u1_sd =</span> <span class="fu">sd</span>(U1),</span>
<span id="cb26-577"><a href="#cb26-577" aria-hidden="true" tabindex="-1"></a>        <span class="at">u2_mean =</span> <span class="fu">mean</span>(U2),</span>
<span id="cb26-578"><a href="#cb26-578" aria-hidden="true" tabindex="-1"></a>        <span class="at">u2_sd =</span> <span class="fu">sd</span>(U2),</span>
<span id="cb26-579"><a href="#cb26-579" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta_ac =</span> <span class="fu">c_auto_cor</span>(theta, <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb26-580"><a href="#cb26-580" aria-hidden="true" tabindex="-1"></a>        <span class="at">u1_ac =</span> <span class="fu">my_acf</span>(U1),</span>
<span id="cb26-581"><a href="#cb26-581" aria-hidden="true" tabindex="-1"></a>        <span class="at">u2_ac =</span> <span class="fu">my_acf</span>(U2)</span>
<span id="cb26-582"><a href="#cb26-582" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-583"><a href="#cb26-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-584"><a href="#cb26-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-587"><a href="#cb26-587" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-588"><a href="#cb26-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-imp-conv</span></span>
<span id="cb26-589"><a href="#cb26-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Traceplots of the imputed values means and standard deviations.</span></span>
<span id="cb26-590"><a href="#cb26-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb26-591"><a href="#cb26-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb26-592"><a href="#cb26-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-593"><a href="#cb26-593" aria-hidden="true" tabindex="-1"></a>auto_cor_mat <span class="sc">|&gt;</span></span>
<span id="cb26-594"><a href="#cb26-594" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb26-595"><a href="#cb26-595" aria-hidden="true" tabindex="-1"></a>        <span class="sc">!</span><span class="fu">c</span>(m, it),</span>
<span id="cb26-596"><a href="#cb26-596" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"parameter"</span>, <span class="st">"stat"</span>),</span>
<span id="cb26-597"><a href="#cb26-597" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_pattern =</span> <span class="st">"(.*)_(.*)"</span>,</span>
<span id="cb26-598"><a href="#cb26-598" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb26-599"><a href="#cb26-599" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb26-600"><a href="#cb26-600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-601"><a href="#cb26-601" aria-hidden="true" tabindex="-1"></a>        <span class="at">parameter2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-602"><a href="#cb26-602" aria-hidden="true" tabindex="-1"></a>            parameter <span class="sc">==</span> <span class="st">"u1"</span> <span class="sc">~</span> <span class="st">"cos(theta)"</span>,</span>
<span id="cb26-603"><a href="#cb26-603" aria-hidden="true" tabindex="-1"></a>            parameter <span class="sc">==</span> <span class="st">"u2"</span> <span class="sc">~</span> <span class="st">"sin(theta)"</span>,</span>
<span id="cb26-604"><a href="#cb26-604" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> parameter</span>
<span id="cb26-605"><a href="#cb26-605" aria-hidden="true" tabindex="-1"></a>        ), </span>
<span id="cb26-606"><a href="#cb26-606" aria-hidden="true" tabindex="-1"></a>        <span class="at">stat2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-607"><a href="#cb26-607" aria-hidden="true" tabindex="-1"></a>            stat <span class="sc">==</span> <span class="st">"ac"</span> <span class="sc">~</span> <span class="st">"acf(1)"</span>,</span>
<span id="cb26-608"><a href="#cb26-608" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(stat)</span>
<span id="cb26-609"><a href="#cb26-609" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-610"><a href="#cb26-610" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb26-611"><a href="#cb26-611" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(it, value, <span class="at">color =</span> <span class="fu">as.factor</span>(m))) <span class="sc">+</span></span>
<span id="cb26-612"><a href="#cb26-612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb26-613"><a href="#cb26-613" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_colorblind</span>(<span class="at">name =</span> <span class="st">"Imp"</span>) <span class="sc">+</span></span>
<span id="cb26-614"><a href="#cb26-614" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(parameter2<span class="sc">~</span>stat2, <span class="at">labeller =</span> label_parsed, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb26-615"><a href="#cb26-615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb26-616"><a href="#cb26-616" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MICE Cycle"</span>,</span>
<span id="cb26-617"><a href="#cb26-617" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Value"</span>)  <span class="sc">+</span></span>
<span id="cb26-618"><a href="#cb26-618" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb26-619"><a href="#cb26-619" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-620"><a href="#cb26-620" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-621"><a href="#cb26-621" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb26-622"><a href="#cb26-622" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb26-623"><a href="#cb26-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-624"><a href="#cb26-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-627"><a href="#cb26-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-628"><a href="#cb26-628" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-imp-spaghetti</span></span>
<span id="cb26-629"><a href="#cb26-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Imputation spaghetti plot.</span></span>
<span id="cb26-630"><a href="#cb26-630" aria-hidden="true" tabindex="-1"></a>hghlt <span class="ot">&lt;-</span> <span class="fu">sample</span>(mis_ind, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-631"><a href="#cb26-631" aria-hidden="true" tabindex="-1"></a>longer_imp <span class="sc">|&gt;</span></span>
<span id="cb26-632"><a href="#cb26-632" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-633"><a href="#cb26-633" aria-hidden="true" tabindex="-1"></a>        <span class="at">imped =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-634"><a href="#cb26-634" aria-hidden="true" tabindex="-1"></a>            .id <span class="sc">%in%</span> mis_ind <span class="sc">~</span> <span class="st">"Imp"</span>,</span>
<span id="cb26-635"><a href="#cb26-635" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Obs"</span></span>
<span id="cb26-636"><a href="#cb26-636" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb26-637"><a href="#cb26-637" aria-hidden="true" tabindex="-1"></a>        <span class="at">highlight =</span> <span class="fu">case_when</span>(</span>
<span id="cb26-638"><a href="#cb26-638" aria-hidden="true" tabindex="-1"></a>            .id <span class="sc">%in%</span> hghlt <span class="sc">~</span> <span class="st">"Select"</span>,</span>
<span id="cb26-639"><a href="#cb26-639" aria-hidden="true" tabindex="-1"></a>            <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Nope"</span></span>
<span id="cb26-640"><a href="#cb26-640" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-641"><a href="#cb26-641" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb26-642"><a href="#cb26-642" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb26-643"><a href="#cb26-643" aria-hidden="true" tabindex="-1"></a>        imped <span class="sc">==</span> <span class="st">"Imp"</span></span>
<span id="cb26-644"><a href="#cb26-644" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb26-645"><a href="#cb26-645" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(it, theta, <span class="at">group =</span> .id, <span class="at">color =</span> highlight, <span class="at">alpha =</span> highlight)) <span class="sc">+</span></span>
<span id="cb26-646"><a href="#cb26-646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-647"><a href="#cb26-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb26-648"><a href="#cb26-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-649"><a href="#cb26-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(.<span class="sc">~</span>m, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb26-650"><a href="#cb26-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)  <span class="sc">+</span></span>
<span id="cb26-651"><a href="#cb26-651" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb26-652"><a href="#cb26-652" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-653"><a href="#cb26-653" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-654"><a href="#cb26-654" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.ticks.length.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"cm"</span>),</span>
<span id="cb26-655"><a href="#cb26-655" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb26-656"><a href="#cb26-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/benjamin-stockton/benjamin-stockton.github.io/edit/main/posts/imp-data-viz/imp-data-viz.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/benjamin-stockton/benjamin-stockton.github.io/blob/main/posts/imp-data-viz/imp-data-viz.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/benjamin-stockton/benjamin-stockton.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>