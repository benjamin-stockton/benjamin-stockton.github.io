{
  "hash": "3e32e7e67a1e78bd213ca7deda479ed0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Visualizing Directional Data\nauthor: Ben\ndate: 2025-08-12\nformat: \n    html:\n        code-fold: show\n        code-summary: \"Show code\"\n        code-tools: true\n        number-depth: 3\n        toc: true\n        toc-location: left\n        toc-expand: 2\n        toc-depth: 3\n        link-external-newwindow: true\n        citations-hover: true\n        df-print: paged\ndraft: true\ncache: true\nlightbox: true\ncategories: [data-viz, missing-data, angular-data]\n---\n\n\n\nVisualizing directional or angular data has been a challenge while writing my dissertation and preparing presentations for the related research. There are a few tools out there for preparing directional data plots in R (see `circular`, mixtures of VMF `movMF`, etc.) but these largely don't integrate well with modern tools like `ggplot2` and the angular functionality in `ggplot2` doesn't always behave as desired for directional data. In this post, I'll share some of the basic directional data plots and tricks I've learned or used with `ggplot2`; some of these are just adaptations of existing methods, I am not claiming to be the original developer of any of these graphics.\n\nIn this post, I will point out where I wrote wrapper functions for a visualization in my `pnregstan` and `imputeangles` packages, but I will make all of the visualizations with the full `ggplot2` code.\n\n\n\n::: {.cell warnings='false'}\n\n```{.r .cell-code}\nlibrary(dplyr, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(ggplot2, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(ggthemes, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(ggforce, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(latex2exp, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(imputeangles, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(pnregstan, warn.conflicts = FALSE, quietly = TRUE)\n\ntheme_set(theme_classic())\n```\n:::\n\n\n\nI'll start by generating some data from a projected normal regression model.\n\n\n\n::: {#tbl-sim-dat .cell tbl-cap='Simulated data from a projected normal regression model.'}\n\n```{.r .cell-code}\nN <- 50\nbeta <- c(0, 2.5, 0, 2.5)\nB <- matrix(beta, ncol = 2)\nsigma_mat <- c(1,0,0,1)\nX <- matrix(seq(from = -2, to = 2, length.out = N))\n\nsim_data <- pnregstan::pnreg_sim_data(N = N, \n                         B = beta, \n                         Sigma_theta = sigma_mat,\n                         X = X) |>\n    mutate(\n        theta = case_when(\n            theta < 0 ~ theta + 2*pi,\n            TRUE ~ theta\n        )\n    )\n\nsim_data\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"theta\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3.86269112\",\"2\":\"-0.751080966\",\"3\":\"-0.66021011\",\"4\":\"-2.00000000\"},{\"1\":\"4.24878673\",\"2\":\"-0.447173024\",\"3\":\"-0.89444748\",\"4\":\"-1.91836735\"},{\"1\":\"4.30710476\",\"2\":\"-0.394279968\",\"3\":\"-0.91899037\",\"4\":\"-1.83673469\"},{\"1\":\"5.17373867\",\"2\":\"0.445157093\",\"3\":\"-0.89545249\",\"4\":\"-1.75510204\"},{\"1\":\"5.88629233\",\"2\":\"0.922266478\",\"3\":\"-0.38655471\",\"4\":\"-1.67346939\"},{\"1\":\"3.58344250\",\"2\":\"-0.903962193\",\"3\":\"-0.42761239\",\"4\":\"-1.59183673\"},{\"1\":\"4.46014109\",\"2\":\"-0.249581338\",\"3\":\"-0.96835384\",\"4\":\"-1.51020408\"},{\"1\":\"0.09739679\",\"2\":\"0.995260681\",\"3\":\"0.09724287\",\"4\":\"-1.42857143\"},{\"1\":\"4.51637380\",\"2\":\"-0.194762378\",\"3\":\"-0.98085046\",\"4\":\"-1.34693878\"},{\"1\":\"5.86283788\",\"2\":\"0.912947218\",\"3\":\"-0.40807766\",\"4\":\"-1.26530612\"},{\"1\":\"5.97613355\",\"2\":\"0.953228816\",\"3\":\"-0.30224961\",\"4\":\"-1.18367347\"},{\"1\":\"5.97604764\",\"2\":\"0.953202846\",\"3\":\"-0.30233150\",\"4\":\"-1.10204082\"},{\"1\":\"0.21860183\",\"2\":\"0.976201617\",\"3\":\"0.21686494\",\"4\":\"-1.02040816\"},{\"1\":\"0.73671374\",\"2\":\"0.740680452\",\"3\":\"0.67185748\",\"4\":\"-0.93877551\"},{\"1\":\"1.88951747\",\"2\":\"-0.313352368\",\"3\":\"0.94963693\",\"4\":\"-0.85714286\"},{\"1\":\"1.42873545\",\"2\":\"0.141583534\",\"3\":\"0.98992631\",\"4\":\"-0.77551020\"},{\"1\":\"1.64480337\",\"2\":\"-0.073939505\",\"3\":\"0.99726273\",\"4\":\"-0.69387755\"},{\"1\":\"1.40783263\",\"2\":\"0.162243345\",\"3\":\"0.98675078\",\"4\":\"-0.61224490\"},{\"1\":\"0.56996552\",\"2\":\"0.841919579\",\"3\":\"0.53960302\",\"4\":\"-0.53061224\"},{\"1\":\"2.67616966\",\"2\":\"-0.893631804\",\"3\":\"0.44880085\",\"4\":\"-0.44897959\"},{\"1\":\"1.17565140\",\"2\":\"0.384941956\",\"3\":\"0.92294078\",\"4\":\"-0.36734694\"},{\"1\":\"2.01818445\",\"2\":\"-0.432612199\",\"3\":\"0.90158010\",\"4\":\"-0.28571429\"},{\"1\":\"1.19116904\",\"2\":\"0.370574320\",\"3\":\"0.92880282\",\"4\":\"-0.20408163\"},{\"1\":\"0.93857031\",\"2\":\"0.590941983\",\"3\":\"0.80671406\",\"4\":\"-0.12244898\"},{\"1\":\"2.22818781\",\"2\":\"-0.611054064\",\"3\":\"0.79158886\",\"4\":\"-0.04081633\"},{\"1\":\"1.30256657\",\"2\":\"0.265024906\",\"3\":\"0.96424157\",\"4\":\"0.04081633\"},{\"1\":\"1.58849665\",\"2\":\"-0.017699399\",\"3\":\"0.99984335\",\"4\":\"0.12244898\"},{\"1\":\"1.62262303\",\"2\":\"-0.051803507\",\"3\":\"0.99865730\",\"4\":\"0.20408163\"},{\"1\":\"1.86498169\",\"2\":\"-0.289960306\",\"3\":\"0.95703867\",\"4\":\"0.28571429\"},{\"1\":\"1.54300757\",\"2\":\"0.027785183\",\"3\":\"0.99961392\",\"4\":\"0.36734694\"},{\"1\":\"1.72454267\",\"2\":\"-0.153141354\",\"3\":\"0.98820429\",\"4\":\"0.44897959\"},{\"1\":\"1.46537941\",\"2\":\"0.105221778\",\"3\":\"0.99444878\",\"4\":\"0.53061224\"},{\"1\":\"1.80895222\",\"2\":\"-0.235910971\",\"3\":\"0.97177467\",\"4\":\"0.61224490\"},{\"1\":\"2.05424977\",\"2\":\"-0.464839602\",\"3\":\"0.88539491\",\"4\":\"0.69387755\"},{\"1\":\"1.24818738\",\"2\":\"0.317041992\",\"3\":\"0.94841150\",\"4\":\"0.77551020\"},{\"1\":\"1.90844763\",\"2\":\"-0.331271930\",\"3\":\"0.94353532\",\"4\":\"0.85714286\"},{\"1\":\"1.89246425\",\"2\":\"-0.316149373\",\"3\":\"0.94870943\",\"4\":\"0.93877551\"},{\"1\":\"1.63322646\",\"2\":\"-0.062389583\",\"3\":\"0.99805187\",\"4\":\"1.02040816\"},{\"1\":\"1.31066716\",\"2\":\"0.257205378\",\"3\":\"0.96635676\",\"4\":\"1.10204082\"},{\"1\":\"1.75977031\",\"2\":\"-0.187851240\",\"3\":\"0.98219749\",\"4\":\"1.18367347\"},{\"1\":\"1.44691934\",\"2\":\"0.123560402\",\"3\":\"0.99233705\",\"4\":\"1.26530612\"},{\"1\":\"1.52606008\",\"2\":\"0.044721324\",\"3\":\"0.99899950\",\"4\":\"1.34693878\"},{\"1\":\"1.57390328\",\"2\":\"-0.003106948\",\"3\":\"0.99999517\",\"4\":\"1.42857143\"},{\"1\":\"1.56101966\",\"2\":\"0.009776516\",\"3\":\"0.99995221\",\"4\":\"1.51020408\"},{\"1\":\"1.28712845\",\"2\":\"0.279878814\",\"3\":\"0.96003534\",\"4\":\"1.59183673\"},{\"1\":\"1.29507991\",\"2\":\"0.272236361\",\"3\":\"0.96223041\",\"4\":\"1.67346939\"},{\"1\":\"1.40945958\",\"2\":\"0.160637732\",\"3\":\"0.98701343\",\"4\":\"1.75510204\"},{\"1\":\"1.92250174\",\"2\":\"-0.344499322\",\"3\":\"0.93878657\",\"4\":\"1.83673469\"},{\"1\":\"1.26519810\",\"2\":\"0.300863741\",\"3\":\"0.95366714\",\"4\":\"1.91836735\"},{\"1\":\"1.42439544\",\"2\":\"0.145878470\",\"3\":\"0.98930252\",\"4\":\"2.00000000\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nI'm also going to create two scale functions to help plot angles with color or fill such that $\\theta = 0$ and $\\theta = 2\\pi$ have the same color.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscale_color_angles <- function(colors = list(low = \"magenta\", mid = \"dodgerblue\", high = \"magenta\"), color_name = \"Angle\", midpoint = 0, limits = c(-pi, pi)) {\n    scale_color_gradient2(low = colors$low, mid = colors$mid, high = colors$high,\n                          na.value = \"gray90\", name = color_name,\n                          midpoint = midpoint, limits = limits)\n}\n\nscale_fill_angles <- function(colors = list(low = \"magenta\", mid = \"dodgerblue\", high = \"magenta\"), fill_name = \"Angle\", midpoint = 0, limits = c(-pi, pi)) {\n    scale_fill_gradient2(low = colors$low, mid = colors$mid, high = colors$high,\n                          na.value = \"gray90\", name = fill_name,\n                          midpoint = midpoint, limits = limits)\n}\n```\n:::\n\n\n\n## Density Diagrams and Dot Plots\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(sim_data, aes(x = U1, y = U2, color = theta)) +\n    geom_circle(aes(x0 = 0, y0 = 0, r = 1), \n                linetype = \"dotted\", \n                color = \"lightgray\") +\n    annotate(\n        geom = \"point\",\n        x = 0, y = 0, \n        color = \"lightgray\", shape = \"+\", size = 3\n    ) +\n    geom_point() +\n    scale_color_angles() +\n    coord_fixed()\n```\n\n::: {.cell-output-display}\n![A circular dotplot plot](directions-data-viz_files/figure-html/fig-dotplot-1.png){#fig-dotplot width=480}\n:::\n:::\n\n\n\n## Wrapped Scatterplots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_data_2 <- sim_data |>\n    mutate(\n        theta = case_when(\n            theta < pi ~ theta + 2*pi,\n            theta >= pi ~ theta - 2*pi,\n            TRUE ~ theta\n        ),\n        original = FALSE\n    )\nsim_data$original = TRUE\n\nggplot(bind_rows(sim_data, sim_data_2), \n       aes(x = X, y = theta, shape = original, color = theta)) +\n    geom_hline(yintercept = c(0, 2*pi), \n              linetype = \"dotted\",\n              linewidth = 0.85,\n              color = \"lightgray\") +\n    geom_point() +\n    scale_shape_manual(name = \"Original\", values = c(1, 16)) +\n    scale_color_angles() +\n    labs(y = TeX(\"$\\\\theta$\"))\n```\n\n::: {.cell-output-display}\n![A wrapped circular-linear scatterplot.](directions-data-viz_files/figure-html/fig-scatterplot-1.png){#fig-scatterplot width=672}\n:::\n:::\n\n\n\n## Angular Time Series (Two Ways)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(65433)\nmu_0 <- c(1, 0)\n# Sigma <- matrix(c(1, 0.5, 0.5, 1), nrow = 2)\nSigma <- diag(2)\nN <- 100\nX1 <- arima.sim(n = N, list(ar = c(0.24)))\nX2 <- arima.sim(n = N, list(ar = c(0.75), ma = c(-0.25, 0.25)))\nPhi <- c(0.25, 0.02, 0.02, 0.25)\nbeta <- c(2, -.1)\n\nB <- matrix(beta, nrow = 2)\nPsi <- matrix(Phi, nrow = 2)\n\nX_mat <- cbind(X1, X2)\n\nmu <- X_mat %*% B\n\nY <- matrix(NA, nrow = N, ncol = 2)\nU <- matrix(NA, nrow = N, ncol = 2)\neps_0 <- mvtnorm::rmvnorm(1, rep(0,2), Sigma)\nY[1,] <- mu_0 + mu[1,] + eps_0\nU[1,] <- Y[1,] / sqrt(Y[1,1]^2 + Y[1,2]^2)\nfor (i in 2:N) {\neps_i <- mvtnorm::rmvnorm(1, rep(0,2), Sigma)\nY[i,] <- mu_0 + Y[i-1,] %*% Psi + mu[i,] + eps_i\nU[i,] <- Y[i,] / sqrt(Y[i,1]^2 + Y[i,2]^2)\n}\n\ntheta <- atan2(U[,2], U[,1])\n\ndf_ts <- data.frame(t = 1:N,\n                    Y1 = Y[,1],\n                    Y2 = Y[,2],\n                    U1 = U[,1],\n                    U2 = U[,2],\n                    theta = theta,\n                    X1 = as.numeric(X1),\n                    X2 = as.numeric(X2))\n\ndf_ts\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"t\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"Y1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Y2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U1\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U2\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"theta\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X1\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X2\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1.06848474\",\"3\":\"0.36583641\",\"4\":\"0.94608202\",\"5\":\"0.323927177\",\"6\":\"0.329877544\",\"7\":\"0.066761767\",\"8\":\"1.0495146\"},{\"1\":\"2\",\"2\":\"2.49432102\",\"3\":\"1.08286215\",\"4\":\"0.91728847\",\"5\":\"0.398223386\",\"6\":\"0.409579220\",\"7\":\"0.361662031\",\"8\":\"-0.1392667\"},{\"1\":\"3\",\"2\":\"1.32568478\",\"3\":\"-1.42051674\",\"4\":\"0.68228226\",\"5\":\"-0.731088858\",\"6\":\"-0.819916494\",\"7\":\"-0.035483177\",\"8\":\"-1.3000878\"},{\"1\":\"4\",\"2\":\"3.05433451\",\"3\":\"1.05586369\",\"4\":\"0.94512047\",\"5\":\"0.326722037\",\"6\":\"0.332833185\",\"7\":\"0.396705617\",\"8\":\"-1.0716356\"},{\"1\":\"5\",\"2\":\"2.63434612\",\"3\":\"2.77900460\",\"4\":\"0.68796550\",\"5\":\"0.725743392\",\"6\":\"0.812114345\",\"7\":\"0.097194226\",\"8\":\"-1.9105308\"},{\"1\":\"6\",\"2\":\"6.12620419\",\"3\":\"5.05015427\",\"4\":\"0.77161832\",\"5\":\"0.636085813\",\"6\":\"0.689414895\",\"7\":\"1.635299058\",\"8\":\"0.2728730\"},{\"1\":\"7\",\"2\":\"-0.81342108\",\"3\":\"-1.87207647\",\"4\":\"-0.39850970\",\"5\":\"-0.917164119\",\"6\":\"-1.980687695\",\"7\":\"-1.251128600\",\"8\":\"-0.4892858\"},{\"1\":\"8\",\"2\":\"3.96763433\",\"3\":\"2.22845501\",\"4\":\"0.87188892\",\"5\":\"0.489703704\",\"6\":\"0.511749888\",\"7\":\"0.645597031\",\"8\":\"0.5940934\"},{\"1\":\"9\",\"2\":\"4.96993846\",\"3\":\"3.29744192\",\"4\":\"0.83327481\",\"5\":\"0.552859017\",\"6\":\"0.585791409\",\"7\":\"0.853397078\",\"8\":\"0.4101717\"},{\"1\":\"10\",\"2\":\"6.01365697\",\"3\":\"5.19930240\",\"4\":\"0.75646886\",\"5\":\"0.654029714\",\"6\":\"0.712899256\",\"7\":\"1.633984765\",\"8\":\"-0.5424277\"},{\"1\":\"11\",\"2\":\"1.82865628\",\"3\":\"-0.09720556\",\"4\":\"0.99859016\",\"5\":\"-0.053081884\",\"6\":\"-0.053106844\",\"7\":\"-0.581893035\",\"8\":\"-0.9175958\"},{\"1\":\"12\",\"2\":\"-5.68453459\",\"3\":\"-6.74698720\",\"4\":\"-0.64432547\",\"5\":\"-0.764751388\",\"6\":\"-2.270937260\",\"7\":\"-3.402485963\",\"8\":\"-0.5011983\"},{\"1\":\"13\",\"2\":\"-3.81622238\",\"3\":\"-6.11611302\",\"4\":\"-0.52936556\",\"5\":\"-0.848393841\",\"6\":\"-2.128648899\",\"7\":\"-1.663801719\",\"8\":\"-0.7796042\"},{\"1\":\"14\",\"2\":\"0.77250483\",\"3\":\"-3.03766655\",\"4\":\"0.24646373\",\"5\":\"-0.969152017\",\"6\":\"-1.321766608\",\"7\":\"0.358495226\",\"8\":\"0.3097990\"},{\"1\":\"15\",\"2\":\"0.79030710\",\"3\":\"0.08678019\",\"4\":\"0.99402533\",\"5\":\"0.109149606\",\"6\":\"0.109367504\",\"7\":\"0.202044300\",\"8\":\"1.5379104\"},{\"1\":\"16\",\"2\":\"-2.05440996\",\"3\":\"-0.54916803\",\"4\":\"-0.96607960\",\"5\":\"-0.258244480\",\"6\":\"-2.880388052\",\"7\":\"-1.033371476\",\"8\":\"2.0794626\"},{\"1\":\"17\",\"2\":\"-0.95728146\",\"3\":\"-1.08259670\",\"4\":\"-0.66241850\",\"5\":\"-0.749133991\",\"6\":\"-2.294838888\",\"7\":\"-0.380936586\",\"8\":\"2.7206139\"},{\"1\":\"18\",\"2\":\"0.62627114\",\"3\":\"-0.59498457\",\"4\":\"0.72498384\",\"5\":\"-0.688765881\",\"6\":\"-0.759785402\",\"7\":\"0.606787447\",\"8\":\"1.4510585\"},{\"1\":\"19\",\"2\":\"0.59709962\",\"3\":\"-0.23633438\",\"4\":\"0.92981597\",\"5\":\"-0.368024818\",\"6\":\"-0.376883854\",\"7\":\"-0.334682736\",\"8\":\"0.8888107\"},{\"1\":\"20\",\"2\":\"1.78399493\",\"3\":\"-0.11336458\",\"4\":\"0.99798709\",\"5\":\"-0.063417438\",\"6\":\"-0.063460023\",\"7\":\"-0.215657236\",\"8\":\"1.6078362\"},{\"1\":\"21\",\"2\":\"-0.95450999\",\"3\":\"-0.78706371\",\"4\":\"-0.77153476\",\"5\":\"-0.636187170\",\"6\":\"-2.452046396\",\"7\":\"-0.730024295\",\"8\":\"0.1893475\"},{\"1\":\"22\",\"2\":\"2.48291152\",\"3\":\"0.20983562\",\"4\":\"0.99644788\",\"5\":\"0.084211726\",\"6\":\"0.084311578\",\"7\":\"0.472421850\",\"8\":\"0.8490365\"},{\"1\":\"23\",\"2\":\"5.26261506\",\"3\":\"2.25041816\",\"4\":\"0.91946029\",\"5\":\"0.393182878\",\"6\":\"0.404090722\",\"7\":\"1.307828914\",\"8\":\"-0.6247946\"},{\"1\":\"24\",\"2\":\"3.29546946\",\"3\":\"2.86190417\",\"4\":\"0.75502755\",\"5\":\"0.655693070\",\"6\":\"0.715100195\",\"7\":\"0.337472338\",\"8\":\"-1.7754427\"},{\"1\":\"25\",\"2\":\"6.87852886\",\"3\":\"3.40980096\",\"4\":\"0.89595702\",\"5\":\"0.444140769\",\"6\":\"0.460215024\",\"7\":\"1.934705623\",\"8\":\"-2.0982445\"},{\"1\":\"26\",\"2\":\"5.26165929\",\"3\":\"0.48099985\",\"4\":\"0.99584757\",\"5\":\"0.091036401\",\"6\":\"0.091162619\",\"7\":\"0.405483451\",\"8\":\"-4.0359689\"},{\"1\":\"27\",\"2\":\"4.69237318\",\"3\":\"3.21895984\",\"4\":\"0.82461962\",\"5\":\"0.565687624\",\"6\":\"0.601266883\",\"7\":\"1.711851807\",\"8\":\"-3.8179946\"},{\"1\":\"28\",\"2\":\"4.46148599\",\"3\":\"2.15800135\",\"4\":\"0.90022112\",\"5\":\"0.435433038\",\"6\":\"0.450519256\",\"7\":\"0.842860486\",\"8\":\"-4.7456324\"},{\"1\":\"29\",\"2\":\"6.32557255\",\"3\":\"4.57210022\",\"4\":\"0.81045835\",\"5\":\"0.585796267\",\"6\":\"0.625862200\",\"7\":\"1.687978623\",\"8\":\"-3.7522483\"},{\"1\":\"30\",\"2\":\"3.48835599\",\"3\":\"-0.07629886\",\"4\":\"0.99976088\",\"5\":\"-0.021867211\",\"6\":\"-0.021868954\",\"7\":\"0.255857335\",\"8\":\"-2.5058202\"},{\"1\":\"31\",\"2\":\"0.52792959\",\"3\":\"-0.74334034\",\"4\":\"0.57903709\",\"5\":\"-0.815301201\",\"6\":\"-0.953249180\",\"7\":\"0.004782948\",\"8\":\"-2.2679253\"},{\"1\":\"32\",\"2\":\"-1.95745419\",\"3\":\"-4.05131583\",\"4\":\"-0.43504582\",\"5\":\"-0.900408314\",\"6\":\"-2.020885493\",\"7\":\"-1.262098318\",\"8\":\"-0.4529628\"},{\"1\":\"33\",\"2\":\"0.09511818\",\"3\":\"-2.17655918\",\"4\":\"0.04365950\",\"5\":\"-0.999046470\",\"6\":\"-1.527122947\",\"7\":\"-0.283597382\",\"8\":\"-1.0969069\"},{\"1\":\"34\",\"2\":\"-3.49503704\",\"3\":\"-3.61907284\",\"4\":\"-0.69467267\",\"5\":\"-0.719325992\",\"6\":\"-2.338761075\",\"7\":\"-1.931888420\",\"8\":\"-0.2640651\"},{\"1\":\"35\",\"2\":\"1.35395439\",\"3\":\"0.05130056\",\"4\":\"0.99928297\",\"5\":\"0.037862262\",\"6\":\"0.037871314\",\"7\":\"0.154888647\",\"8\":\"-0.5899443\"},{\"1\":\"36\",\"2\":\"2.99788359\",\"3\":\"1.13009930\",\"4\":\"0.93572307\",\"5\":\"0.352735506\",\"6\":\"0.360492912\",\"7\":\"0.578106615\",\"8\":\"0.3417563\"},{\"1\":\"37\",\"2\":\"4.12459366\",\"3\":\"1.28774627\",\"4\":\"0.95455830\",\"5\":\"0.298024240\",\"6\":\"0.302622168\",\"7\":\"0.441605289\",\"8\":\"0.6555376\"},{\"1\":\"38\",\"2\":\"4.17910362\",\"3\":\"1.40108168\",\"4\":\"0.94813417\",\"5\":\"0.317870417\",\"6\":\"0.323482562\",\"7\":\"0.500229239\",\"8\":\"3.0488875\"},{\"1\":\"39\",\"2\":\"3.29479945\",\"3\":\"-0.15513196\",\"4\":\"0.99889339\",\"5\":\"-0.047031783\",\"6\":\"-0.047049140\",\"7\":\"0.675754583\",\"8\":\"2.3088036\"},{\"1\":\"40\",\"2\":\"1.66572168\",\"3\":\"-2.10868248\",\"4\":\"0.61986717\",\"5\":\"-0.784706753\",\"6\":\"-0.902222904\",\"7\":\"-0.293134722\",\"8\":\"2.2307945\"},{\"1\":\"41\",\"2\":\"-3.66462706\",\"3\":\"-4.75887521\",\"4\":\"-0.61012424\",\"5\":\"-0.792305757\",\"6\":\"-2.227013716\",\"7\":\"-1.968298010\",\"8\":\"2.0544586\"},{\"1\":\"42\",\"2\":\"-2.16579538\",\"3\":\"-5.15485436\",\"4\":\"-0.38734750\",\"5\":\"-0.921933791\",\"6\":\"-1.968549070\",\"7\":\"-1.558517167\",\"8\":\"3.0389248\"},{\"1\":\"43\",\"2\":\"-1.52426781\",\"3\":\"-2.85922562\",\"4\":\"-0.47043144\",\"5\":\"-0.882436547\",\"6\":\"-2.060575960\",\"7\":\"-0.858778703\",\"8\":\"0.9205849\"},{\"1\":\"44\",\"2\":\"1.42303493\",\"3\":\"-0.03414520\",\"4\":\"0.99971225\",\"5\":\"-0.023987728\",\"6\":\"-0.023990029\",\"7\":\"0.216893002\",\"8\":\"1.9565801\"},{\"1\":\"45\",\"2\":\"5.59583647\",\"3\":\"0.21378670\",\"4\":\"0.99927100\",\"5\":\"0.038176750\",\"6\":\"0.038186030\",\"7\":\"1.640596600\",\"8\":\"1.1035635\"},{\"1\":\"46\",\"2\":\"6.15272700\",\"3\":\"2.42817922\",\"4\":\"0.93018252\",\"5\":\"0.367097365\",\"6\":\"0.375886591\",\"7\":\"1.502970780\",\"8\":\"0.4563652\"},{\"1\":\"47\",\"2\":\"-0.50612577\",\"3\":\"-0.35582198\",\"4\":\"-0.81806543\",\"5\":\"-0.575125163\",\"6\":\"-2.528835515\",\"7\":\"-0.791320527\",\"8\":\"1.5612600\"},{\"1\":\"48\",\"2\":\"-2.23071754\",\"3\":\"-3.45368298\",\"4\":\"-0.54256215\",\"5\":\"-0.840015662\",\"6\":\"-2.144280565\",\"7\":\"-1.989179768\",\"8\":\"-0.6286476\"},{\"1\":\"49\",\"2\":\"-1.32884742\",\"3\":\"-2.28612894\",\"4\":\"-0.50253642\",\"5\":\"-0.864556038\",\"6\":\"-2.097326397\",\"7\":\"-0.950776775\",\"8\":\"0.5227222\"},{\"1\":\"50\",\"2\":\"2.65503305\",\"3\":\"-0.42612812\",\"4\":\"0.98736377\",\"5\":\"-0.158470142\",\"6\":\"-0.159141023\",\"7\":\"1.013147978\",\"8\":\"1.1286082\"},{\"1\":\"51\",\"2\":\"-0.26304974\",\"3\":\"-0.95387377\",\"4\":\"-0.26584649\",\"5\":\"-0.964015376\",\"6\":\"-1.839878227\",\"7\":\"-0.671594732\",\"8\":\"1.4149414\"},{\"1\":\"52\",\"2\":\"-0.96211293\",\"3\":\"-1.85362451\",\"4\":\"-0.46068479\",\"5\":\"-0.887563813\",\"6\":\"-2.049562913\",\"7\":\"-0.718776095\",\"8\":\"2.3456906\"},{\"1\":\"53\",\"2\":\"-1.05348162\",\"3\":\"-2.85177356\",\"4\":\"-0.34652433\",\"5\":\"-0.938040983\",\"6\":\"-1.924659643\",\"7\":\"-1.262668349\",\"8\":\"1.3284477\"},{\"1\":\"54\",\"2\":\"2.92317918\",\"3\":\"2.39896019\",\"4\":\"0.77301447\",\"5\":\"0.634388392\",\"6\":\"0.687217064\",\"7\":\"0.989698053\",\"8\":\"1.3838732\"},{\"1\":\"55\",\"2\":\"2.77061412\",\"3\":\"0.43087953\",\"4\":\"0.98812215\",\"5\":\"0.153670484\",\"6\":\"0.154281814\",\"7\":\"0.980942347\",\"8\":\"1.0914481\"},{\"1\":\"56\",\"2\":\"4.51698727\",\"3\":\"2.80240015\",\"4\":\"0.84974527\",\"5\":\"0.527193489\",\"6\":\"0.555294401\",\"7\":\"0.977678117\",\"8\":\"2.0305476\"},{\"1\":\"57\",\"2\":\"4.01007715\",\"3\":\"2.86597528\",\"4\":\"0.81357660\",\"5\":\"0.581457748\",\"6\":\"0.620519324\",\"7\":\"0.497112120\",\"8\":\"-0.2258606\"},{\"1\":\"58\",\"2\":\"0.65965314\",\"3\":\"-0.36522211\",\"4\":\"0.87486119\",\"5\":\"-0.484373726\",\"6\":\"-0.505647170\",\"7\":\"-0.485582701\",\"8\":\"-0.3357991\"},{\"1\":\"59\",\"2\":\"4.60413259\",\"3\":\"4.53566615\",\"4\":\"0.71238375\",\"5\":\"0.701790138\",\"6\":\"0.777907281\",\"7\":\"1.921385107\",\"8\":\"0.5188617\"},{\"1\":\"60\",\"2\":\"2.68707582\",\"3\":\"3.65077575\",\"4\":\"0.59277439\",\"5\":\"0.805368560\",\"6\":\"0.936296960\",\"7\":\"0.252658388\",\"8\":\"2.9173637\"},{\"1\":\"61\",\"2\":\"-2.45918439\",\"3\":\"-2.17894809\",\"4\":\"-0.74846530\",\"5\":\"-0.663173955\",\"6\":\"-2.416541200\",\"7\":\"-1.349536643\",\"8\":\"1.5795329\"},{\"1\":\"62\",\"2\":\"2.00158291\",\"3\":\"2.25713606\",\"4\":\"0.66348192\",\"5\":\"0.748192318\",\"6\":\"0.845333339\",\"7\":\"0.886829049\",\"8\":\"1.1763272\"},{\"1\":\"63\",\"2\":\"-1.27546315\",\"3\":\"-0.59740285\",\"4\":\"-0.90558728\",\"5\":\"-0.424159976\",\"6\":\"-2.703558572\",\"7\":\"-0.851055751\",\"8\":\"1.6046648\"},{\"1\":\"64\",\"2\":\"1.64405562\",\"3\":\"-0.33149954\",\"4\":\"0.98027120\",\"5\":\"-0.197657211\",\"6\":\"-0.198967403\",\"7\":\"0.334422961\",\"8\":\"0.9024710\"},{\"1\":\"65\",\"2\":\"0.19727931\",\"3\":\"0.42044047\",\"4\":\"0.42478310\",\"5\":\"0.905295157\",\"6\":\"1.132074050\",\"7\":\"0.065872128\",\"8\":\"-0.9767915\"},{\"1\":\"66\",\"2\":\"-1.54839291\",\"3\":\"-2.23777092\",\"4\":\"-0.56900300\",\"5\":\"-0.822335444\",\"6\":\"-2.176089275\",\"7\":\"-1.169199545\",\"8\":\"-0.7789694\"},{\"1\":\"67\",\"2\":\"2.98600109\",\"3\":\"-0.01155437\",\"4\":\"0.99999251\",\"5\":\"-0.003869483\",\"6\":\"-0.003869493\",\"7\":\"-0.338487147\",\"8\":\"-1.9953547\"},{\"1\":\"68\",\"2\":\"0.07612163\",\"3\":\"-1.85779056\",\"4\":\"0.04093992\",\"5\":\"-0.999161610\",\"6\":\"-1.529844957\",\"7\":\"-1.269697282\",\"8\":\"-2.5139704\"},{\"1\":\"69\",\"2\":\"-2.56249266\",\"3\":\"-3.37828156\",\"4\":\"-0.60433534\",\"5\":\"-0.796730065\",\"6\":\"-2.219727696\",\"7\":\"-1.578369915\",\"8\":\"-1.5518034\"},{\"1\":\"70\",\"2\":\"-0.67512610\",\"3\":\"-1.38705377\",\"4\":\"-0.43764560\",\"5\":\"-0.899147556\",\"6\":\"-2.023774847\",\"7\":\"-0.984554347\",\"8\":\"-1.3301615\"},{\"1\":\"71\",\"2\":\"-3.15137507\",\"3\":\"-3.99245958\",\"4\":\"-0.61957565\",\"5\":\"-0.784936950\",\"6\":\"-2.238998297\",\"7\":\"-1.800101792\",\"8\":\"-1.9626202\"},{\"1\":\"72\",\"2\":\"-1.00882002\",\"3\":\"-0.95666854\",\"4\":\"-0.72561348\",\"5\":\"-0.688102516\",\"6\":\"-2.382721860\",\"7\":\"-0.335745528\",\"8\":\"-0.2380380\"},{\"1\":\"73\",\"2\":\"0.54175837\",\"3\":\"-2.44547376\",\"4\":\"0.21629116\",\"5\":\"-0.976328907\",\"6\":\"-1.352782226\",\"7\":\"-0.578820657\",\"8\":\"-0.2287046\"},{\"1\":\"74\",\"2\":\"-0.93599883\",\"3\":\"-1.80784978\",\"4\":\"-0.45977326\",\"5\":\"-0.888036346\",\"6\":\"-2.048536178\",\"7\":\"-0.998678735\",\"8\":\"-1.4701683\"},{\"1\":\"75\",\"2\":\"2.94462256\",\"3\":\"0.48060478\",\"4\":\"0.98694087\",\"5\":\"0.161082952\",\"6\":\"0.161787837\",\"7\":\"1.129515932\",\"8\":\"-1.4985352\"},{\"1\":\"76\",\"2\":\"1.81931938\",\"3\":\"1.91318018\",\"4\":\"0.68910739\",\"5\":\"0.724659237\",\"6\":\"0.810539766\",\"7\":\"0.570305210\",\"8\":\"-1.0121734\"},{\"1\":\"77\",\"2\":\"3.42466599\",\"3\":\"3.21533450\",\"4\":\"0.72903671\",\"5\":\"0.684474600\",\"6\":\"0.753882777\",\"7\":\"1.062483886\",\"8\":\"-0.6926036\"},{\"1\":\"78\",\"2\":\"0.20403044\",\"3\":\"-0.72071562\",\"4\":\"0.27238961\",\"5\":\"-0.962187041\",\"6\":\"-1.294920650\",\"7\":\"-1.118506054\",\"8\":\"-0.4558910\"},{\"1\":\"79\",\"2\":\"-2.30411865\",\"3\":\"-3.57186321\",\"4\":\"-0.54207550\",\"5\":\"-0.840329787\",\"6\":\"-2.143701339\",\"7\":\"-1.698874213\",\"8\":\"-0.6671553\"},{\"1\":\"80\",\"2\":\"-2.10088953\",\"3\":\"-2.69650625\",\"4\":\"-0.61459785\",\"5\":\"-0.788840594\",\"6\":\"-2.232672393\",\"7\":\"-0.926421697\",\"8\":\"0.7232729\"},{\"1\":\"81\",\"2\":\"-1.79483134\",\"3\":\"-1.81320814\",\"4\":\"-0.70349615\",\"5\":\"-0.710699065\",\"6\":\"-2.351101242\",\"7\":\"-0.667043613\",\"8\":\"0.6912563\"},{\"1\":\"82\",\"2\":\"6.24711225\",\"3\":\"3.97990099\",\"4\":\"0.84338829\",\"5\":\"0.537304559\",\"6\":\"0.567237877\",\"7\":\"2.712553896\",\"8\":\"1.3895850\"},{\"1\":\"83\",\"2\":\"5.10247828\",\"3\":\"2.85774874\",\"4\":\"0.87247971\",\"5\":\"0.488650348\",\"6\":\"0.510542166\",\"7\":\"1.590000020\",\"8\":\"1.1904937\"},{\"1\":\"84\",\"2\":\"3.98633251\",\"3\":\"3.93476783\",\"4\":\"0.71169482\",\"5\":\"0.702488781\",\"6\":\"0.778888467\",\"7\":\"1.528641828\",\"8\":\"1.3388472\"},{\"1\":\"85\",\"2\":\"5.31961321\",\"3\":\"1.96686614\",\"4\":\"0.93794162\",\"5\":\"0.346793187\",\"6\":\"0.354149943\",\"7\":\"1.002173643\",\"8\":\"1.8224774\"},{\"1\":\"86\",\"2\":\"2.05377359\",\"3\":\"0.99196619\",\"4\":\"0.90046763\",\"5\":\"0.434923036\",\"6\":\"0.449952803\",\"7\":\"-0.333901223\",\"8\":\"2.1403998\"},{\"1\":\"87\",\"2\":\"2.65705968\",\"3\":\"-0.14524814\",\"4\":\"0.99850921\",\"5\":\"-0.054583496\",\"6\":\"-0.054610637\",\"7\":\"0.355661122\",\"8\":\"1.7628865\"},{\"1\":\"88\",\"2\":\"1.09305480\",\"3\":\"-1.06258048\",\"4\":\"0.71703154\",\"5\":\"-0.697040728\",\"6\":\"-0.771262057\",\"7\":\"-0.728293471\",\"8\":\"1.9835049\"},{\"1\":\"89\",\"2\":\"0.25497835\",\"3\":\"-0.91581117\",\"4\":\"0.26821644\",\"5\":\"-0.963358678\",\"6\":\"-1.299255174\",\"7\":\"-0.406996689\",\"8\":\"0.3489979\"},{\"1\":\"90\",\"2\":\"-2.41205876\",\"3\":\"-3.72633469\",\"4\":\"-0.54339435\",\"5\":\"-0.839477564\",\"6\":\"-2.145271577\",\"7\":\"-1.542304104\",\"8\":\"1.1381151\"},{\"1\":\"91\",\"2\":\"1.67280675\",\"3\":\"0.01717489\",\"4\":\"0.99994730\",\"5\":\"0.010266570\",\"6\":\"0.010266750\",\"7\":\"0.505847352\",\"8\":\"2.7188898\"},{\"1\":\"92\",\"2\":\"-1.15962205\",\"3\":\"-2.10517991\",\"4\":\"-0.48248505\",\"5\":\"-0.875904205\",\"6\":\"-2.074285954\",\"7\":\"-0.976458291\",\"8\":\"3.3981872\"},{\"1\":\"93\",\"2\":\"-2.55213190\",\"3\":\"-2.75538839\",\"4\":\"-0.67952935\",\"5\":\"-0.733648321\",\"6\":\"-2.317917254\",\"7\":\"-1.345438514\",\"8\":\"3.0755646\"},{\"1\":\"94\",\"2\":\"-1.47384660\",\"3\":\"-1.56091719\",\"4\":\"-0.68653663\",\"5\":\"-0.727095222\",\"6\":\"-2.327511298\",\"7\":\"-0.906154778\",\"8\":\"3.7331033\"},{\"1\":\"95\",\"2\":\"-1.74738126\",\"3\":\"-0.60027699\",\"4\":\"-0.94575069\",\"5\":\"-0.324893251\",\"6\":\"-2.810693799\",\"7\":\"-0.835121824\",\"8\":\"3.3406239\"},{\"1\":\"96\",\"2\":\"0.36610445\",\"3\":\"-0.99648277\",\"4\":\"0.34485859\",\"5\":\"-0.938654650\",\"6\":\"-1.218708197\",\"7\":\"0.111480856\",\"8\":\"3.0859380\"},{\"1\":\"97\",\"2\":\"0.75057725\",\"3\":\"0.22499062\",\"4\":\"0.95789039\",\"5\":\"0.287134133\",\"6\":\"0.291233637\",\"7\":\"-0.242637811\",\"8\":\"0.4129937\"},{\"1\":\"98\",\"2\":\"0.72283361\",\"3\":\"-1.22747920\",\"4\":\"0.50743053\",\"5\":\"-0.861692669\",\"6\":\"-1.038596048\",\"7\":\"-0.968507806\",\"8\":\"0.7658389\"},{\"1\":\"99\",\"2\":\"2.45233568\",\"3\":\"-1.95316294\",\"4\":\"0.78222152\",\"5\":\"-0.623000392\",\"6\":\"-0.672572604\",\"7\":\"-0.327047491\",\"8\":\"-0.9105610\"},{\"1\":\"100\",\"2\":\"-1.35535478\",\"3\":\"-2.74354935\",\"4\":\"-0.44291577\",\"5\":\"-0.896563229\",\"6\":\"-2.029644557\",\"7\":\"-1.167899143\",\"8\":\"-0.9169217\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nFirst,\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrad <- 1\nggplot(df_ts, aes(t, theta, color = theta)) +\n  # geom_point(size = 0.5, alpha = 0.5) +\n  geom_segment(aes(x = t, y = theta, \n                   xend = t + 8/3*rad * U1, \n                   yend = theta + 3/8*rad * U2),\n              arrow = arrow(length = unit(0.15,\"cm\")),\n                  linewidth = 0.9) +\n  scale_color_angles() +\n  theme_bw() +\n  labs(x = \"t\",\n       y = TeX(\"$\\\\theta$\"))\n```\n\n::: {.cell-output-display}\n![Angular time series.](directions-data-viz_files/figure-html/fig-ts-1-1.png){#fig-ts-1 width=768}\n:::\n:::\n\n\n\nSecond,\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Vector Fields\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nN <- 10\nloc <- expand.grid(long = 1:N, lat = 1:N)\n\nN2 <- 23\nloc2 <- expand.grid(long = 1:N2 * (N/N2), lat = 1:N2* (N/N2))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(6541)\n\nmu_dir <- 0\nsim_list <- list(\n  N = N^2,\n  P = 1,\n  loc = as.matrix(loc),\n  sigma_w = 1,\n  rho_w = 0,\n  rho = 1/6,\n  mu0 = 3*c(cos(mu_dir), sin(mu_dir)),\n  B = matrix(c(-.25, 1), nrow = 1)\n)\n\ndf_spat <- pnregstan::gp_geostat_sim_data(\n    N = 10, \n    M = 10, \n    sigma = 1, \n    rho = 5, \n    alpha = 1)\ndf_spat <- pnregstan::pgp_geostat_reg_sim_data(\n    loc = loc, \n    X = df_spat$X,\n    sigma_w = sim_list$sigma_w, \n    rho_w = sim_list$rho_w, \n    rho = sim_list$rho,\n    B = sim_list$B, \n    mu0 = sim_list$mu0)\ndf_spat$theta <- circular::minusPiPlusPi(circular::circular(df_spat$theta)) |> as.numeric()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_vector_field <- function(df, long, lat, theta, color_name = \"Dir\", fill_name = \"Dir\", \n                            colors = list(low = \"magenta\", mid = \"dodgerblue\", high = \"magenta\", vector = \"gray90\"), \n                            rad = 0.5, midpoint = 0, limits = c(-pi, pi)) {\n    ggplot(df, aes({{long}}, {{lat}}, color = {{theta}})) +\n        geom_raster(aes({{long}}, {{lat}}, fill = {{theta}}), \n                    interpolate = FALSE, alpha = 0.75) +\n        geom_point() +\n        geom_segment(aes(x = {{long}}, y = {{lat}},\n                         xend = {{long}} + rad * cos({{theta}}),\n                         yend = {{lat}} + rad * sin({{theta}})),\n                     arrow = arrow(angle = 45, length = unit(1, \"mm\")),\n                     color = colors$vector) +\n        scale_color_angles(colors = colors, color_name = color_name, midpoint = midpoint, limits = limits) +\n        scale_fill_angles(colors = colors, fill_name = fill_name, midpoint = midpoint, limits = limits) \n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrad <- 1/2\ngg_vector_field(df_spat, long, lat, theta, rad = rad)\n```\n\n::: {.cell-output-display}\n![Vector field for spatial angular data. All vectors are scaled to unit size.](directions-data-viz_files/figure-html/fig-vec-field-1.png){#fig-vec-field width=672}\n:::\n:::\n\n\n\n## Imputation Figures",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}