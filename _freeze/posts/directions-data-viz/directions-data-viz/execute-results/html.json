{
  "hash": "42b834461c48af8401a48e471ff06f94",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Visualizing Directional Data\nauthor: Ben\ndate: 2026-02-19\nformat: \n    html:\n        code-fold: show\n        code-summary: \"Show code\"\n        code-tools: true\n        number-depth: 3\n        toc: true\n        toc-location: left\n        toc-expand: 2\n        toc-depth: 3\n        link-external-newwindow: true\n        citations-hover: true\n        df-print: paged\ncache: true\nfreeze: true\nlightbox: true\ncategories: [data-viz, angular-data]\n---\n\n\n\n\nVisualizing directional or angular data has been a challenge while writing my dissertation and preparing presentations for the related research. There are a few tools out there for preparing directional data plots in R (see `circular`, mixtures of VMF `movMF`, etc.) but these largely don't integrate well with modern tools like `ggplot2` and the angular functionality in `ggplot2` doesn't always behave as desired for directional data. The exception to this being `ggcircular`, which unfortunately is rather limited and hasn't been updated recently.[^1]\n\n[^1]: `ggcircular` requires the `circular` data type from the `circular` package.\n\nIn this post, I'll share some of the basic directional data plots and tricks I've learned or used with `ggplot2`; some of these are just adaptations of existing methods, I am not claiming to be the original developer of any of these graphics. I will also point out where I wrote wrapper functions for a visualization in my `pnregstan` and `imputeangles` packages, but I will make all of the visualizations with the full `ggplot2` code. In a [follow-up post](../imp-data-viz/imp-data-viz.qmd), I'll share some visualizations and diagnostic figures for imputed angular data.\n\n\n\n\n::: {.cell warnings='false'}\n\n```{.r .cell-code}\nlibrary(dplyr, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(ggplot2, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(ggthemes, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(ggforce, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(circular, warn.conflicts = FALSE, quietly = TRUE)\n# devtools::install_github(repo = \"marcpabst/ggcircular\")\nlibrary(ggcircular, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(latex2exp, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(imputeangles, warn.conflicts = FALSE, quietly = TRUE)\nlibrary(pnregstan, warn.conflicts = FALSE, quietly = TRUE)\n\ntheme_set(theme_classic())\n```\n:::\n\n\n\n\nI'll start by generating some data from a projected normal regression model.\n\n\n\n\n::: {#tbl-sim-dat .cell tbl-cap='Simulated data from a projected normal regression model.'}\n\n```{.r .cell-code}\nN <- 50\nbeta <- c(0, 2.5, 0, 2.5)\nB <- matrix(beta, ncol = 2)\nsigma_mat <- c(1,0,0,1)\nX <- matrix(seq(from = -2, to = 2, length.out = N))\n\nsim_data <- pnregstan::pnreg_sim_data(N = N, \n                         B = beta, \n                         Sigma_theta = sigma_mat,\n                         X = X) |>\n    mutate(\n        theta = case_when(\n            theta < 0 ~ theta + 2*pi,\n            TRUE ~ theta\n        )\n    )\n\nsim_data\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"theta\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3.5465445\",\"2\":\"-0.9191213571\",\"3\":\"-0.3939745\",\"4\":\"-2.00000000\"},{\"1\":\"4.7998234\",\"2\":\"0.0873230129\",\"3\":\"-0.9961800\",\"4\":\"-1.91836735\"},{\"1\":\"5.9942896\",\"2\":\"0.9585590620\",\"3\":\"-0.2848939\",\"4\":\"-1.83673469\"},{\"1\":\"2.7192392\",\"2\":\"-0.9121267683\",\"3\":\"0.4099082\",\"4\":\"-1.75510204\"},{\"1\":\"5.4637328\",\"2\":\"0.6826214063\",\"3\":\"-0.7307722\",\"4\":\"-1.67346939\"},{\"1\":\"4.5943231\",\"2\":\"-0.1177917412\",\"3\":\"-0.9930383\",\"4\":\"-1.59183673\"},{\"1\":\"3.9315691\",\"2\":\"-0.7038620403\",\"3\":\"-0.7103367\",\"4\":\"-1.51020408\"},{\"1\":\"5.9832142\",\"2\":\"0.9553450285\",\"3\":\"-0.2954926\",\"4\":\"-1.42857143\"},{\"1\":\"5.0616762\",\"2\":\"0.3422281079\",\"3\":\"-0.9396169\",\"4\":\"-1.34693878\"},{\"1\":\"2.1964101\",\"2\":\"-0.5855948718\",\"3\":\"0.8106039\",\"4\":\"-1.26530612\"},{\"1\":\"3.8955720\",\"2\":\"-0.7289705941\",\"3\":\"-0.6845450\",\"4\":\"-1.18367347\"},{\"1\":\"4.6229621\",\"2\":\"-0.0893077137\",\"3\":\"-0.9960041\",\"4\":\"-1.10204082\"},{\"1\":\"1.1695401\",\"2\":\"0.3905751135\",\"3\":\"0.9205711\",\"4\":\"-1.02040816\"},{\"1\":\"2.7744889\",\"2\":\"-0.9333707594\",\"3\":\"0.3589137\",\"4\":\"-0.93877551\"},{\"1\":\"3.3559857\",\"2\":\"-0.9771057046\",\"3\":\"-0.2127544\",\"4\":\"-0.85714286\"},{\"1\":\"4.1182874\",\"2\":\"-0.5597645078\",\"3\":\"-0.8286517\",\"4\":\"-0.77551020\"},{\"1\":\"5.5762370\",\"2\":\"0.7603475651\",\"3\":\"-0.6495164\",\"4\":\"-0.69387755\"},{\"1\":\"1.2922277\",\"2\":\"0.2749797016\",\"3\":\"0.9614500\",\"4\":\"-0.61224490\"},{\"1\":\"1.9910699\",\"2\":\"-0.4080102059\",\"3\":\"0.9129774\",\"4\":\"-0.53061224\"},{\"1\":\"1.6368057\",\"2\":\"-0.0659614265\",\"3\":\"0.9978222\",\"4\":\"-0.44897959\"},{\"1\":\"1.6516151\",\"2\":\"-0.0807307729\",\"3\":\"0.9967359\",\"4\":\"-0.36734694\"},{\"1\":\"5.3159318\",\"2\":\"0.5675629017\",\"3\":\"-0.8233300\",\"4\":\"-0.28571429\"},{\"1\":\"1.9431610\",\"2\":\"-0.3638190648\",\"3\":\"0.9314696\",\"4\":\"-0.20408163\"},{\"1\":\"0.7930056\",\"2\":\"0.7017071154\",\"3\":\"0.7124655\",\"4\":\"-0.12244898\"},{\"1\":\"1.8062503\",\"2\":\"-0.2332844753\",\"3\":\"0.9724085\",\"4\":\"-0.04081633\"},{\"1\":\"1.5247823\",\"2\":\"0.0459978160\",\"3\":\"0.9989415\",\"4\":\"0.04081633\"},{\"1\":\"2.0375069\",\"2\":\"-0.4499511282\",\"3\":\"0.8930532\",\"4\":\"0.12244898\"},{\"1\":\"1.5193296\",\"2\":\"0.0514440091\",\"3\":\"0.9986759\",\"4\":\"0.20408163\"},{\"1\":\"1.7315186\",\"2\":\"-0.1600312342\",\"3\":\"0.9871120\",\"4\":\"0.28571429\"},{\"1\":\"1.6612635\",\"2\":\"-0.0903438102\",\"3\":\"0.9959106\",\"4\":\"0.36734694\"},{\"1\":\"1.8790833\",\"2\":\"-0.3034267927\",\"3\":\"0.9528548\",\"4\":\"0.44897959\"},{\"1\":\"1.8750730\",\"2\":\"-0.2996031386\",\"3\":\"0.9540639\",\"4\":\"0.53061224\"},{\"1\":\"1.8971833\",\"2\":\"-0.3206228762\",\"3\":\"0.9472069\",\"4\":\"0.61224490\"},{\"1\":\"1.4254748\",\"2\":\"0.1448105503\",\"3\":\"0.9894594\",\"4\":\"0.69387755\"},{\"1\":\"1.2412543\",\"2\":\"0.3236097029\",\"3\":\"0.9461907\",\"4\":\"0.77551020\"},{\"1\":\"1.6261450\",\"2\":\"-0.0553204127\",\"3\":\"0.9984687\",\"4\":\"0.85714286\"},{\"1\":\"1.4894141\",\"2\":\"0.0812924275\",\"3\":\"0.9966903\",\"4\":\"0.93877551\"},{\"1\":\"1.6106195\",\"2\":\"-0.0398126127\",\"3\":\"0.9992072\",\"4\":\"1.02040816\"},{\"1\":\"1.6353149\",\"2\":\"-0.0644737959\",\"3\":\"0.9979194\",\"4\":\"1.10204082\"},{\"1\":\"1.5400806\",\"2\":\"0.0307108847\",\"3\":\"0.9995283\",\"4\":\"1.18367347\"},{\"1\":\"1.5641330\",\"2\":\"0.0066632482\",\"3\":\"0.9999778\",\"4\":\"1.26530612\"},{\"1\":\"1.6317133\",\"2\":\"-0.0608793405\",\"3\":\"0.9981451\",\"4\":\"1.34693878\"},{\"1\":\"1.4306582\",\"2\":\"0.1396798410\",\"3\":\"0.9901967\",\"4\":\"1.42857143\"},{\"1\":\"1.5714816\",\"2\":\"-0.0006852765\",\"3\":\"0.9999998\",\"4\":\"1.51020408\"},{\"1\":\"1.6478666\",\"2\":\"-0.0769940177\",\"3\":\"0.9970316\",\"4\":\"1.59183673\"},{\"1\":\"1.9699735\",\"2\":\"-0.3886603009\",\"3\":\"0.9213811\",\"4\":\"1.67346939\"},{\"1\":\"1.5637394\",\"2\":\"0.0070568241\",\"3\":\"0.9999751\",\"4\":\"1.75510204\"},{\"1\":\"1.5978399\",\"2\":\"-0.0270403082\",\"3\":\"0.9996343\",\"4\":\"1.83673469\"},{\"1\":\"1.7550074\",\"2\":\"-0.1831710345\",\"3\":\"0.9830811\",\"4\":\"1.91836735\"},{\"1\":\"1.6792275\",\"2\":\"-0.1082188563\",\"3\":\"0.9941271\",\"4\":\"2.00000000\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\nI'm also going to create two scale functions to help plot angles with color or fill such that $\\theta = 0$ and $\\theta = 2\\pi$ have the same color.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscale_color_angles <- function(colors = list(low = \"magenta\", mid = \"dodgerblue\", high = \"magenta\"), color_name = \"Angle\", midpoint = 0, limits = c(-pi, pi)) {\n    scale_color_gradient2(low = colors$low, mid = colors$mid, high = colors$high,\n                          na.value = \"gray70\", name = color_name,\n                          midpoint = midpoint, limits = limits)\n}\n\nscale_fill_angles <- function(colors = list(low = \"magenta\", mid = \"dodgerblue\", high = \"magenta\"), fill_name = \"Angle\", midpoint = 0, limits = c(-pi, pi)) {\n    scale_fill_gradient2(low = colors$low, mid = colors$mid, high = colors$high,\n                          na.value = \"gray70\", name = fill_name,\n                          midpoint = midpoint, limits = limits)\n}\n```\n:::\n\n\n\n\n## Density Diagrams and Dot Plots\n\n::: {.panel-tabset}\n## Density w/ ggplot2\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndc <- density.circular(as.circular(sim_data$theta), bw = 20)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.circular(sim_data$theta): an object is coerced to the class 'circular' using default value for the following components:\n  type: 'angles'\n  units: 'radians'\n  template: 'none'\n  modulo: 'asis'\n  zero: 0\n  rotation: 'counter'\ndensity.circularas.circular(sim_data$theta)20\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_dens <- data.frame(\n    x = dc$x,\n    y = dc$y + 1\n)\n\nggplot(df_dens, aes(x = x, y = y)) +\n    # geom_circle(aes(x0 = 0, y0 = 0, r = 1), \n    #             linetype = \"dotted\", \n    #             color = \"lightgray\") +\n    geom_hline(yintercept = 1, color = \"lightgray\", linetype = \"dotted\") +\n    annotate(\n        geom = \"point\",\n        x = 0, y = 0, \n        color = \"lightgray\", shape = \"+\", size = 3\n    ) +\n    geom_line() +\n    theme_void() +\n    theme(axis.text.x = element_text()) +\n    coord_polar(direction = -1, start = -pi/2) +\n    scale_x_continuous(breaks = c(0, pi/2, pi, 3*pi/2),\n        labels = c(TeX(\"0\"), TeX(\"$\\\\pi/2$\"), TeX(\"$\\\\pi\"), TeX(\"$3\\\\pi/2\")),\n        limits = c(0, 2*pi)) +\n    labs(x = \"\", y = \"\")\n```\n\n::: {.cell-output-display}\n![A circular density plot](directions-data-viz_files/figure-html/fig-density-1.png){#fig-density width=480}\n:::\n:::\n\n\n\n\n## Dotplot w/ ggplot2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(sim_data, aes(x = theta, y = 1, color = theta)) +\n    coord_polar(start = -pi/2, direction = -1) +\n    geom_hline(yintercept = 1, \n                linetype = \"dotted\", \n                color = \"lightgray\") +\n    annotate(\n        geom = \"point\",\n        x = 0, y = 0, \n        color = \"lightgray\", shape = \"+\", size = 3\n    ) +\n    geom_point() +\n    scale_color_angles(limits = c(0, 2*pi), midpoint = pi) + \n    scale_x_continuous(breaks = c(0, pi/2, pi, 3*pi/2),\n        labels = c(TeX(\"0\"), TeX(\"$\\\\pi/2$\"), TeX(\"$\\\\pi\"), TeX(\"$3\\\\pi/2\")),\n        limits = c(0, 2*pi)) +\n    theme_void() +\n    theme(axis.text.x = element_text())\n```\n\n::: {.cell-output-display}\n![A circular dotplot plot](directions-data-viz_files/figure-html/fig-dotplot-1.png){#fig-dotplot width=480}\n:::\n:::\n\n\n\n\n## Dotplot w/ ggcircular\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_data$c_theta <- as.circular(sim_data$theta, units = \"degrees\", zero = 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in as.circular(sim_data$theta, units = \"degrees\", zero = 0): an object is coerced to the class 'circular' using default value for the following components:\n  type: 'angles'\n  template: 'none'\n  modulo: 'asis'\n  rotation: 'counter'\nevalexprenvir\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(sim_data, aes(x = c_theta)) +\n    coord_polar(start = -pi/2, direction = -1) +\n    geom_hline(yintercept = 1, color = \"lightgray\", linetype = \"dotted\") +\n    annotate(\n        geom = \"point\",\n        x = 0, y = 0, \n        color = \"lightgray\", shape = \"+\", size = 3\n    ) +\n    geom_point_circular() +\n    theme_circular()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nNULL\n$x\n[1]   0 180\n```\n\n\n:::\n\n::: {.cell-output-display}\n![The same dotplot with the ggcircular package.](directions-data-viz_files/figure-html/fig-ggcirc-dotplot-1.png){#fig-ggcirc-dotplot width=672}\n:::\n:::\n\n\n\n:::\n\n## Wrapped Scatterplots\n\nThe wrapped scatterplot makes it easier to visualize circular-linear relationships at the boundaries of the circular interval. When a point cloud passes over the $2\\pi$ boundary and wraps back to the 0 boundary, as in @fig-scatterplot-1 at $X = -1$, it looks like a steep \"decrease\" in the angular variable without wrapping. However, when a replication of the data are plotted with the angles shifted by $\\pm 2\\pi$, as in @fig-scatterplot-2, then the circular-linear relationship can be more intuitively understood as a continuous functional relationship that wraps around the circle.\n\n::: {.panel-tabset}\n## Scatterplot w/o Wrapping\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(sim_data, \n       aes(x = X, y = theta, color = theta)) +\n    geom_hline(yintercept = c(0, 2*pi), \n              linetype = \"dotted\",\n              linewidth = 0.85,\n              color = \"lightgray\") +\n    geom_point() +\n    scale_color_angles(limits = c(0, 2*pi), midpoint = pi) +\n    labs(y = TeX(\"$\\\\theta$\")) +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![A non-wrapped circular-linear scatterplot.](directions-data-viz_files/figure-html/fig-scatterplot-1-1.png){#fig-scatterplot-1 width=672}\n:::\n:::\n\n\n\n\n## Scatterplot w/ Wrapping\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_data_2 <- sim_data |>\n    mutate(\n        theta = case_when(\n            theta < pi ~ theta + 2*pi,\n            theta >= pi ~ theta - 2*pi,\n            TRUE ~ theta\n        ),\n        original = FALSE\n    )\nsim_data$original = TRUE\n\nggplot(bind_rows(sim_data, sim_data_2), \n       aes(x = X, y = theta, shape = original, color = theta)) +\n    geom_hline(yintercept = c(0, 2*pi), \n              linetype = \"dotted\",\n              linewidth = 0.85,\n              color = \"gray50\") +\n    geom_point() +\n    scale_shape_manual(name = \"Original\", values = c(1, 16)) +\n    scale_color_angles(limits = c(0, 2*pi), midpoint = pi) +\n    labs(y = TeX(\"$\\\\theta$\")) +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![A wrapped circular-linear scatterplot.](directions-data-viz_files/figure-html/fig-scatterplot-2-1.png){#fig-scatterplot-2 width=672}\n:::\n:::\n\n\n\n:::\n\n## Angular Time Series\n\nFirst, I generate a time series from a projected normal autoregressive process with exogenous predictors (PN ARX) with order $p = 1$. The predictors are simulated from an AR(1) and ARMA(1, 2) processes. \n\nThe time series figure displays the angles as unit vectors from left to right with the origin of each vector starting at the coordinate $(t, \\theta)$. This gives the visual cue of where the angle is on the unit circle in the vertical dimension, when the angle is observed in the horizontal dimension, with the direction of the vector giving a further cue of what the direction.\n\nI took this approach instead of a standard time series plot because the start line plot does not connect observations in a sensible way. For example, the angles $\\pi/16$ and $31 \\pi / 16$ are very close to each other on the circular interval but would have a nearly vertical, long segment connecting them in a standard time series plot. To avoid this, I do not connect the observations, and I use the directions of the vectors to give a cue to the direction of the observations. Additionally, varying the vertical origin of the vector by the angular value avoids overplotting.\n\n\n::: {.panel-tabset}\n## Simulate Data\n\n\n\n\n::: {#tbl-sim-dat-ts .cell tbl-cap='Simulated data from a PN ARX(1) model.'}\n\n```{.r .cell-code}\nset.seed(65433)\nN <- 50\nX1 <- arima.sim(n = N, list(ar = c(0.24)))\nX2 <- arima.sim(n = N, list(ar = c(0.75), ma = c(-0.25, 0.25)))\nX <- cbind(X1, X2)\n\ndf_ts <- pn_arx_sim_data(N = N, \n    mu_0 = c(1, 0),\n    B_vec = c(2, -0.1, 2, -0.1),\n    Psi_vec = c(0.25, 0.02, 0.02, 0.25),\n    Sigma_vec = c(1,0,0,1),\n    X = X)\n\ndf_ts$t <- 1:nrow(df_ts)\ndf_ts\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"theta\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U1\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"U2\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X1\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X2\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"t\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"-0.14025664\",\"2\":\"0.9901802\",\"3\":\"-0.13979723\",\"4\":\"0.066761767\",\"5\":\"-0.55584477\",\"6\":\"1\"},{\"1\":\"0.47872111\",\"2\":\"0.8875848\",\"3\":\"0.46064443\",\"4\":\"0.361662031\",\"5\":\"-0.67490234\",\"6\":\"2\"},{\"1\":\"1.41334593\",\"2\":\"0.1568007\",\"3\":\"0.98763027\",\"4\":\"-0.035483177\",\"5\":\"0.68692824\",\"6\":\"3\"},{\"1\":\"0.76818310\",\"2\":\"0.7191743\",\"3\":\"0.69482972\",\"4\":\"0.396705617\",\"5\":\"-1.01490332\",\"6\":\"4\"},{\"1\":\"-0.05143130\",\"2\":\"0.9986777\",\"3\":\"-0.05140863\",\"4\":\"0.097194226\",\"5\":\"-1.61683204\",\"6\":\"5\"},{\"1\":\"0.72548949\",\"2\":\"0.7481747\",\"3\":\"0.66350175\",\"4\":\"1.635299058\",\"5\":\"-1.71708328\",\"6\":\"6\"},{\"1\":\"-2.17156577\",\"2\":\"-0.5652774\",\"3\":\"-0.82490091\",\"4\":\"-1.251128600\",\"5\":\"-1.96045008\",\"6\":\"7\"},{\"1\":\"0.53478551\",\"2\":\"0.8603780\",\"3\":\"0.50965650\",\"4\":\"0.645597031\",\"5\":\"1.38380943\",\"6\":\"8\"},{\"1\":\"0.33420286\",\"2\":\"0.9446721\",\"3\":\"0.32801623\",\"4\":\"0.853397078\",\"5\":\"1.14750747\",\"6\":\"9\"},{\"1\":\"0.77031895\",\"2\":\"0.7176886\",\"3\":\"0.69636418\",\"4\":\"1.633984765\",\"5\":\"2.49108674\",\"6\":\"10\"},{\"1\":\"0.50750464\",\"2\":\"0.8739600\",\"3\":\"0.48599792\",\"4\":\"-0.581893035\",\"5\":\"2.45160098\",\"6\":\"11\"},{\"1\":\"-2.25081713\",\"2\":\"-0.6288092\",\"3\":\"-0.77755963\",\"4\":\"-3.402485963\",\"5\":\"1.39221339\",\"6\":\"12\"},{\"1\":\"-2.15455360\",\"2\":\"-0.5511629\",\"3\":\"-0.83439768\",\"4\":\"-1.663801719\",\"5\":\"1.78238808\",\"6\":\"13\"},{\"1\":\"-1.87020626\",\"2\":\"-0.2949564\",\"3\":\"-0.95551070\",\"4\":\"0.358495226\",\"5\":\"0.27058384\",\"6\":\"14\"},{\"1\":\"0.28932495\",\"2\":\"0.9584367\",\"3\":\"0.28530530\",\"4\":\"0.202044300\",\"5\":\"0.28309402\",\"6\":\"15\"},{\"1\":\"-2.40419467\",\"2\":\"-0.7402206\",\"3\":\"-0.67236412\",\"4\":\"-1.033371476\",\"5\":\"-1.37766586\",\"6\":\"16\"},{\"1\":\"-2.09425183\",\"2\":\"-0.4998759\",\"3\":\"-0.86609703\",\"4\":\"-0.380936586\",\"5\":\"0.14585560\",\"6\":\"17\"},{\"1\":\"0.74225005\",\"2\":\"0.7369495\",\"3\":\"0.67594779\",\"4\":\"0.606787447\",\"5\":\"-1.56862626\",\"6\":\"18\"},{\"1\":\"0.99016274\",\"2\":\"0.5485538\",\"3\":\"0.83611526\",\"4\":\"-0.334682736\",\"5\":\"-1.79409272\",\"6\":\"19\"},{\"1\":\"0.23876216\",\"2\":\"0.9716315\",\"3\":\"0.23650008\",\"4\":\"-0.215657236\",\"5\":\"-1.92551236\",\"6\":\"20\"},{\"1\":\"0.79585834\",\"2\":\"0.6996718\",\"3\":\"0.71446442\",\"4\":\"-0.730024295\",\"5\":\"-2.19373869\",\"6\":\"21\"},{\"1\":\"0.99966585\",\"2\":\"0.5405834\",\"3\":\"0.84129040\",\"4\":\"0.472421850\",\"5\":\"-1.32479514\",\"6\":\"22\"},{\"1\":\"0.58272026\",\"2\":\"0.8349688\",\"3\":\"0.55029730\",\"4\":\"1.307828914\",\"5\":\"-1.49537827\",\"6\":\"23\"},{\"1\":\"0.05632383\",\"2\":\"0.9984142\",\"3\":\"0.05629405\",\"4\":\"0.337472338\",\"5\":\"-1.88648260\",\"6\":\"24\"},{\"1\":\"0.69440384\",\"2\":\"0.7684353\",\"3\":\"0.63992744\",\"4\":\"1.934705623\",\"5\":\"-1.34924719\",\"6\":\"25\"},{\"1\":\"0.68400751\",\"2\":\"0.7750466\",\"3\":\"0.63190410\",\"4\":\"0.405483451\",\"5\":\"-2.30526042\",\"6\":\"26\"},{\"1\":\"0.69860347\",\"2\":\"0.7657411\",\"3\":\"0.64314894\",\"4\":\"1.711851807\",\"5\":\"-0.34967129\",\"6\":\"27\"},{\"1\":\"0.77478423\",\"2\":\"0.7145720\",\"3\":\"0.69956191\",\"4\":\"0.842860486\",\"5\":\"-0.60571830\",\"6\":\"28\"},{\"1\":\"0.73440037\",\"2\":\"0.7422327\",\"3\":\"0.67014221\",\"4\":\"1.687978623\",\"5\":\"0.08467755\",\"6\":\"29\"},{\"1\":\"0.90823476\",\"2\":\"0.6151385\",\"3\":\"0.78841910\",\"4\":\"0.255857335\",\"5\":\"1.41926495\",\"6\":\"30\"},{\"1\":\"0.16781879\",\"2\":\"0.9859514\",\"3\":\"0.16703218\",\"4\":\"0.004782948\",\"5\":\"0.88646285\",\"6\":\"31\"},{\"1\":\"-1.81574309\",\"2\":\"-0.2425047\",\"3\":\"-0.97015024\",\"4\":\"-1.262098318\",\"5\":\"0.92739137\",\"6\":\"32\"},{\"1\":\"-2.30836794\",\"2\":\"-0.6724926\",\"3\":\"-0.74010381\",\"4\":\"-0.283597382\",\"5\":\"-1.30630925\",\"6\":\"33\"},{\"1\":\"-2.24372763\",\"2\":\"-0.6232809\",\"3\":\"-0.78199800\",\"4\":\"-1.931888420\",\"5\":\"0.08612508\",\"6\":\"34\"},{\"1\":\"-1.18071965\",\"2\":\"0.3802593\",\"3\":\"-0.92487991\",\"4\":\"0.154888647\",\"5\":\"0.30043629\",\"6\":\"35\"},{\"1\":\"0.97292218\",\"2\":\"0.5628867\",\"3\":\"0.82653410\",\"4\":\"0.578106615\",\"5\":\"-0.66136615\",\"6\":\"36\"},{\"1\":\"0.03427917\",\"2\":\"0.9994125\",\"3\":\"0.03427246\",\"4\":\"0.441605289\",\"5\":\"-1.30642335\",\"6\":\"37\"},{\"1\":\"0.63194088\",\"2\":\"0.8068825\",\"3\":\"0.59071193\",\"4\":\"0.500229239\",\"5\":\"-0.64574640\",\"6\":\"38\"},{\"1\":\"0.51947350\",\"2\":\"0.8680807\",\"3\":\"0.49642316\",\"4\":\"0.675754583\",\"5\":\"-0.11968988\",\"6\":\"39\"},{\"1\":\"0.87220713\",\"2\":\"0.6431380\",\"3\":\"0.76575029\",\"4\":\"-0.293134722\",\"5\":\"-0.68995056\",\"6\":\"40\"},{\"1\":\"-2.20760366\",\"2\":\"-0.5946316\",\"3\":\"-0.80399831\",\"4\":\"-1.968298010\",\"5\":\"-0.11924835\",\"6\":\"41\"},{\"1\":\"-2.18072474\",\"2\":\"-0.5728088\",\"3\":\"-0.81968903\",\"4\":\"-1.558517167\",\"5\":\"-0.56513822\",\"6\":\"42\"},{\"1\":\"-1.88789663\",\"2\":\"-0.3118127\",\"3\":\"-0.95014357\",\"4\":\"-0.858778703\",\"5\":\"0.23568819\",\"6\":\"43\"},{\"1\":\"0.36812620\",\"2\":\"0.9330033\",\"3\":\"0.35986781\",\"4\":\"0.216893002\",\"5\":\"-1.47729213\",\"6\":\"44\"},{\"1\":\"0.82742451\",\"2\":\"0.6767741\",\"3\":\"0.73619079\",\"4\":\"1.640596600\",\"5\":\"-1.48380990\",\"6\":\"45\"},{\"1\":\"0.68296072\",\"2\":\"0.7757076\",\"3\":\"0.63109244\",\"4\":\"1.502970780\",\"5\":\"-1.06094867\",\"6\":\"46\"},{\"1\":\"0.57897886\",\"2\":\"0.8370218\",\"3\":\"0.54716951\",\"4\":\"-0.791320527\",\"5\":\"-0.79529854\",\"6\":\"47\"},{\"1\":\"-2.09566091\",\"2\":\"-0.5010958\",\"3\":\"-0.86539181\",\"4\":\"-1.989179768\",\"5\":\"1.07190212\",\"6\":\"48\"},{\"1\":\"-2.43225000\",\"2\":\"-0.7587902\",\"3\":\"-0.65133513\",\"4\":\"-0.950776775\",\"5\":\"0.41927541\",\"6\":\"49\"},{\"1\":\"0.62152395\",\"2\":\"0.8129920\",\"3\":\"0.58227480\",\"4\":\"1.013147978\",\"5\":\"-0.09675463\",\"6\":\"50\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## Time Series Vector Plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrad <- 1\nggplot(df_ts, aes(t, theta, color = theta)) +\n  # geom_point(size = 0.5, alpha = 0.5) +\n    geom_hline(yintercept = c(-pi, pi), \n              linetype = \"dotted\",\n              linewidth = 0.85,\n              color = \"lightgray\") +\n  geom_segment(aes(x = t, y = theta, \n                   xend = t + 8/3*rad * U1, \n                   yend = theta + 3/8*rad * U2),\n              arrow = arrow(length = unit(0.15,\"cm\")),\n                  linewidth = 0.9) +\n  scale_color_angles() +\n  theme_bw() +\n  labs(x = \"t\",\n       y = TeX(\"$\\\\theta$\")) +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![Angular time series.](directions-data-viz_files/figure-html/fig-ts-1-1.png){#fig-ts-1 width=768}\n:::\n:::\n\n\n\n:::\n\n## Vector Fields\n\nThe final main angular data visualization are standard vector fields. These are commonly used in many different contexts. Without any major changes, they are already suitable for displaying spatial angular data. Importantly, we can combine the vector field with a heatmap to display an additional dimension of the data (e.g. an outcome) or the angular value. \n\n::: {.panel-tabset}\n## Simulate Data\n\nWe start by simulating the data on a 10 x 10 grid. The data are drawn from a projected Gaussian process regressed on a spatially distributed covariate drawn from a standard Gaussian process. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nN <- 10\nloc <- expand.grid(long = 1:N, lat = 1:N)\n\nN2 <- 23\nloc2 <- expand.grid(long = 1:N2 * (N/N2), lat = 1:N2* (N/N2))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(6541)\n\nmu_dir <- 0\n\ndf_spat <- pnregstan::gp_geostat_sim_data(\n    N = 10, \n    M = 10, \n    sigma = 1, \n    rho = 5, \n    alpha = 1)\ndf_spat <- pnregstan::pgp_geostat_reg_sim_data(\n    loc = loc, \n    X = df_spat$X,\n    sigma_w = 1, \n    rho_w = 0, \n    rho = 1/6,\n    B = matrix(c(-.25, 1), nrow = 1), \n    mu0 = 3*c(cos(mu_dir), sin(mu_dir)))\ndf_spat$theta <- circular::minusPiPlusPi(circular::circular(df_spat$theta)) |> as.numeric()\n```\n:::\n\n::: {#tbl-sim-dat-spat .cell tbl-cap='Simulated data from a PGP model.'}\n\n```{.r .cell-code}\ndf_spat\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"theta\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"long\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"lat\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"X\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.3269960\",\"2\":\"1\",\"3\":\"1\",\"4\":\"1.8965300\"},{\"1\":\"0.1910820\",\"2\":\"2\",\"3\":\"1\",\"4\":\"0.7370090\"},{\"1\":\"0.6695150\",\"2\":\"3\",\"3\":\"1\",\"4\":\"3.0681100\"},{\"1\":\"0.7056270\",\"2\":\"4\",\"3\":\"1\",\"4\":\"3.1398300\"},{\"1\":\"0.5007710\",\"2\":\"5\",\"3\":\"1\",\"4\":\"1.4473900\"},{\"1\":\"1.0162300\",\"2\":\"6\",\"3\":\"1\",\"4\":\"0.7672630\"},{\"1\":\"0.1825470\",\"2\":\"7\",\"3\":\"1\",\"4\":\"0.6818460\"},{\"1\":\"-0.0787533\",\"2\":\"8\",\"3\":\"1\",\"4\":\"-0.9766680\"},{\"1\":\"-0.6936020\",\"2\":\"9\",\"3\":\"1\",\"4\":\"-0.4769900\"},{\"1\":\"-0.8693650\",\"2\":\"10\",\"3\":\"1\",\"4\":\"-1.1648100\"},{\"1\":\"0.9124760\",\"2\":\"1\",\"3\":\"2\",\"4\":\"0.3206950\"},{\"1\":\"-0.0240346\",\"2\":\"2\",\"3\":\"2\",\"4\":\"1.9553500\"},{\"1\":\"0.6408120\",\"2\":\"3\",\"3\":\"2\",\"4\":\"2.4338500\"},{\"1\":\"0.8539100\",\"2\":\"4\",\"3\":\"2\",\"4\":\"2.2892100\"},{\"1\":\"1.1988800\",\"2\":\"5\",\"3\":\"2\",\"4\":\"1.6957000\"},{\"1\":\"-0.3476510\",\"2\":\"6\",\"3\":\"2\",\"4\":\"-0.9720230\"},{\"1\":\"-0.2483940\",\"2\":\"7\",\"3\":\"2\",\"4\":\"-0.0457621\"},{\"1\":\"-0.1570340\",\"2\":\"8\",\"3\":\"2\",\"4\":\"-0.1354690\"},{\"1\":\"0.3006610\",\"2\":\"9\",\"3\":\"2\",\"4\":\"-0.1908960\"},{\"1\":\"0.6776370\",\"2\":\"10\",\"3\":\"2\",\"4\":\"1.7203900\"},{\"1\":\"0.1278570\",\"2\":\"1\",\"3\":\"3\",\"4\":\"-0.0976175\"},{\"1\":\"0.8116410\",\"2\":\"2\",\"3\":\"3\",\"4\":\"2.4447600\"},{\"1\":\"0.5900910\",\"2\":\"3\",\"3\":\"3\",\"4\":\"2.5809500\"},{\"1\":\"0.5725920\",\"2\":\"4\",\"3\":\"3\",\"4\":\"0.9057330\"},{\"1\":\"-0.9890270\",\"2\":\"5\",\"3\":\"3\",\"4\":\"0.3743880\"},{\"1\":\"0.2229550\",\"2\":\"6\",\"3\":\"3\",\"4\":\"0.9268660\"},{\"1\":\"0.1558950\",\"2\":\"7\",\"3\":\"3\",\"4\":\"1.3556600\"},{\"1\":\"0.6588590\",\"2\":\"8\",\"3\":\"3\",\"4\":\"1.2329100\"},{\"1\":\"0.5352630\",\"2\":\"9\",\"3\":\"3\",\"4\":\"0.3616050\"},{\"1\":\"-0.2562030\",\"2\":\"10\",\"3\":\"3\",\"4\":\"-1.2976400\"},{\"1\":\"0.5557190\",\"2\":\"1\",\"3\":\"4\",\"4\":\"2.1551800\"},{\"1\":\"1.5271700\",\"2\":\"2\",\"3\":\"4\",\"4\":\"2.1886700\"},{\"1\":\"1.2780700\",\"2\":\"3\",\"3\":\"4\",\"4\":\"2.6176100\"},{\"1\":\"0.1192200\",\"2\":\"4\",\"3\":\"4\",\"4\":\"0.3861380\"},{\"1\":\"0.4781140\",\"2\":\"5\",\"3\":\"4\",\"4\":\"0.7344210\"},{\"1\":\"0.3824310\",\"2\":\"6\",\"3\":\"4\",\"4\":\"0.6831640\"},{\"1\":\"-0.0124768\",\"2\":\"7\",\"3\":\"4\",\"4\":\"1.8250400\"},{\"1\":\"0.6252730\",\"2\":\"8\",\"3\":\"4\",\"4\":\"2.5591200\"},{\"1\":\"0.0842461\",\"2\":\"9\",\"3\":\"4\",\"4\":\"1.0843900\"},{\"1\":\"1.0939700\",\"2\":\"10\",\"3\":\"4\",\"4\":\"2.6537200\"},{\"1\":\"0.9242080\",\"2\":\"1\",\"3\":\"5\",\"4\":\"2.5394300\"},{\"1\":\"0.0189985\",\"2\":\"2\",\"3\":\"5\",\"4\":\"1.9718500\"},{\"1\":\"0.1353500\",\"2\":\"3\",\"3\":\"5\",\"4\":\"0.9348940\"},{\"1\":\"0.0166895\",\"2\":\"4\",\"3\":\"5\",\"4\":\"0.5662480\"},{\"1\":\"-0.0397262\",\"2\":\"5\",\"3\":\"5\",\"4\":\"0.9241460\"},{\"1\":\"0.8946750\",\"2\":\"6\",\"3\":\"5\",\"4\":\"2.2580500\"},{\"1\":\"-0.3076140\",\"2\":\"7\",\"3\":\"5\",\"4\":\"0.0313296\"},{\"1\":\"1.2524200\",\"2\":\"8\",\"3\":\"5\",\"4\":\"1.5075100\"},{\"1\":\"0.7352120\",\"2\":\"9\",\"3\":\"5\",\"4\":\"1.6709400\"},{\"1\":\"0.9297540\",\"2\":\"10\",\"3\":\"5\",\"4\":\"3.0285700\"},{\"1\":\"-0.0767780\",\"2\":\"1\",\"3\":\"6\",\"4\":\"0.9296050\"},{\"1\":\"0.7087160\",\"2\":\"2\",\"3\":\"6\",\"4\":\"1.2994800\"},{\"1\":\"-0.2282390\",\"2\":\"3\",\"3\":\"6\",\"4\":\"-0.2715890\"},{\"1\":\"-1.0643000\",\"2\":\"4\",\"3\":\"6\",\"4\":\"0.3960820\"},{\"1\":\"-0.3121620\",\"2\":\"5\",\"3\":\"6\",\"4\":\"-1.1420500\"},{\"1\":\"0.6216440\",\"2\":\"6\",\"3\":\"6\",\"4\":\"1.7663700\"},{\"1\":\"-0.2560550\",\"2\":\"7\",\"3\":\"6\",\"4\":\"-0.7178570\"},{\"1\":\"0.1753670\",\"2\":\"8\",\"3\":\"6\",\"4\":\"0.0844610\"},{\"1\":\"0.5509610\",\"2\":\"9\",\"3\":\"6\",\"4\":\"1.2185100\"},{\"1\":\"0.7905620\",\"2\":\"10\",\"3\":\"6\",\"4\":\"1.3515600\"},{\"1\":\"-0.5265760\",\"2\":\"1\",\"3\":\"7\",\"4\":\"-1.7466600\"},{\"1\":\"-0.1984420\",\"2\":\"2\",\"3\":\"7\",\"4\":\"-0.2416220\"},{\"1\":\"0.3287850\",\"2\":\"3\",\"3\":\"7\",\"4\":\"1.4502600\"},{\"1\":\"0.0726188\",\"2\":\"4\",\"3\":\"7\",\"4\":\"-1.4213700\"},{\"1\":\"-0.1426180\",\"2\":\"5\",\"3\":\"7\",\"4\":\"-0.0101466\"},{\"1\":\"-0.0522996\",\"2\":\"6\",\"3\":\"7\",\"4\":\"-0.8994520\"},{\"1\":\"1.5769500\",\"2\":\"7\",\"3\":\"7\",\"4\":\"1.4951800\"},{\"1\":\"0.4622840\",\"2\":\"8\",\"3\":\"7\",\"4\":\"2.0446600\"},{\"1\":\"-1.0898200\",\"2\":\"9\",\"3\":\"7\",\"4\":\"0.7788740\"},{\"1\":\"-0.3091960\",\"2\":\"10\",\"3\":\"7\",\"4\":\"0.2327270\"},{\"1\":\"-0.1529680\",\"2\":\"1\",\"3\":\"8\",\"4\":\"-0.5232850\"},{\"1\":\"-0.4017790\",\"2\":\"2\",\"3\":\"8\",\"4\":\"-1.6211800\"},{\"1\":\"-0.1032260\",\"2\":\"3\",\"3\":\"8\",\"4\":\"-0.6429870\"},{\"1\":\"-0.0101913\",\"2\":\"4\",\"3\":\"8\",\"4\":\"-0.5874740\"},{\"1\":\"-0.0678234\",\"2\":\"5\",\"3\":\"8\",\"4\":\"-0.6643070\"},{\"1\":\"-0.4084090\",\"2\":\"6\",\"3\":\"8\",\"4\":\"-2.1697200\"},{\"1\":\"-0.7761020\",\"2\":\"7\",\"3\":\"8\",\"4\":\"-0.3652230\"},{\"1\":\"-0.5126540\",\"2\":\"8\",\"3\":\"8\",\"4\":\"-2.2024700\"},{\"1\":\"0.3352970\",\"2\":\"9\",\"3\":\"8\",\"4\":\"0.1525510\"},{\"1\":\"-0.8217700\",\"2\":\"10\",\"3\":\"8\",\"4\":\"-1.8228000\"},{\"1\":\"-0.4590280\",\"2\":\"1\",\"3\":\"9\",\"4\":\"-2.1494500\"},{\"1\":\"-0.2664040\",\"2\":\"2\",\"3\":\"9\",\"4\":\"-1.9477100\"},{\"1\":\"0.3953910\",\"2\":\"3\",\"3\":\"9\",\"4\":\"1.3500500\"},{\"1\":\"-0.1259870\",\"2\":\"4\",\"3\":\"9\",\"4\":\"-0.7289220\"},{\"1\":\"-0.0633095\",\"2\":\"5\",\"3\":\"9\",\"4\":\"-0.2458600\"},{\"1\":\"-0.3301230\",\"2\":\"6\",\"3\":\"9\",\"4\":\"-0.2700810\"},{\"1\":\"-0.6342860\",\"2\":\"7\",\"3\":\"9\",\"4\":\"-2.2332100\"},{\"1\":\"-1.3550100\",\"2\":\"8\",\"3\":\"9\",\"4\":\"-1.0330200\"},{\"1\":\"0.1726120\",\"2\":\"9\",\"3\":\"9\",\"4\":\"1.0365300\"},{\"1\":\"0.1681530\",\"2\":\"10\",\"3\":\"9\",\"4\":\"-1.0736900\"},{\"1\":\"-0.8299280\",\"2\":\"1\",\"3\":\"10\",\"4\":\"-2.0196300\"},{\"1\":\"-0.6822300\",\"2\":\"2\",\"3\":\"10\",\"4\":\"-2.5089700\"},{\"1\":\"-0.7055340\",\"2\":\"3\",\"3\":\"10\",\"4\":\"-3.1538200\"},{\"1\":\"-0.6524720\",\"2\":\"4\",\"3\":\"10\",\"4\":\"-2.3274200\"},{\"1\":\"-0.0738152\",\"2\":\"5\",\"3\":\"10\",\"4\":\"-1.6925300\"},{\"1\":\"-0.0871655\",\"2\":\"6\",\"3\":\"10\",\"4\":\"-0.0210742\"},{\"1\":\"-0.3180150\",\"2\":\"7\",\"3\":\"10\",\"4\":\"-1.4835100\"},{\"1\":\"-0.2529600\",\"2\":\"8\",\"3\":\"10\",\"4\":\"-0.5275630\"},{\"1\":\"-0.6155810\",\"2\":\"9\",\"3\":\"10\",\"4\":\"-1.3709900\"},{\"1\":\"-1.2993700\",\"2\":\"10\",\"3\":\"10\",\"4\":\"-2.1913400\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\n## Location Grids\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df_spat, aes(long, lat)) +\n    geom_point() +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![The 10x10 grid of locations the spatial data are simulated on.](directions-data-viz_files/figure-html/fig-locs-1.png){#fig-locs width=672}\n:::\n:::\n\n\n\n\n## Vector Field\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_vector_field <- function(df, long, lat, theta, color_name = \"Dir\", fill_name = \"Dir\", \n                            colors = list(low = \"magenta\", mid = \"dodgerblue\", high = \"magenta\", vector = \"gray90\"), \n                            rad = 0.5, midpoint = 0, limits = c(-pi, pi)) {\n    ggplot(df, aes({{long}}, {{lat}}, color = {{theta}})) +\n        geom_raster(aes({{long}}, {{lat}}, fill = {{theta}}), \n                    interpolate = FALSE, alpha = 0.75) +\n        geom_point() +\n        geom_segment(aes(x = {{long}}, y = {{lat}},\n                         xend = {{long}} + rad * cos({{theta}}),\n                         yend = {{lat}} + rad * sin({{theta}})),\n                     arrow = arrow(angle = 45, length = unit(1, \"mm\")),\n                     color = colors$vector) +\n        scale_color_angles(colors = colors, color_name = color_name, midpoint = midpoint, limits = limits) +\n        scale_fill_angles(colors = colors, fill_name = fill_name, midpoint = midpoint, limits = limits) \n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrad <- 1/2\ngg_vector_field(df_spat, long, lat, theta, rad = rad) +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![Vector field for spatial angular data. All vectors are scaled to unit size.](directions-data-viz_files/figure-html/fig-vec-field-1.png){#fig-vec-field width=672}\n:::\n:::\n\n\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}